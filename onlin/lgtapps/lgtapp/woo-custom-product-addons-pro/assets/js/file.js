/*! For license information please see file.js.LICENSE.txt */
(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3111,7763,8539],{5158:e=>{e.exports=function(e){if("number"!=typeof e||isNaN(e))throw new TypeError("Expected a number, got "+typeof e);const t=e<0,i=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];if(t&&(e=-e),e<1)return(t?"-":"")+e+" B";const s=Math.min(Math.floor(Math.log(e)/Math.log(1024)),i.length-1);e=Number(e/Math.pow(1024,s));const r=i[s];return e>=10||e%1==0?`${(t?"-":"")+e.toFixed(0)} ${r}`:`${(t?"-":"")+e.toFixed(1)} ${r}`}},7763:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>N});var s=i(6400),r=i(396),n=i(9063),o=i(1144),a=i(7581),l=i(8215),u=i(6594);const h={strings:{dropHereOr:"Drop here or %{browse}",browse:"browse"}},d="dragFileInput";function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function p(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function f(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?p(Object(i),!0).forEach((function(t){S(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function g(){g=function(){return e};var e={},t=Object.prototype,i=t.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},r=s.iterator||"@@iterator",n=s.asyncIterator||"@@asyncIterator",o=s.toStringTag||"@@toStringTag";function a(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(e){a=function(e,t,i){return e[t]=i}}function l(e,t,i,s){var r=t&&t.prototype instanceof d?t:d,n=Object.create(r.prototype),o=new P(s||[]);return n._invoke=function(e,t,i){var s="suspendedStart";return function(r,n){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===r)throw n;return E()}for(i.method=r,i.arg=n;;){var o=i.delegate;if(o){var a=O(o,i);if(a){if(a===h)continue;return a}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===s)throw s="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);s="executing";var l=u(e,t,i);if("normal"===l.type){if(s=i.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(s="completed",i.method="throw",i.arg=l.arg)}}}(e,i,o),n}function u(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var h={};function d(){}function p(){}function f(){}var m={};a(m,r,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y(x([])));v&&v!==t&&i.call(v,r)&&(m=v);var w=f.prototype=d.prototype=Object.create(m);function b(e){["next","throw","return"].forEach((function(t){a(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function s(r,n,o,a){var l=u(e[r],e,n);if("throw"!==l.type){var h=l.arg,d=h.value;return d&&"object"==c(d)&&i.call(d,"__await")?t.resolve(d.__await).then((function(e){s("next",e,o,a)}),(function(e){s("throw",e,o,a)})):t.resolve(d).then((function(e){h.value=e,o(h)}),(function(e){return s("throw",e,o,a)}))}a(l.arg)}var r;this._invoke=function(e,i){function n(){return new t((function(t,r){s(e,i,t,r)}))}return r=r?r.then(n,n):n()}}function O(e,t){var i=e.iterator[t.method];if(void 0===i){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method))return h;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var s=u(i,e.iterator,t.arg);if("throw"===s.type)return t.method="throw",t.arg=s.arg,t.delegate=null,h;var r=s.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function x(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var s=-1,n=function t(){for(;++s<e.length;)if(i.call(e,s))return t.value=e[s],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:E}}function E(){return{value:void 0,done:!0}}return p.prototype=f,a(w,"constructor",f),a(f,"constructor",p),p.displayName=a(f,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,a(e,o,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},b(_.prototype),a(_.prototype,n,(function(){return this})),e.AsyncIterator=_,e.async=function(t,i,s,r,n){void 0===n&&(n=Promise);var o=new _(l(t,i,s,r),n);return e.isGeneratorFunction(i)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},b(w),a(w,o,"Generator"),a(w,r,(function(){return this})),a(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var i in e)t.push(i);return t.reverse(),function i(){for(;t.length;){var s=t.pop();if(s in e)return i.value=s,i.done=!1,i}return i.done=!0,i}},e.values=x,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function s(i,s){return o.type="throw",o.arg=e,t.next=i,s&&(t.method="next",t.arg=void 0),!!s}for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r],o=n.completion;if("root"===n.tryLoc)return s("end");if(n.tryLoc<=this.prev){var a=i.call(n,"catchLoc"),l=i.call(n,"finallyLoc");if(a&&l){if(this.prev<n.catchLoc)return s(n.catchLoc,!0);if(this.prev<n.finallyLoc)return s(n.finallyLoc)}else if(a){if(this.prev<n.catchLoc)return s(n.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<n.finallyLoc)return s(n.finallyLoc)}}}},abrupt:function(e,t){for(var s=this.tryEntries.length-1;s>=0;--s){var r=this.tryEntries[s];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var n=r;break}}n&&("break"===e||"continue"===e)&&n.tryLoc<=t&&t<=n.finallyLoc&&(n=null);var o=n?n.completion:{};return o.type=e,o.arg=t,n?(this.method="next",this.next=n.finallyLoc,h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),k(i),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var s=i.completion;if("throw"===s.type){var r=s.arg;k(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:x(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=void 0),h}},e}function m(e,t,i,s,r,n,o){try{var a=e[n](o),l=a.value}catch(e){return void i(e)}a.done?t(l):Promise.resolve(l).then(s,r)}function y(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function v(e,t){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},v(e,t)}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,s=O(e);if(t){var r=O(this).constructor;i=Reflect.construct(s,arguments,r)}else i=s.apply(this,arguments);return b(this,i)}}function b(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _(e)}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e){return O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},O(e)}function S(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(o,e);var t,i,r,n=w(o);function o(e,t){var i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),S(_(i=n.call(this,e,t)),"handleDrop",function(){var e,t=(e=g().mark((function e(t){var s,r,n,o;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),t.stopPropagation(),clearTimeout(i.removeDragOverClassTimeout),i.setPluginState({isDraggingOver:!1}),n=function(e){i.uppy.log(e,"error")},e.next=7,(0,u.Z)(t.dataTransfer,{logDropError:n});case 7:(o=e.sent).length>0&&(i.uppy.log("[DragDrop] Files dropped"),i.addFiles(o)),null===(s=(r=i.opts).onDrop)||void 0===s||s.call(r,t);case 10:case"end":return e.stop()}}),e)})),function(){var t=this,i=arguments;return new Promise((function(s,r){var n=e.apply(t,i);function o(e){m(n,s,r,o,a,"next",e)}function a(e){m(n,s,r,o,a,"throw",e)}o(void 0)}))});return function(e){return t.apply(this,arguments)}}()),i.type="acquirer",i.id=i.opts.id||"DragDrop",i.title="Drag & Drop",i.defaultLocale=h;return i.opts=f(f({},{target:null,inputName:"files[]",width:"100%",height:"100%",note:null}),t),i.i18nInit(),i.isDragDropSupported=(0,l.Z)(),i.removeDragOverClassTimeout=null,i.onInputChange=i.onInputChange.bind(_(i)),i.handleDragOver=i.handleDragOver.bind(_(i)),i.handleDragLeave=i.handleDragLeave.bind(_(i)),i.handleDrop=i.handleDrop.bind(_(i)),i.addFiles=i.addFiles.bind(_(i)),i.render=i.render.bind(_(i)),i}return t=o,i=[{key:"addFiles",value:function(e){var t=this,i=e.map((function(e){return{source:t.id,name:e.name,type:e.type,data:e,meta:{relativePath:e.relativePath||null}}}));try{this.uppy.addFiles(i)}catch(e){this.uppy.log(e)}}},{key:"onInputChange",value:function(e){var t=(0,a.Z)(e.target.files);t.length>0&&(this.uppy.log("[DragDrop] Files selected through input"),this.addFiles(t)),e.target.value=null}},{key:"handleDragOver",value:function(e){var t,i;e.preventDefault(),e.stopPropagation();var s=e.dataTransfer.types.some((function(e){return"Files"===e})),r=this.uppy.getState().allowNewUpload;if(!s||!r)return e.dataTransfer.dropEffect="none",void clearTimeout(this.removeDragOverClassTimeout);e.dataTransfer.dropEffect="copy",clearTimeout(this.removeDragOverClassTimeout),this.setPluginState({isDraggingOver:!0}),null===(t=(i=this.opts).onDragOver)||void 0===t||t.call(i,e)}},{key:"handleDragLeave",value:function(e){var t,i,s=this;e.preventDefault(),e.stopPropagation(),clearTimeout(this.removeDragOverClassTimeout),this.removeDragOverClassTimeout=setTimeout((function(){s.setPluginState({isDraggingOver:!1})}),50),null===(t=(i=this.opts).onDragLeave)||void 0===t||t.call(i,e)}},{key:"renderHiddenFileInput",value:function(){var e=this,t=this.uppy.opts.restrictions;return(0,s.h)("input",{className:"wcpauppy-DragDrop-input",type:"file",hidden:!0,ref:function(t){e.fileInputRef=t},name:this.opts.inputName,multiple:1!==t.maxNumberOfFiles,accept:t.allowedFileTypes,onChange:this.onInputChange})}},{key:"renderLabel",value:function(){return(0,s.h)("div",{className:"wcpauppy-DragDrop-label"},this.i18nArray("dropHereOr",{browse:(0,s.h)("span",{className:"wcpauppy-DragDrop-browse"},this.i18n("browse"))}))}},{key:"renderNote",value:function(){return(0,s.h)("span",{className:"wcpauppy-DragDrop-note"},this.opts.note)}},{key:"render",value:function(){var e=this,t="wcpauppy-u-reset\n      wcpauppy-DragDrop-container\n      ".concat(this.isDragDropSupported?"wcpauppy-DragDrop--isDragDropSupported":"","\n      ").concat(this.getPluginState().isDraggingOver?"wcpauppy-DragDrop--isDraggingOver":"","\n    "),i={width:this.opts.width,height:this.opts.height};return(0,s.h)("div",{className:d},(0,s.h)("button",{type:"button",className:t,style:i,onClick:function(){return e.fileInputRef.click()},onDragOver:this.handleDragOver,onDragLeave:this.handleDragLeave,onDrop:this.handleDrop},this.renderHiddenFileInput(),(0,s.h)("div",{className:"wcpauppy-DragDrop-inner"},(0,s.h)("div",{className:"wcpauppy-DragDrop-icon"},o.renderArrowSvg()),(0,s.h)("p",null,this.opts.placeholder),(0,s.h)("span",{dangerouslySetInnerHTML:{__html:window.wcpa_front.strings.file_droppable_desc_text.replace("{action}","<i>".concat(window.wcpa_front.strings.file_droppable_action_text,"</i>"))}}))))}},{key:"install",value:function(){var e=this.opts.target;this.setPluginState({isDraggingOver:!1}),e&&this.mount(e,this)}},{key:"uninstall",value:function(){this.unmount()}}],r=[{key:"renderArrowSvg",value:function(){return(0,s.h)("svg",{width:"50",height:"38",viewBox:"0 0 50 38",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,s.h)("path",{d:"M0.618408 36.4785C0.402719 36.1777 0.275391 35.8089 0.275391 35.4105V31.5264V6.69029C0.275391 5.80942 0.989416 5.09484 1.87083 5.09484H3.07551C4.28952 5.09484 5.27357 4.11079 5.27357 2.89679C5.27357 1.68278 6.25762 0.69873 7.47162 0.69873H19.9739C20.7939 0.69873 21.5458 1.15481 21.9239 1.88255L22.9799 3.91212C23.3585 4.63932 24.1099 5.09594 24.9298 5.09594H39.4046C40.2855 5.09594 41.0001 5.80997 41.0001 6.69138V15.8261L0.618408 36.4785Z",fill:"#A6CFFF"}),(0,s.h)("path",{d:"M9.29776 17.1251C9.6523 16.3343 10.4388 15.825 11.3054 15.825H47.9473C49.1954 15.825 50.0285 17.1114 49.5181 18.2502L41.7083 35.6673C41.278 36.6272 40.3241 37.2452 39.272 37.2452H5.99546H2.1114C1.49617 37.2452 0.952279 36.9428 0.619141 36.4785L0.620787 36.4774L5.07837 26.5353L9.29776 17.1251Z",fill:"#488DF4"}))}}],i&&y(t.prototype,i),r&&y(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(n.di);S(k,"VERSION","3.0.1");var P=i(9529),x=i(5024),E=i(7894);function F(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==i)return;var s,r,n=[],o=!0,a=!1;try{for(i=i.call(e);!(o=(s=i.next()).done)&&(n.push(s.value),!t||n.length!==t);o=!0);}catch(e){a=!0,r=e}finally{try{o||null==i.return||i.return()}finally{if(a)throw r}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return T(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,s=new Array(t);i<t;i++)s[i]=e[i];return s}function U(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function A(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?U(Object(i),!0).forEach((function(t){j(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):U(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function j(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var C={};var D=function(e){var t=e.file.preview,i="";if(t)i=t;else{i="".concat(window.wcpa_front.assets_url,"images/front/").concat("default-image.svg")}return(0,s.h)("div",{class:"wcpa_thumb"},(0,s.h)("img",{src:i}))};const N=function(e){var t=e.field,i=(e.design,e.handleChange),a=e.fieldData,l=e.product,u=e.handleToolTip,h=e._labelPosition,d=e._descPosition,c=e.isDisabled,p=e.enableQuantity,f=e.onQuantityChange,g=e.formsCount,m=t.required,y=t.placeholder,v=t.name,w=t.multiple_upload,b=t.uploadSize,_=t.min_file_count,O=t.minUploadSize,S=t.allowedFileTypes,T=t.elementId,U=t.max_file_count,j=t.upload_type,N=t.quantity_label,L=t.min_quantity,I=t.max_quantity,R=l.product_id,M=L||1,$=(0,E.Tj)(T,g),z=(0,r.sO)(),B=(0,r.sO)(),V=(0,r.sO)([]),q=(0,r.sO)([]),H=(0,r.sO)(0),G=F((0,r.eJ)((new Date).getMilliseconds()),2),W=G[0],X=G[1],K=F((0,r.eJ)(""),2),Z=K[0],Y=K[1],J=F((0,r.eJ)(!1),2),Q=J[0],ee=J[1],te=F((0,r.eJ)(y),2),ie=te[0],se=te[1],re=1;w&&(re=t.max_file_count?t.max_file_count:10);var ne,oe,ae=""!==S.trim()?S.split(","):void 0;void 0===z.current&&(z.current=(ne="uppy_".concat(R.parent,"_").concat(T),oe={maxNumberOfFiles:re,allowedFileTypes:ae,maxFileSize:!!b&&1024*b*1024,minFileSize:!!O&&1024*O*1024},C[ne]||(C[ne]=new n.ZP({id:ne,debug:!0,autoProceed:!0,locale:{strings:{youCanOnlyUploadX:{0:"max_file_count",1:"max_file_count"},youHaveToAtLeastSelectX:{0:"min_file_count",1:"min_file_count"},exceedsSize:"uploadSize",inferiorSize:"minUploadSize",youCanOnlyUploadFileTypes:"allowedFileTypes",noDuplicates:"noDuplicates",dropHereOr:window.wcpa_front.strings.file_droppable_desc_text,browse:window.wcpa_front.strings.file_droppable_action_text}},restrictions:A({maxNumberOfFiles:1},oe)})),C[ne])),(0,r.d4)((function(){var e={},s=[],r=q.current.map((function(e){return e.uploadStatus&&!0===e.uploadStatus.status&&s.push(e.uploadStatus.file),{name:e.name,extension:e.extension,size:e.size,type:e.type,uploadStatus:e.uploadStatus||!1}}));0==r.length?se(y):1==r.length?se(r[0].name):se(window.wcpa_front.strings.file_placeholder.replace("{count}",r.length)),Y(JSON.stringify(s)),r.length&&!Q&&ee(!0);var n=z.current.getState().info;m&&Q&&0==r.length?e.required={show:!0,message:(0,E.N3)("requiredError",t),isBlocking:!0,newValue:!1}:w&&r.length>=1&&r.length<parseInt(_)?e.min_file_count={show:!0,message:(0,E.N3)("minFileCountError",t).replace("%s",_),isBlocking:!0,newValue:!1}:n.some((function(i){return"max_file_count"==i.message?(e.max_file_count={show:!0,message:(0,E.N3)("maxFileCountError",t).replace("%s",w?void 0===U?w?10:1:U:1),isBlocking:!1,newValue:!1},!0):(delete e.max_file_count,"uploadSize"==i.message?(e.uploadSize={show:!0,message:(0,E.N3)("maxFileSizeError",t).replace("%s",b+"MB"),isBlocking:!1,newValue:!1},!0):(delete e.uploadSize,"minUploadSize"==i.message?(e.minUploadSize={show:!0,message:(0,E.N3)("minFileSizeError",t).replace("%s",O+"MB"),isBlocking:!1,newValue:!1},!0):(delete e.minUploadSize,"allowedFileTypes"==i.message?(e.allowedFileTypes={show:!0,message:(0,E.N3)("fileExtensionError",t),isBlocking:!1,newValue:!1},!0):(delete e.allowedFileTypes,"noDuplicates"==i.message?(e.allowedFileTypes={show:!0,message:(0,E.N3)("noDuplicates",t),isBlocking:!1,newValue:!1},!0):(delete e.noDuplicates,void(e.other={show:!0,message:i.message,isBlocking:!1,newValue:!1}))))))})),i(T,r,e)}),[W]);var le=function(e){z.current.removeFile(e.target.id)};(0,r.d4)((function(){return"droppable"==j&&z.current.use(k,{target:V.current,width:"100%",height:"100%",note:null,placeholder:y||window.wcpa_front.strings.file_droppable_text}),z.current.use(o.Z,{endpoint:"".concat(window.wcpa_front.root,"upload/").concat(R.parent,"/").concat(v),formData:!0,bundle:!1,fieldName:"wcpa_file",headers:{"X-WP-Nonce":window.wcpa_front.api_nonce}}),z.current.use(x.Z,{thumbnailWidth:75}),z.current.on("file-added",(function(e){q.current.push(e),X((new Date).getMilliseconds())})),z.current.on("file-removed",(function(e,t){var i=q.current.findIndex((function(t){return t.id===e.id}));-1!==i&&q.current.splice(i,1),0==q.current.length&&B.current&&(B.current.value=""),X((new Date).getMilliseconds())})),z.current.on("info-visible",(function(){X((new Date).getMilliseconds())})),z.current.on("thumbnail:generated",(function(e,t){var i=q.current.filter((function(t){return t.id===e.id}));i&&(i[0].preview=t),X((new Date).getMilliseconds())})),z.current.on("progress",(function(e){H.current=Math.min(85,e),X((new Date).getMilliseconds())})),z.current.on("complete",(function(e){H.current=100,X((new Date).getMilliseconds())})),z.current.on("upload-progress",(function(e,t){var i=q.current.filter((function(t){return t.id===e.id}));i&&(i[0].progress.percentage=Math.min(85,Math.round(100*t.bytesUploaded/t.bytesTotal))),X((new Date).getMilliseconds())})),z.current.on("upload-error",(function(e,t,i){var s=q.current.filter((function(t){return t.id===e.id}));s&&(s[0].uploadStatus=i.body),X((new Date).getMilliseconds())})),z.current.on("upload-success",(function(e,t){var i=q.current.filter((function(t){return t.id===e.id}));i&&(i[0].uploadStatus=t.body,i[0].progress.percentage=100),X((new Date).getMilliseconds())})),(void 0!==ue||0==ue&&t.preSetValue)&&(0,E.kJ)(t.preSetValue)&&t.preSetValue.forEach((function(e){fetch(e.url).then((function(e){return e.blob()})).then((function(t){z.current.addFile({name:e.name,type:e.type,data:t})}))})),function(){var e;null===(e=z.current)||void 0===e||e.close({reason:"unmount"}),z.current=void 0}}),[z]);var ue=a.value,he=a.quantity,de=!1;void 0!==ue&&((0,E.kJ)(ue)?ue.length>0:""!=ue)&&(de=!0);var ce=(0,s.h)("div",{className:"wcpa_field"},"droppable"==j&&(0,s.h)("div",{ref:V},(0,s.h)("div",{style:{width:H.current+"%"}})),"ajax"==j&&(0,s.h)("label",{className:"wcpa_file_style"},(0,s.h)("input",{ref:B,type:"file",multiple:w,accept:S,onChange:function(e){Array.from(e.target.files).forEach((function(e){try{z.current.addFile({source:"file input",name:e.name,type:e.type,data:e})}catch(e){e.isRestriction}}))},disabled:c,placeholder:y,value:window.wcpa_front.strings.file_button_text,id:$}),(0,s.h)("div",{className:"awpca_custom_file"},(0,s.h)("p",null,ie||" "),"  ",(0,s.h)("span",{className:"wcpa_choose_button"},window.wcpa_front.strings.file_button_text))),(0,s.h)("input",{type:"hidden",name:"".concat((0,E.uM)(v)),value:Z}));return(0,s.h)(s.HY,null,(0,s.h)(P.Z,{handleToolTip:u,_labelPosition:h,_descPosition:d,field:t,dField:a,targetId:$},(0,s.h)("div",null,p?(0,s.h)("div",{className:"wcpa_quantity_wrap"},ce,N?(0,s.h)("div",{className:"wcpa_label_wrap"},(0,s.h)("label",null," ",N),(0,s.h)("input",{className:"wcpa_quantity_field",type:"number",name:"".concat((0,E.uM)(v,"_quantity")),disabled:c||!de,defaultValue:he,min:M,max:I,onChange:function(e){f(t,e.target.value)}})):(0,s.h)("input",{className:"wcpa_quantity_field",type:"number",name:"".concat((0,E.uM)(v,"_quantity")),disabled:c||!de,defaultValue:he,min:M,max:I,onChange:function(e){f(t,e.target.value)}})):ce,(0,s.h)("ul",{className:"wcpa_file_list"},q.current.map((function(e){return(0,s.h)("li",{key:e.id},(0,s.h)("div",{className:"wcpa_file_details"},(0,s.h)(D,{file:e}),(0,s.h)("p",null,(0,s.h)("span",null,null==e?void 0:e.name),(t=(null==e?void 0:e.size)||0,i=1024,r=Math.floor(Math.log(t)/Math.log(i)),+(t/i/i).toFixed(2)+["bytes","kb","mb","gb","tb","pb","eb","zb","yb"][r]))),(0,s.h)("div",{className:"wcpa_progressbar_area"},e.uploadStatus&&0==e.uploadStatus.status?"":(0,s.h)("div",{className:"wcpa_progressbar"},(0,s.h)("span",{style:{width:e.progress.percentage+"%"},className:e.uploadStatus&&1==e.uploadStatus.status&&"wcpa_success"})),(0,s.h)("p",{className:"wcpa_status"},e.uploadStatus&&(0,s.h)(s.HY,null,1==e.uploadStatus.status&&(0,s.h)("div",{className:"awpca_complete"},"Completed"),0==e.uploadStatus.status&&(0,s.h)("div",{className:"awpca_failed"},"Failed to upload"))||e.progress.percentage+"%")),(0,s.h)("span",{id:e.id,className:"wcpa_remove_file",onClick:le}));var t,i,r}))))))}},1443:function(e,t,i){!function(e){"use strict";function t(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var s="undefined"!=typeof self?self:i.g;const r="undefined"!=typeof navigator,n=r&&"undefined"==typeof HTMLImageElement,o=!(void 0===i.g||"undefined"==typeof process||!process.versions||!process.versions.node),a=s.Buffer,l=!!a,u=e=>void 0!==e;function h(e){return void 0===e||(e instanceof Map?0===e.size:0===Object.values(e).filter(u).length)}function d(e){let t=new Error(e);throw delete t.stack,t}function c(e){let t=function(e){let t=0;return e.ifd0.enabled&&(t+=1024),e.exif.enabled&&(t+=2048),e.makerNote&&(t+=2048),e.userComment&&(t+=1024),e.gps.enabled&&(t+=512),e.interop.enabled&&(t+=100),e.ifd1.enabled&&(t+=1024),t+2048}(e);return e.jfif.enabled&&(t+=50),e.xmp.enabled&&(t+=2e4),e.iptc.enabled&&(t+=14e3),e.icc.enabled&&(t+=6e3),t}const p=e=>String.fromCharCode.apply(null,e),f="undefined"!=typeof TextDecoder?new TextDecoder("utf-8"):void 0;class g{static from(e,t){return e instanceof this&&e.le===t?e:new g(e,void 0,void 0,t)}constructor(e,t=0,i,s){if("boolean"==typeof s&&(this.le=s),Array.isArray(e)&&(e=new Uint8Array(e)),0===e)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){void 0===i&&(i=e.byteLength-t);let s=new DataView(e,t,i);this._swapDataView(s)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof g){void 0===i&&(i=e.byteLength-t),(t+=e.byteOffset)+i>e.byteOffset+e.byteLength&&d("Creating view outside of available memory in ArrayBuffer");let s=new DataView(e.buffer,t,i);this._swapDataView(s)}else if("number"==typeof e){let t=new DataView(new ArrayBuffer(e));this._swapDataView(t)}else d("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,i=g){return e instanceof DataView||e instanceof g?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||d("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new i(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new g(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return i=this.getUint8Array(e,t),f?f.decode(i):l?Buffer.from(i).toString("utf8"):decodeURIComponent(escape(p(i)));var i}getLatin1String(e=0,t=this.byteLength){let i=this.getUint8Array(e,t);return p(i)}getUnicodeString(e=0,t=this.byteLength){const i=[];for(let s=0;s<t&&e+s<this.byteLength;s+=2)i.push(this.getUint16(e+s));return p(i)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,i){switch(t){case 1:return this.getUint8(e,i);case 2:return this.getUint16(e,i);case 4:return this.getUint32(e,i);case 8:return this.getUint64&&this.getUint64(e,i)}}getUint(e,t,i){switch(t){case 8:return this.getUint8(e,i);case 16:return this.getUint16(e,i);case 32:return this.getUint32(e,i);case 64:return this.getUint64&&this.getUint64(e,i)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}}function m(e,t){d(`${e} '${t}' was not loaded, try using full build of exifr.`)}class y extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||m(this.kind,e),t&&(e in t||function(e,t){d(`Unknown ${e} '${t}'.`)}(this.kind,e),t[e].enabled||m(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}}var v=new y("file parser"),w=new y("segment parser"),b=new y("file reader");let _=s.fetch;const O="Invalid input argument";function S(e,t){return(i=e).startsWith("data:")||i.length>1e4?P(e,t,"base64"):o&&e.includes("://")?k(e,t,"url",x):o?P(e,t,"fs"):r?k(e,t,"url",x):void d(O);var i}async function k(e,t,i,s){return b.has(i)?P(e,t,i):s?async function(e,t){let i=await t(e);return new g(i)}(e,s):void d(`Parser ${i} is not loaded`)}async function P(e,t,i){let s=new(b.get(i))(e,t);return await s.read(),s}const x=e=>_(e).then((e=>e.arrayBuffer())),E=e=>new Promise(((t,i)=>{let s=new FileReader;s.onloadend=()=>t(s.result||new ArrayBuffer),s.onerror=i,s.readAsArrayBuffer(e)}));class F extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}}function T(e,t,i){let s=new F;for(let[e,t]of i)s.set(e,t);if(Array.isArray(t))for(let i of t)e.set(i,s);else e.set(t,s);return s}function U(e,t,i){let s,r=e.get(t);for(s of i)r.set(s[0],s[1])}const A=new Map,j=new Map,C=new Map,D=37500,N=37510,L=33723,I=34675,R=34665,M=34853,$=40965,z=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],B=["jfif","xmp","icc","iptc","ihdr"],V=["tiff",...B],q=["ifd0","ifd1","exif","gps","interop"],H=[...V,...q],G=["makerNote","userComment"],W=["translateKeys","translateValues","reviveValues","multiSegment"],X=[...W,"sanitize","mergeOutput","silentErrors"];class K{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class Z extends K{get needed(){return this.enabled||this.deps.size>0}constructor(e,i,s,r){if(super(),t(this,"enabled",!1),t(this,"skip",new Set),t(this,"pick",new Set),t(this,"deps",new Set),t(this,"translateKeys",!1),t(this,"translateValues",!1),t(this,"reviveValues",!1),this.key=e,this.enabled=i,this.parse=this.enabled,this.applyInheritables(r),this.canBeFiltered=q.includes(e),this.canBeFiltered&&(this.dict=A.get(e)),void 0!==s)if(Array.isArray(s))this.parse=this.enabled=!0,this.canBeFiltered&&s.length>0&&this.translateTagSet(s,this.pick);else if("object"==typeof s){if(this.enabled=!0,this.parse=!1!==s.parse,this.canBeFiltered){let{pick:e,skip:t}=s;e&&e.length>0&&this.translateTagSet(e,this.pick),t&&t.length>0&&this.translateTagSet(t,this.skip)}this.applyInheritables(s)}else!0===s||!1===s?this.parse=this.enabled=s:d(`Invalid options argument: ${s}`)}applyInheritables(e){let t,i;for(t of W)i=e[t],void 0!==i&&(this[t]=i)}translateTagSet(e,t){if(this.dict){let i,s,{tagKeys:r,tagValues:n}=this.dict;for(i of e)"string"==typeof i?(s=n.indexOf(i),-1===s&&(s=r.indexOf(Number(i))),-1!==s&&t.add(Number(r[s]))):t.add(i)}else for(let i of e)t.add(i)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,ie(this.pick,this.deps)):this.enabled&&this.pick.size>0&&ie(this.pick,this.deps)}}var Y={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},J=new Map;class Q extends K{static useCached(e){let t=J.get(e);return void 0!==t||(t=new this(e),J.set(e,t)),t}constructor(e){super(),!0===e?this.setupFromTrue():void 0===e?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):"object"==typeof e?this.setupFromObject(e):d(`Invalid options argument ${e}`),void 0===this.firstChunkSize&&(this.firstChunkSize=r?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of z)this[e]=Y[e];for(e of X)this[e]=Y[e];for(e of G)this[e]=Y[e];for(e of H)this[e]=new Z(e,Y[e],void 0,this)}setupFromTrue(){let e;for(e of z)this[e]=Y[e];for(e of X)this[e]=Y[e];for(e of G)this[e]=!0;for(e of H)this[e]=new Z(e,!0,void 0,this)}setupFromArray(e){let t;for(t of z)this[t]=Y[t];for(t of X)this[t]=Y[t];for(t of G)this[t]=Y[t];for(t of H)this[t]=new Z(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,q)}setupFromObject(e){let t;for(t of(q.ifd0=q.ifd0||q.image,q.ifd1=q.ifd1||q.thumbnail,Object.assign(this,e),z))this[t]=te(e[t],Y[t]);for(t of X)this[t]=te(e[t],Y[t]);for(t of G)this[t]=te(e[t],Y[t]);for(t of V)this[t]=new Z(t,Y[t],e[t],this);for(t of q)this[t]=new Z(t,Y[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,q,H),!0===e.tiff?this.batchEnableWithBool(q,!0):!1===e.tiff?this.batchEnableWithUserValue(q,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,q):"object"==typeof e.tiff&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,q)}batchEnableWithBool(e,t){for(let i of e)this[i].enabled=t}batchEnableWithUserValue(e,t){for(let i of e){let e=t[i];this[i].enabled=!1!==e&&void 0!==e}}setupGlobalFilters(e,t,i,s=i){if(e&&e.length){for(let e of s)this[e].enabled=!1;let t=ee(e,i);for(let[e,i]of t)ie(this[e].pick,i),this[e].enabled=!0}else if(t&&t.length){let e=ee(t,i);for(let[t,i]of e)ie(this[t].skip,i)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:i,iptc:s,icc:r}=this;this.makerNote?t.deps.add(D):t.skip.add(D),this.userComment?t.deps.add(N):t.skip.add(N),i.enabled||e.skip.add(700),s.enabled||e.skip.add(L),r.enabled||e.skip.add(I)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:i,interop:s}=this;s.needed&&(t.deps.add($),e.deps.add($)),t.needed&&e.deps.add(R),i.needed&&e.deps.add(M),this.tiff.enabled=q.some((e=>!0===this[e].enabled))||this.makerNote||this.userComment;for(let e of q)this[e].finalizeFilters()}get onlyTiff(){return!B.map((e=>this[e].enabled)).some((e=>!0===e))&&this.tiff.enabled}checkLoadedPlugins(){for(let e of V)this[e].enabled&&!w.has(e)&&m("segment parser",e)}}function ee(e,t){let i,s,r,n,o=[];for(r of t){for(n of(i=A.get(r),s=[],i))(e.includes(n[0])||e.includes(n[1]))&&s.push(n[0]);s.length&&o.push([r,s])}return o}function te(e,t){return void 0!==e?e:void 0!==t?t:void 0}function ie(e,t){for(let i of t)e.add(i)}t(Q,"default",Y);class se{constructor(e){t(this,"parsers",{}),t(this,"output",{}),t(this,"errors",[]),t(this,"pushToErrors",(e=>this.errors.push(e))),this.options=Q.useCached(e)}async read(e){this.file=await function(e,t){return"string"==typeof e?S(e,t):r&&!n&&e instanceof HTMLImageElement?S(e.src,t):e instanceof Uint8Array||e instanceof ArrayBuffer||e instanceof DataView?new g(e):r&&e instanceof Blob?k(e,t,"blob",E):void d(O)}(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[i,s]of v)if(s.canHandle(e,t))return this.fileParser=new s(this.options,this.file,this.parsers),e[i]=!0;this.file.close&&this.file.close(),d("Unknown file format")}async parse(){let{output:e,errors:t}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),t.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&t.length>0&&(e.errors=t),h(i=e)?void 0:i;var i}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let t=Object.values(this.parsers).map((async t=>{let i=await t.parse();t.assignToOutput(e,i)}));this.options.silentErrors&&(t=t.map((e=>e.catch(this.pushToErrors)))),await Promise.all(t)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,i=w.get("tiff",e);var s;if(t.tiff?s={start:0,type:"tiff"}:t.jpeg&&(s=await this.fileParser.getOrFindSegment("tiff")),void 0===s)return;let r=await this.fileParser.ensureSegmentChunk(s),n=this.parsers.tiff=new i(r,e,t),o=await n.extractThumbnail();return t.close&&t.close(),o}}async function re(e,t){let i=new se(t);return await i.read(e),i.parse()}var ne=Object.freeze({__proto__:null,parse:re,Exifr:se,fileParsers:v,segmentParsers:w,fileReaders:b,tagKeys:A,tagValues:j,tagRevivers:C,createDictionary:T,extendDictionary:U,fetchUrlAsArrayBuffer:x,readBlobAsArrayBuffer:E,chunkedProps:z,otherSegments:B,segments:V,tiffBlocks:q,segmentsAndBlocks:H,tiffExtractables:G,inheritables:W,allFormatters:X,Options:Q});class oe{static findPosition(e,t){let i=e.getUint16(t+2)+2,s="function"==typeof this.headerLength?this.headerLength(e,t,i):this.headerLength,r=t+s,n=i-s;return{offset:t,length:i,headerLength:s,start:r,size:n,end:r+n}}static parse(e,t={}){return new this(e,new Q({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof g?e:new g(e)}constructor(e,i={},s){t(this,"errors",[]),t(this,"raw",new Map),t(this,"handleError",(e=>{if(!this.options.silentErrors)throw e;this.errors.push(e.message)})),this.chunk=this.normalizeInput(e),this.file=s,this.type=this.constructor.type,this.globalOptions=this.options=i,this.localOptions=i[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let i=C.get(t),s=j.get(t),r=A.get(t),n=this.options[t],o=n.reviveValues&&!!i,a=n.translateValues&&!!s,l=n.translateKeys&&!!r,u={};for(let[t,n]of e)o&&i.has(t)?n=i.get(t)(n):a&&s.has(t)&&(n=this.translateValue(n,s.get(t))),l&&r.has(t)&&(t=r.get(t)||t),u[t]=n;return u}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,i){if(this.globalOptions.mergeOutput)return Object.assign(e,i);e[t]?Object.assign(e[t],i):e[t]=i}}function ae(e){return 192===e||194===e||196===e||219===e||221===e||218===e||254===e}function le(e){return e>=224&&e<=239}function ue(e,t,i){for(let[s,r]of w)if(r.canHandle(e,t,i))return s}t(oe,"headerLength",4),t(oe,"type",void 0),t(oe,"multiSegment",!1),t(oe,"canHandle",(()=>!1));class he extends class{constructor(e,i,s){t(this,"errors",[]),t(this,"ensureSegmentChunk",(async e=>{let t=e.start,i=e.size||65536;if(this.file.chunked)if(this.file.available(t,i))e.chunk=this.file.subarray(t,i);else try{e.chunk=await this.file.readChunk(t,i)}catch(t){d(`Couldn't read segment: ${JSON.stringify(e)}. ${t.message}`)}else this.file.byteLength>t+i?e.chunk=this.file.subarray(t,i):void 0===e.size?e.chunk=this.file.subarray(t):d("Segment unreachable: "+JSON.stringify(e));return e.chunk})),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=i,this.parsers=s}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let i=new(w.get(e))(t,this.options,this.file);return this.parsers[e]=i}createParsers(e){for(let t of e){let{type:e,chunk:i}=t,s=this.options[e];if(s&&s.enabled){let t=this.parsers[e];t&&t.append||t||this.createParser(e,i)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}}{constructor(...e){super(...e),t(this,"appSegments",[]),t(this,"jpegSegments",[]),t(this,"unknownSegments",[])}static canHandle(e,t){return 65496===t}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){!0===e?(this.findAll=!0,this.wanted=new Set(w.keyList())):(e=void 0===e?w.keyList().filter((e=>this.options[e].enabled)):e.filter((e=>this.options[e].enabled&&w.has(e))),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:i,findAll:s,wanted:r,remaining:n}=this;if(!s&&this.file.chunked&&(s=Array.from(r).some((e=>{let t=w.get(e),i=this.options[e];return t.multiSegment&&i.multiSegment})),s&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,i.byteLength),!this.options.onlyTiff&&i.chunked){let t=!1;for(;n.size>0&&!t&&(i.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:s}=i,r=this.appSegments.some((e=>!this.file.available(e.offset||e.start,e.length||e.size)));if(t=e>s&&!r?!await i.readNextChunk(e):!await i.readNextChunk(s),void 0===(e=this.findAppSegmentsInRange(e,i.byteLength)))return}}}findAppSegmentsInRange(e,t){t-=2;let i,s,r,n,o,a,{file:l,findAll:u,wanted:h,remaining:d,options:c}=this;for(;e<t;e++)if(255===l.getUint8(e))if(i=l.getUint8(e+1),le(i)){if(s=l.getUint16(e+2),r=ue(l,e,s),r&&h.has(r)&&(n=w.get(r),o=n.findPosition(l,e),a=c[r],o.type=r,this.appSegments.push(o),!u&&(n.multiSegment&&a.multiSegment?(this.unfinishedMultiSegment=o.chunkNumber<o.chunkCount,this.unfinishedMultiSegment||d.delete(r)):d.delete(r),0===d.size)))break;c.recordUnknownSegments&&(o=oe.findPosition(l,e),o.marker=i,this.unknownSegments.push(o)),e+=s+1}else if(ae(i)){if(s=l.getUint16(e+2),218===i&&!1!==c.stopAfterSos)return;c.recordJpegSegments&&this.jpegSegments.push({offset:e,length:s,marker:i}),e+=s+1}return e}mergeMultiSegments(){if(!this.appSegments.some((e=>e.multiSegment)))return;let e=function(e,t){let i,s,r,n=new Map;for(let o=0;o<e.length;o++)i=e[o],s=i[t],n.has(s)?r=n.get(s):n.set(s,r=[]),r.push(i);return Array.from(n)}(this.appSegments,"type");this.mergedAppSegments=e.map((([e,t])=>{let i=w.get(e,this.options);return i.handleMultiSegments?{type:e,chunk:i.handleMultiSegments(t)}:t[0]}))}getSegment(e){return this.appSegments.find((t=>t.type===e))}async getOrFindSegment(e){let t=this.getSegment(e);return void 0===t&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}}t(he,"type","jpeg"),v.set("jpeg",he);const de=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class ce extends oe{parseHeader(){var e=this.chunk.getUint16();18761===e?this.le=!0:19789===e&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,i=new Map){let{pick:s,skip:r}=this.options[t];s=new Set(s);let n=s.size>0,o=0===r.size,a=this.chunk.getUint16(e);e+=2;for(let l=0;l<a;l++){let a=this.chunk.getUint16(e);if(n){if(s.has(a)&&(i.set(a,this.parseTag(e,a,t)),s.delete(a),0===s.size))break}else!o&&r.has(a)||i.set(a,this.parseTag(e,a,t));e+=12}return i}parseTag(e,t,i){let{chunk:s}=this,r=s.getUint16(e+2),n=s.getUint32(e+4),o=de[r];if(o*n<=4?e+=8:e=s.getUint32(e+8),(r<1||r>13)&&d(`Invalid TIFF value type. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${r}, offset ${e}`),e>s.byteLength&&d(`Invalid TIFF value offset. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${r}, offset ${e} is outside of chunk size ${s.byteLength}`),1===r)return s.getUint8Array(e,n);if(2===r)return""===(a=function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e}(a=s.getString(e,n)).trim())?void 0:a;var a;if(7===r)return s.getUint8Array(e,n);if(1===n)return this.parseTagValue(r,e);{let t=new(function(e){switch(e){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:case 10:default:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 11:return Float32Array;case 12:return Float64Array}}(r))(n),i=o;for(let s=0;s<n;s++)t[s]=this.parseTagValue(r,e),e+=i;return t}}parseTagValue(e,t){let{chunk:i}=this;switch(e){case 1:return i.getUint8(t);case 3:return i.getUint16(t);case 4:case 13:return i.getUint32(t);case 5:return i.getUint32(t)/i.getUint32(t+4);case 6:return i.getInt8(t);case 8:return i.getInt16(t);case 9:return i.getInt32(t);case 10:return i.getInt32(t)/i.getInt32(t+4);case 11:return i.getFloat(t);case 12:return i.getDouble(t);default:d(`Invalid tiff type ${e}`)}}}class pe extends ce{static canHandle(e,t){return 225===e.getUint8(t+1)&&1165519206===e.getUint32(t+4)&&0===e.getUint16(t+8)}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let t=this[e]();return void 0!==t.catch&&(t=t.catch(this.handleError)),t}findIfd0Offset(){void 0===this.ifd0Offset&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(void 0===this.ifd1Offset){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let i=new Map;return this[t]=i,this.parseTags(e,t,i),i}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&d("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&d(`IFD0 offset points to outside of file.\nthis.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,c(this.options));let t=this.parseBlock(this.ifd0Offset,"ifd0");return 0!==t.size?(this.exifOffset=t.get(R),this.interopOffset=t.get($),this.gpsOffset=t.get(M),this.xmp=t.get(700),this.iptc=t.get(L),this.icc=t.get(I),this.options.sanitize&&(t.delete(R),t.delete($),t.delete(M),t.delete(700),t.delete(L),t.delete(I)),t):void 0}async parseExifBlock(){if(this.exif)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.exifOffset)return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,c(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get($)),this.makerNote=e.get(D),this.userComment=e.get(N),this.options.sanitize&&(e.delete($),e.delete(D),e.delete(N)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let i=e.get(t);i&&1===i.length&&e.set(t,i[0])}async parseGpsBlock(){if(this.gps)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.gpsOffset)return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",fe(...e.get(2),e.get(1))),e.set("longitude",fe(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),void 0!==this.interopOffset||this.exif||await this.parseExifBlock(),void 0!==this.interopOffset))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),void 0===this.ifd1)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,i,s={};for(t of q)if(e=this[t],!h(e))if(i=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if("ifd1"===t)continue;Object.assign(s,i)}else s[t]=i;return this.makerNote&&(s.makerNote=this.makerNote),this.userComment&&(s.userComment=this.userComment),s}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[i,s]of Object.entries(t))this.assignObjectToOutput(e,i,s)}}function fe(e,t,i,s){var r=e+t/60+i/3600;return"S"!==s&&"W"!==s||(r*=-1),r}t(pe,"type","tiff"),t(pe,"headerLength",10),w.set("tiff",pe);var ge=Object.freeze({__proto__:null,default:ne,Exifr:se,fileParsers:v,segmentParsers:w,fileReaders:b,tagKeys:A,tagValues:j,tagRevivers:C,createDictionary:T,extendDictionary:U,fetchUrlAsArrayBuffer:x,readBlobAsArrayBuffer:E,chunkedProps:z,otherSegments:B,segments:V,tiffBlocks:q,segmentsAndBlocks:H,tiffExtractables:G,inheritables:W,allFormatters:X,Options:Q,parse:re});const me={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},ye=Object.assign({},me,{firstChunkSize:4e4,gps:[1,2,3,4]}),ve=Object.assign({},me,{tiff:!1,ifd1:!0,mergeOutput:!1}),we=Object.assign({},me,{firstChunkSize:4e4,ifd0:[274]});async function be(e){let t=new se(we);await t.read(e);let i=await t.parse();if(i&&i.ifd0)return i.ifd0[274]}const _e=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});if(e.rotateCanvas=!0,e.rotateCss=!0,"object"==typeof navigator){let t=navigator.userAgent;if(t.includes("iPad")||t.includes("iPhone")){let i=t.match(/OS (\d+)_(\d+)/);if(i){let[,t,s]=i,r=Number(t)+.1*Number(s);e.rotateCanvas=r<13.4,e.rotateCss=!1}}else if(t.includes("OS X 10")){let[,i]=t.match(/OS X 10[_.](\d+)/);e.rotateCanvas=e.rotateCss=Number(i)<15}if(t.includes("Chrome/")){let[,i]=t.match(/Chrome\/(\d+)/);e.rotateCanvas=e.rotateCss=Number(i)<81}else if(t.includes("Firefox/")){let[,i]=t.match(/Firefox\/(\d+)/);e.rotateCanvas=e.rotateCss=Number(i)<77}}class Oe extends g{constructor(...e){super(...e),t(this,"ranges",new Se),0!==this.byteLength&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,i){if(0===e&&0===this.byteLength&&i){let e=new DataView(i.buffer||i,i.byteOffset,i.byteLength);this._swapDataView(e)}else{let i=e+t;if(i>this.byteLength){let{dataView:e}=this._extend(i);this._swapDataView(e)}}}_extend(e){let t;t=l?a.allocUnsafe(e):new Uint8Array(e);let i=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:i}}subarray(e,t,i=!1){return t=t||this._lengthToEnd(e),i&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,i=!1){i&&this._tryExtend(t,e.byteLength,e);let s=super.set(e,t);return this.ranges.add(t,s.byteLength),s}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}}class Se{constructor(){t(this,"list",[])}get length(){return this.list.length}add(e,t,i=0){let s=e+t,r=this.list.filter((t=>ke(e,t.offset,s)||ke(e,t.end,s)));if(r.length>0){e=Math.min(e,...r.map((e=>e.offset))),s=Math.max(s,...r.map((e=>e.end))),t=s-e;let i=r.shift();i.offset=e,i.length=t,i.end=s,this.list=this.list.filter((e=>!r.includes(e)))}else this.list.push({offset:e,length:t,end:s})}available(e,t){let i=e+t;return this.list.some((t=>t.offset<=e&&i<=t.end))}}function ke(e,t,i){return e<=t&&t<=i}class Pe extends Oe{constructor(e,i){super(0),t(this,"chunksRead",0),this.input=e,this.options=i}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,i=await this.readChunk(e,t);return!!i&&i.byteLength===t}async readChunk(e,t){if(this.chunksRead++,0!==(t=this.safeWrapAddress(e,t)))return this._readChunk(e,t)}safeWrapAddress(e,t){return void 0!==this.size&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(0!==this.ranges.list.length)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return void 0!==this.size&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}b.set("blob",class extends Pe{async readWhole(){this.chunked=!1;let e=await E(this.input);this._swapArrayBuffer(e)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(e,t){let i=t?e+t:void 0,s=this.input.slice(e,i),r=await E(s);return this.set(r,e,!0)}}),e.Exifr=se,e.Options=Q,e.allFormatters=X,e.chunkedProps=z,e.createDictionary=T,e.default=ge,e.extendDictionary=U,e.fetchUrlAsArrayBuffer=x,e.fileParsers=v,e.fileReaders=b,e.gps=async function(e){let t=new se(ye);await t.read(e);let i=await t.parse();if(i&&i.gps){let{latitude:e,longitude:t}=i.gps;return{latitude:e,longitude:t}}},e.gpsOnlyOptions=ye,e.inheritables=W,e.orientation=be,e.orientationOnlyOptions=we,e.otherSegments=B,e.parse=re,e.readBlobAsArrayBuffer=E,e.rotation=async function(t){let i=await be(t);return Object.assign({canvas:e.rotateCanvas,css:e.rotateCss},_e[i])},e.rotations=_e,e.segmentParsers=w,e.segments=V,e.segmentsAndBlocks=H,e.tagKeys=A,e.tagRevivers=C,e.tagValues=j,e.thumbnail=async function(e){let t=new se(ve);await t.read(e);let i=await t.extractThumbnail();return i&&l?a.from(i):i},e.thumbnailOnlyOptions=ve,e.thumbnailUrl=async function(e){let t=await this.thumbnail(e);if(void 0!==t){let e=new Blob([t]);return URL.createObjectURL(e)}},e.tiffBlocks=q,e.tiffExtractables=G,Object.defineProperty(e,"__esModule",{value:!0})}(t)},3096:(e,t,i)=>{var s="Expected a function",r=/^\s+|\s+$/g,n=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,a=/^0o[0-7]+$/i,l=parseInt,u="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g,h="object"==typeof self&&self&&self.Object===Object&&self,d=u||h||Function("return this")(),c=Object.prototype.toString,p=Math.max,f=Math.min,g=function(){return d.Date.now()};function m(e,t,i){var r,n,o,a,l,u,h=0,d=!1,c=!1,m=!0;if("function"!=typeof e)throw new TypeError(s);function w(t){var i=r,s=n;return r=n=void 0,h=t,a=e.apply(s,i)}function b(e){return h=e,l=setTimeout(O,t),d?w(e):a}function _(e){var i=e-u;return void 0===u||i>=t||i<0||c&&e-h>=o}function O(){var e=g();if(_(e))return S(e);l=setTimeout(O,function(e){var i=t-(e-u);return c?f(i,o-(e-h)):i}(e))}function S(e){return l=void 0,m&&r?w(e):(r=n=void 0,a)}function k(){var e=g(),i=_(e);if(r=arguments,n=this,u=e,i){if(void 0===l)return b(u);if(c)return l=setTimeout(O,t),w(u)}return void 0===l&&(l=setTimeout(O,t)),a}return t=v(t)||0,y(i)&&(d=!!i.leading,o=(c="maxWait"in i)?p(v(i.maxWait)||0,t):o,m="trailing"in i?!!i.trailing:m),k.cancel=function(){void 0!==l&&clearTimeout(l),h=0,r=u=n=l=void 0},k.flush=function(){return void 0===l?a:S(g())},k}function y(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function v(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==c.call(e)}(e))return NaN;if(y(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=y(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(r,"");var i=o.test(e);return i||a.test(e)?l(e.slice(2),i?2:8):n.test(e)?NaN:+e}e.exports=function(e,t,i){var r=!0,n=!0;if("function"!=typeof e)throw new TypeError(s);return y(i)&&(r="leading"in i?!!i.leading:r,n="trailing"in i?!!i.trailing:n),m(e,t,{leading:r,maxWait:t,trailing:n})}},4193:(e,t,i)=>{var s=i(1196),r=/[\/\+\.]/;e.exports=function(e,t){function i(t){var i=s(t,e,r);return i&&i.length>=2}return t?i(t.split(";")[0]):i}},4800:e=>{e.exports=function(){var e={},t=e._fns={};return e.emit=function(e,i,s,r,n,o,a){var l=function(e){var i=t[e]?t[e]:[],s=e.indexOf(":"),r=-1===s?[e]:[e.substring(0,s),e.substring(s+1)],n=Object.keys(t),o=0,a=n.length;for(;o<a;o++){var l=n[o];if("*"===l&&(i=i.concat(t[l])),2===r.length&&r[0]===l){i=i.concat(t[l]);break}}return i}(e);l.length&&function(e,t,i){var s=0,r=t.length;for(;s<r&&t[s];s++)t[s].event=e,t[s].apply(t[s],i)}(e,l,[i,s,r,n,o,a])},e.on=function(e,i){t[e]||(t[e]=[]),t[e].push(i)},e.once=function(t,i){this.on(t,(function s(){i.apply(this,arguments),e.off(t,s)}))},e.off=function(e,t){var i=[];if(e&&t)for(var s=this._fns[e],r=0,n=s?s.length:0;r<n;r++)s[r]!==t&&i.push(s[r]);i.length?this._fns[e]=i:delete this._fns[e]},e}},1196:e=>{"use strict";function t(e,t){this.text=e=e||"",this.hasWild=~e.indexOf("*"),this.separator=t,this.parts=e.split(t)}t.prototype.match=function(e){var t,i,s=!0,r=this.parts,n=r.length;if("string"==typeof e||e instanceof String)if(this.hasWild||this.text==e){for(i=(e||"").split(this.separator),t=0;s&&t<n;t++)"*"!==r[t]&&(s=t<i.length&&r[t]===i[t]);s=s&&i}else s=!1;else if("function"==typeof e.splice)for(s=[],t=e.length;t--;)this.match(e[t])&&(s[s.length]=e[t]);else if("object"==typeof e)for(var o in s={},e)this.match(o)&&(s[o]=e[o]);return s},e.exports=function(e,i,s){var r=new t(e,s||/[\/\.]/);return void 0!==i?r.match(i):r}},8596:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var s=i(4136);class r{constructor(e,t){void 0===t&&(t={}),this.uppy=e,this.opts=t}getPluginState(){const{plugins:e}=this.uppy.getState();return e[this.id]||{}}setPluginState(e){const{plugins:t}=this.uppy.getState();this.uppy.setState({plugins:{...t,[this.id]:{...t[this.id],...e}}})}setOptions(e){this.opts={...this.opts,...e},this.setPluginState(),this.i18nInit()}i18nInit(){const e=new s.Z([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.setPluginState()}addTarget(){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")}install(){}uninstall(){}render(){throw new Error("Extend the render method to add your plugin to a DOM element")}update(){}afterUpdate(){}}},9063:(e,t,i)=>{"use strict";i.d(t,{di:()=>Ke,ZP:()=>ue});var s=i(4136),r=i(4800),n=i(9022),o=i(3096);function a(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var l=0;function u(e){return"__private_"+l+++"_"+e}var h=u("callbacks"),d=u("publish");class c{constructor(){Object.defineProperty(this,d,{value:p}),Object.defineProperty(this,h,{writable:!0,value:new Set}),this.state={}}getState(){return this.state}setState(e){const t={...this.state},i={...this.state,...e};this.state=i,a(this,d)[d](t,i,e)}subscribe(e){return a(this,h)[h].add(e),()=>{a(this,h)[h].delete(e)}}}function p(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];a(this,h)[h].forEach((e=>{e(...t)}))}c.VERSION="3.0.0";const f=c;function g(e){const t=e.lastIndexOf(".");return-1===t||t===e.length-1?{name:e,extension:void 0}:{name:e.slice(0,t),extension:e.slice(t+1)}}const m={md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",webp:"image/webp",gif:"image/gif",heic:"image/heic",heif:"image/heif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",dicom:"application/dicom",doc:"application/msword",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel",txt:"text/plain",text:"text/plain",conf:"text/plain",log:"text/plain",pdf:"application/pdf",zip:"application/zip","7z":"application/x-7z-compressed",rar:"application/x-rar-compressed",tar:"application/x-tar",gz:"application/gzip",dmg:"application/x-apple-diskimage"};function y(e){let t="";return e.replace(/[^A-Z0-9]/gi,(e=>(t+=`-${function(e){return e.charCodeAt(0).toString(32)}(e)}`,"/")))+t}function v(e){if(null==e&&"undefined"!=typeof navigator&&(e=navigator.userAgent),!e)return!0;const t=/Edge\/(\d+\.\d+)/.exec(e);if(!t)return!0;const i=t[1];let[s,r]=i.split(".");return s=parseInt(s,10),r=parseInt(r,10),s<15||15===s&&r<15063||(s>18||18===s&&r>=18218)}const w={debug:()=>{},warn:()=>{},error:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i]}},b={debug:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i]},warn:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i]},error:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i]}};var _=i(5158),O=i(4193);const S={maxFileSize:null,minFileSize:null,maxTotalFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null,requiredMetaFields:[]};class k extends Error{constructor(){super(...arguments),this.isRestriction=!0}}class P{constructor(e,t){this.i18n=t,this.getOpts=()=>{const t=e();if(null!=t.restrictions.allowedFileTypes&&!Array.isArray(t.restrictions.allowedFileTypes))throw new TypeError("`restrictions.allowedFileTypes` must be an array");return t}}validate(e,t){const{maxFileSize:i,minFileSize:s,maxTotalFileSize:r,maxNumberOfFiles:n,allowedFileTypes:o}=this.getOpts().restrictions;if(n&&t.length+1>n)throw new k(`${this.i18n("youCanOnlyUploadX",{smart_count:n})}`);if(o){if(!o.some((t=>t.includes("/")?!!e.type&&O(e.type.replace(/;.*?$/,""),t):!("."!==t[0]||!e.extension)&&e.extension.toLowerCase()===t.slice(1).toLowerCase()))){const e=o.join(", ");throw new k(this.i18n("youCanOnlyUploadFileTypes",{types:e}))}}if(r&&null!=e.size){const i=t.reduce(((e,t)=>e+t.size),e.size);if(i>r)throw new k(this.i18n("exceedsSize",{size:_(r),file:e.name}))}if(i&&null!=e.size&&e.size>i)throw new k(this.i18n("exceedsSize",{size:_(i),file:e.name}));if(s&&null!=e.size&&e.size<s)throw new k(this.i18n("inferiorSize",{size:_(s)}))}validateMinNumberOfFiles(e){const{minNumberOfFiles:t}=this.getOpts().restrictions;if(Object.keys(e).length<t)throw new k(this.i18n("youHaveToAtLeastSelectX",{smart_count:t}))}getMissingRequiredMetaFields(e){const t=new k(this.i18n("missingRequiredMetaFieldOnFile",{fileName:e.name})),{requiredMetaFields:i}=this.getOpts().restrictions,s=[];for(const t of i)Object.hasOwn(e.meta,t)&&""!==e.meta[t]||s.push(t);return{missingFields:s,error:t}}}const x={strings:{addBulkFilesFailed:{0:"Failed to add %{smart_count} file due to an internal error",1:"Failed to add %{smart_count} files due to internal errors"},youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},exceedsSize:"%{file} exceeds maximum allowed size of %{size}",missingRequiredMetaField:"Missing required meta fields",missingRequiredMetaFieldOnFile:"Missing required meta fields in %{fileName}",inferiorSize:"This file is smaller than the allowed size of %{size}",youCanOnlyUploadFileTypes:"You can only upload: %{types}",noMoreFilesAllowed:"Cannot add more files",noDuplicates:"Cannot add the duplicate file '%{fileName}', it already exists",companionError:"Connection with Companion failed",authAborted:"Authentication aborted",companionUnauthorizeHint:"To unauthorize to your %{provider} account, please go to %{url}",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",selectX:{0:"Select %{smart_count}",1:"Select %{smart_count}"},allFilesFromFolderNamed:"All files from folder %{name}",openFolderNamed:"Open folder %{name}",cancel:"Cancel",logOut:"Log out",filter:"Filter",resetFilter:"Reset filter",loading:"Loading...",authenticateWithTitle:"Please authenticate with %{pluginName} to select files",authenticateWith:"Connect to %{pluginName}",signInWithGoogle:"Sign in with Google",searchImages:"Search for images",enterTextToSearch:"Enter text to search for images",search:"Search",emptyFolderAdded:"No files were added from empty folder",folderAlreadyAdded:'The folder "%{folder}" was already added',folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"}}};let E,F;function T(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var U=0;function A(e){return"__private_"+U+++"_"+e}var j=A("plugins"),C=A("restricter"),D=A("storeUnsubscribe"),N=A("emitter"),L=A("preProcessors"),I=A("uploaders"),R=A("postProcessors"),M=A("informAndEmit"),$=A("checkRequiredMetaFieldsOnFile"),z=A("checkRequiredMetaFields"),B=A("assertNewUploadAllowed"),V=A("checkAndCreateFileStateObject"),q=A("startIfAutoProceed"),H=A("addListeners"),G=A("updateOnlineStatus"),W=A("createUpload"),X=A("getUpload"),K=A("removeUpload"),Z=A("runUpload");E=Symbol.for("uppy test: getPlugins"),F=Symbol.for("uppy test: createUpload");class Y{constructor(e){Object.defineProperty(this,Z,{value:le}),Object.defineProperty(this,K,{value:ae}),Object.defineProperty(this,X,{value:oe}),Object.defineProperty(this,W,{value:ne}),Object.defineProperty(this,H,{value:re}),Object.defineProperty(this,q,{value:se}),Object.defineProperty(this,V,{value:ie}),Object.defineProperty(this,B,{value:te}),Object.defineProperty(this,z,{value:ee}),Object.defineProperty(this,$,{value:Q}),Object.defineProperty(this,M,{value:J}),Object.defineProperty(this,j,{writable:!0,value:Object.create(null)}),Object.defineProperty(this,C,{writable:!0,value:void 0}),Object.defineProperty(this,D,{writable:!0,value:void 0}),Object.defineProperty(this,N,{writable:!0,value:r()}),Object.defineProperty(this,L,{writable:!0,value:new Set}),Object.defineProperty(this,I,{writable:!0,value:new Set}),Object.defineProperty(this,R,{writable:!0,value:new Set}),Object.defineProperty(this,G,{writable:!0,value:this.updateOnlineStatus.bind(this)}),this.defaultLocale=x;const t={id:"uppy",autoProceed:!1,allowMultipleUploadBatches:!0,debug:!1,restrictions:S,meta:{},onBeforeFileAdded:e=>e,onBeforeUpload:e=>e,store:new f,logger:w,infoTimeout:5e3};this.opts={...t,...e,restrictions:{...t.restrictions,...e&&e.restrictions}},e&&e.logger&&e.debug?this.log("You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.","warning"):e&&e.debug&&(this.opts.logger=b),this.log(`Using Core v${this.constructor.VERSION}`),this.i18nInit(),this.calculateProgress=o(this.calculateProgress.bind(this),500,{leading:!0,trailing:!0}),this.store=this.opts.store,this.setState({plugins:{},files:{},currentUploads:{},allowNewUpload:!0,capabilities:{uploadProgress:v(),individualCancellation:!0,resumableUploads:!1},totalProgress:0,meta:{...this.opts.meta},info:[],recoveredState:null}),T(this,C)[C]=new P((()=>this.opts),this.i18n),T(this,D)[D]=this.store.subscribe(((e,t,i)=>{this.emit("state-update",e,t,i),this.updateAll(t)})),this.opts.debug&&"undefined"!=typeof window&&(window[this.opts.id]=this),T(this,H)[H]()}emit(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];T(this,N)[N].emit(e,...i)}on(e,t){return T(this,N)[N].on(e,t),this}once(e,t){return T(this,N)[N].once(e,t),this}off(e,t){return T(this,N)[N].off(e,t),this}updateAll(e){this.iteratePlugins((t=>{t.update(e)}))}setState(e){this.store.setState(e)}getState(){return this.store.getState()}setFileState(e,t){if(!this.getState().files[e])throw new Error(`Cant set state for ${e} (the file could have been removed)`);this.setState({files:{...this.getState().files,[e]:{...this.getState().files[e],...t}}})}i18nInit(){const e=new s.Z([this.defaultLocale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.locale=e.locale}setOptions(e){this.opts={...this.opts,...e,restrictions:{...this.opts.restrictions,...e&&e.restrictions}},e.meta&&this.setMeta(e.meta),this.i18nInit(),e.locale&&this.iteratePlugins((e=>{e.setOptions()})),this.setState()}resetProgress(){const e={percentage:0,bytesUploaded:0,uploadComplete:!1,uploadStarted:null},t={...this.getState().files},i={};Object.keys(t).forEach((s=>{const r={...t[s]};r.progress={...r.progress,...e},i[s]=r})),this.setState({files:i,totalProgress:0}),this.emit("reset-progress")}addPreProcessor(e){T(this,L)[L].add(e)}removePreProcessor(e){return T(this,L)[L].delete(e)}addPostProcessor(e){T(this,R)[R].add(e)}removePostProcessor(e){return T(this,R)[R].delete(e)}addUploader(e){T(this,I)[I].add(e)}removeUploader(e){return T(this,I)[I].delete(e)}setMeta(e){const t={...this.getState().meta,...e},i={...this.getState().files};Object.keys(i).forEach((t=>{i[t]={...i[t],meta:{...i[t].meta,...e}}})),this.log("Adding metadata:"),this.log(e),this.setState({meta:t,files:i})}setFileMeta(e,t){const i={...this.getState().files};if(!i[e])return void this.log("Was trying to set metadata for a file that has been removed: ",e);const s={...i[e].meta,...t};i[e]={...i[e],meta:s},this.setState({files:i})}getFile(e){return this.getState().files[e]}getFiles(){const{files:e}=this.getState();return Object.values(e)}getObjectOfFilesPerState(){const{files:e,totalProgress:t,error:i}=this.getState(),s=Object.values(e),r=s.filter((e=>{let{progress:t}=e;return!t.uploadComplete&&t.uploadStarted})),n=s.filter((e=>!e.progress.uploadStarted)),o=s.filter((e=>e.progress.uploadStarted||e.progress.preprocess||e.progress.postprocess)),a=s.filter((e=>e.progress.uploadStarted)),l=s.filter((e=>e.isPaused)),u=s.filter((e=>e.progress.uploadComplete)),h=s.filter((e=>e.error)),d=r.filter((e=>!e.isPaused)),c=s.filter((e=>e.progress.preprocess||e.progress.postprocess));return{newFiles:n,startedFiles:o,uploadStartedFiles:a,pausedFiles:l,completeFiles:u,erroredFiles:h,inProgressFiles:r,inProgressNotPausedFiles:d,processingFiles:c,isUploadStarted:a.length>0,isAllComplete:100===t&&u.length===s.length&&0===c.length,isAllErrored:!!i&&h.length===s.length,isAllPaused:0!==r.length&&l.length===r.length,isUploadInProgress:r.length>0,isSomeGhost:s.some((e=>e.isGhost))}}validateRestrictions(e,t){void 0===t&&(t=this.getFiles());try{T(this,C)[C].validate(e,t)}catch(e){return e}return null}checkIfFileAlreadyExists(e){const{files:t}=this.getState();return!(!t[e]||t[e].isGhost)}addFile(e){T(this,B)[B](e);const{files:t}=this.getState();let i=T(this,V)[V](t,e);return t[i.id]&&t[i.id].isGhost&&(i={...t[i.id],data:e.data,isGhost:!1},this.log(`Replaced the blob in the restored ghost file: ${i.name}, ${i.id}`)),this.setState({files:{...t,[i.id]:i}}),this.emit("file-added",i),this.emit("files-added",[i]),this.log(`Added file: ${i.name}, ${i.id}, mime type: ${i.type}`),T(this,q)[q](),i.id}addFiles(e){T(this,B)[B]();const t={...this.getState().files},i=[],s=[];for(let r=0;r<e.length;r++)try{let s=T(this,V)[V](t,e[r]);t[s.id]&&t[s.id].isGhost&&(s={...t[s.id],data:e[r].data,isGhost:!1},this.log(`Replaced blob in a ghost file: ${s.name}, ${s.id}`)),t[s.id]=s,i.push(s)}catch(e){e.isRestriction||s.push(e)}if(this.setState({files:t}),i.forEach((e=>{this.emit("file-added",e)})),this.emit("files-added",i),i.length>5?this.log(`Added batch of ${i.length} files`):Object.keys(i).forEach((e=>{this.log(`Added file: ${i[e].name}\n id: ${i[e].id}\n type: ${i[e].type}`)})),i.length>0&&T(this,q)[q](),s.length>0){let e="Multiple errors occurred while adding files:\n";if(s.forEach((t=>{e+=`\n * ${t.message}`})),this.info({message:this.i18n("addBulkFilesFailed",{smart_count:s.length}),details:e},"error",this.opts.infoTimeout),"function"==typeof AggregateError)throw new AggregateError(s,e);{const t=new Error(e);throw t.errors=s,t}}}removeFiles(e,t){const{files:i,currentUploads:s}=this.getState(),r={...i},n={...s},o=Object.create(null);function a(e){return void 0===o[e]}e.forEach((e=>{i[e]&&(o[e]=i[e],delete r[e])})),Object.keys(n).forEach((e=>{const t=s[e].fileIDs.filter(a);if(0===t.length)return void delete n[e];const{capabilities:i}=this.getState();if(t.length!==s[e].fileIDs.length&&!i.individualCancellation)throw new Error("individualCancellation is disabled");n[e]={...s[e],fileIDs:t}}));const l={currentUploads:n,files:r};0===Object.keys(r).length&&(l.allowNewUpload=!0,l.error=null,l.recoveredState=null),this.setState(l),this.calculateTotalProgress();const u=Object.keys(o);u.forEach((e=>{this.emit("file-removed",o[e],t)})),u.length>5?this.log(`Removed ${u.length} files`):this.log(`Removed files: ${u.join(", ")}`)}removeFile(e,t){void 0===t&&(t=null),this.removeFiles([e],t)}pauseResume(e){if(!this.getState().capabilities.resumableUploads||this.getFile(e).uploadComplete)return;const t=!(this.getFile(e).isPaused||!1);return this.setFileState(e,{isPaused:t}),this.emit("upload-pause",e,t),t}pauseAll(){const e={...this.getState().files};Object.keys(e).filter((t=>!e[t].progress.uploadComplete&&e[t].progress.uploadStarted)).forEach((t=>{const i={...e[t],isPaused:!0};e[t]=i})),this.setState({files:e}),this.emit("pause-all")}resumeAll(){const e={...this.getState().files};Object.keys(e).filter((t=>!e[t].progress.uploadComplete&&e[t].progress.uploadStarted)).forEach((t=>{const i={...e[t],isPaused:!1,error:null};e[t]=i})),this.setState({files:e}),this.emit("resume-all")}retryAll(){const e={...this.getState().files},t=Object.keys(e).filter((t=>e[t].error));if(t.forEach((t=>{const i={...e[t],isPaused:!1,error:null};e[t]=i})),this.setState({files:e,error:null}),this.emit("retry-all",t),0===t.length)return Promise.resolve({successful:[],failed:[]});const i=T(this,W)[W](t,{forceAllowNewUpload:!0});return T(this,Z)[Z](i)}cancelAll(e){let{reason:t="user"}=void 0===e?{}:e;if(this.emit("cancel-all",{reason:t}),"user"===t){const{files:e}=this.getState(),t=Object.keys(e);t.length&&this.removeFiles(t,"cancel-all"),this.setState({totalProgress:0,error:null,recoveredState:null})}}retryUpload(e){this.setFileState(e,{error:null,isPaused:!1}),this.emit("upload-retry",e);const t=T(this,W)[W]([e],{forceAllowNewUpload:!0});return T(this,Z)[Z](t)}logout(){this.iteratePlugins((e=>{e.provider&&e.provider.logout&&e.provider.logout()}))}calculateProgress(e,t){if(null==e||!this.getFile(e.id))return void this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`);const i=Number.isFinite(t.bytesTotal)&&t.bytesTotal>0;this.setFileState(e.id,{progress:{...this.getFile(e.id).progress,bytesUploaded:t.bytesUploaded,bytesTotal:t.bytesTotal,percentage:i?Math.round(t.bytesUploaded/t.bytesTotal*100):0}}),this.calculateTotalProgress()}calculateTotalProgress(){const e=this.getFiles().filter((e=>e.progress.uploadStarted||e.progress.preprocess||e.progress.postprocess));if(0===e.length)return this.emit("progress",0),void this.setState({totalProgress:0});const t=e.filter((e=>null!=e.progress.bytesTotal)),i=e.filter((e=>null==e.progress.bytesTotal));if(0===t.length){const t=100*e.length,s=i.reduce(((e,t)=>e+t.progress.percentage),0),r=Math.round(s/t*100);return void this.setState({totalProgress:r})}let s=t.reduce(((e,t)=>e+t.progress.bytesTotal),0);const r=s/t.length;s+=r*i.length;let n=0;t.forEach((e=>{n+=e.progress.bytesUploaded})),i.forEach((e=>{n+=r*(e.progress.percentage||0)/100}));let o=0===s?0:Math.round(n/s*100);o>100&&(o=100),this.setState({totalProgress:o}),this.emit("progress",o)}updateOnlineStatus(){void 0===window.navigator.onLine||window.navigator.onLine?(this.emit("is-online"),this.wasOffline&&(this.emit("back-online"),this.info(this.i18n("connectedToInternet"),"success",3e3),this.wasOffline=!1)):(this.emit("is-offline"),this.info(this.i18n("noInternetConnection"),"error",0),this.wasOffline=!0)}getID(){return this.opts.id}use(e,t){if("function"!=typeof e){throw new TypeError(`Expected a plugin class, but got ${null===e?"null":typeof e}. Please verify that the plugin was imported and spelled correctly.`)}const i=new e(this,t),s=i.id;if(!s)throw new Error("Your plugin must have an id");if(!i.type)throw new Error("Your plugin must have a type");const r=this.getPlugin(s);if(r){const e=`Already found a plugin named '${r.id}'. Tried to use: '${s}'.\nUppy plugins must have unique \`id\` options. See https://uppy.io/docs/plugins/#id.`;throw new Error(e)}return e.VERSION&&this.log(`Using ${s} v${e.VERSION}`),i.type in T(this,j)[j]?T(this,j)[j][i.type].push(i):T(this,j)[j][i.type]=[i],i.install(),this}getPlugin(e){for(const t of Object.values(T(this,j)[j])){const i=t.find((t=>t.id===e));if(null!=i)return i}}[E](e){return T(this,j)[j][e]}iteratePlugins(e){Object.values(T(this,j)[j]).flat(1).forEach(e)}removePlugin(e){this.log(`Removing plugin ${e.id}`),this.emit("plugin-remove",e),e.uninstall&&e.uninstall();const t=T(this,j)[j][e.type],i=t.findIndex((t=>t.id===e.id));-1!==i&&t.splice(i,1);const s={plugins:{...this.getState().plugins,[e.id]:void 0}};this.setState(s)}close(e){let{reason:t}=void 0===e?{}:e;this.log(`Closing Uppy instance ${this.opts.id}: removing all files and uninstalling plugins`),this.cancelAll({reason:t}),T(this,D)[D](),this.iteratePlugins((e=>{this.removePlugin(e)})),"undefined"!=typeof window&&window.removeEventListener&&(window.removeEventListener("online",T(this,G)[G]),window.removeEventListener("offline",T(this,G)[G]))}hideInfo(){const{info:e}=this.getState();this.setState({info:e.slice(1)}),this.emit("info-hidden")}info(e,t,i){void 0===t&&(t="info"),void 0===i&&(i=3e3);const s="object"==typeof e;this.setState({info:[...this.getState().info,{type:t,message:s?e.message:e,details:s?e.details:null}]}),setTimeout((()=>this.hideInfo()),i),this.emit("info-visible")}log(e,t){const{logger:i}=this.opts;switch(t){case"error":i.error(e);break;case"warning":i.warn(e);break;default:i.debug(e)}}restore(e){return this.log(`Core: attempting to restore upload "${e}"`),this.getState().currentUploads[e]?T(this,Z)[Z](e):(T(this,K)[K](e),Promise.reject(new Error("Nonexistent upload")))}[F](){return T(this,W)[W](...arguments)}addResultData(e,t){if(!T(this,X)[X](e))return void this.log(`Not setting result for an upload that has been removed: ${e}`);const{currentUploads:i}=this.getState(),s={...i[e],result:{...i[e].result,...t}};this.setState({currentUploads:{...i,[e]:s}})}upload(){var e;null!=(e=T(this,j)[j].uploader)&&e.length||this.log("No uploader type plugins are used","warning");let{files:t}=this.getState();const i=this.opts.onBeforeUpload(t);return!1===i?Promise.reject(new Error("Not starting the upload because onBeforeUpload returned false")):(i&&"object"==typeof i&&(t=i,this.setState({files:t})),Promise.resolve().then((()=>T(this,C)[C].validateMinNumberOfFiles(t))).catch((e=>{throw T(this,M)[M](e),e})).then((()=>{if(!T(this,z)[z](t))throw new k(this.i18n("missingRequiredMetaField"))})).catch((e=>{throw e})).then((()=>{const{currentUploads:e}=this.getState(),i=Object.values(e).flatMap((e=>e.fileIDs)),s=[];Object.keys(t).forEach((e=>{const t=this.getFile(e);t.progress.uploadStarted||-1!==i.indexOf(e)||s.push(t.id)}));const r=T(this,W)[W](s);return T(this,Z)[Z](r)})).catch((e=>{throw this.emit("error",e),this.log(e,"error"),e})))}}function J(e,t){const{message:i,details:s=""}=e;e.isRestriction?this.emit("restriction-failed",t,e):this.emit("error",e),this.info({message:i,details:s},"error",this.opts.infoTimeout),this.log(`${i} ${s}`.trim(),"error")}function Q(e){const{missingFields:t,error:i}=T(this,C)[C].getMissingRequiredMetaFields(e);return!(t.length>0)||(this.setFileState(e.id,{missingRequiredMetaFields:t}),this.log(i.message),this.emit("restriction-failed",e,i),!1)}function ee(e){let t=!0;for(const i of Object.values(e))T(this,$)[$](i)||(t=!1);return t}function te(e){const{allowNewUpload:t}=this.getState();if(!1===t){const t=new k(this.i18n("noMoreFilesAllowed"));throw T(this,M)[M](t,e),t}}function ie(e,t){t instanceof File&&(t={name:t.name,type:t.type,size:t.size,data:t});const i=function(e){var t;if(e.type)return e.type;const i=e.name?null==(t=g(e.name).extension)?void 0:t.toLowerCase():null;return i&&i in m?m[i]:"application/octet-stream"}(t),s=function(e,t){return t.name?t.name:"image"===e.split("/")[0]?`${e.split("/")[0]}.${e.split("/")[1]}`:"noname"}(i,t),r=g(s).extension,n=Boolean(t.isRemote),o=function(e){let t="uppy";return"string"==typeof e.name&&(t+=`-${y(e.name.toLowerCase())}`),void 0!==e.type&&(t+=`-${e.type}`),e.meta&&"string"==typeof e.meta.relativePath&&(t+=`-${y(e.meta.relativePath.toLowerCase())}`),void 0!==e.data.size&&(t+=`-${e.data.size}`),void 0!==e.data.lastModified&&(t+=`-${e.data.lastModified}`),t}({...t,type:i});if(this.checkIfFileAlreadyExists(o)){const e=new k(this.i18n("noDuplicates",{fileName:s}));throw T(this,M)[M](e,t),e}const a=t.meta||{};a.name=s,a.type=i;const l=Number.isFinite(t.data.size)?t.data.size:null;let u={source:t.source||"",id:o,name:s,extension:r||"",meta:{...this.getState().meta,...a},type:i,data:t.data,progress:{percentage:0,bytesUploaded:0,bytesTotal:l,uploadComplete:!1,uploadStarted:null},size:l,isRemote:n,remote:t.remote||"",preview:t.preview};const h=this.opts.onBeforeFileAdded(u,e);if(!1===h){const e=new k("Cannot add the file because onBeforeFileAdded returned false.");throw this.emit("restriction-failed",t,e),e}"object"==typeof h&&null!==h&&(u=h);try{const t=Object.keys(e).map((t=>e[t]));T(this,C)[C].validate(u,t)}catch(e){throw T(this,M)[M](e,u),e}return u}function se(){this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout((()=>{this.scheduledAutoProceed=null,this.upload().catch((e=>{e.isRestriction||this.log(e.stack||e.message||e)}))}),4))}function re(){const e=(e,t,i)=>{let s=e.message||"Unknown error";e.details&&(s+=` ${e.details}`),this.setState({error:s}),null!=t&&t.id in this.getState().files&&this.setFileState(t.id,{error:s,response:i})};this.on("error",e),this.on("upload-error",((t,i,s)=>{if(e(i,t,s),"object"==typeof i&&i.message){const e=new Error(i.message);e.details=i.message,i.details&&(e.details+=` ${i.details}`),e.message=this.i18n("failedToUpload",{file:null==t?void 0:t.name}),T(this,M)[M](e)}else T(this,M)[M](i)})),this.on("upload",(()=>{this.setState({error:null})})),this.on("upload-started",(e=>{null!=e&&this.getFile(e.id)?this.setFileState(e.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,percentage:0,bytesUploaded:0,bytesTotal:e.size}}):this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`)})),this.on("upload-progress",this.calculateProgress),this.on("upload-success",((e,t)=>{if(null==e||!this.getFile(e.id))return void this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`);const i=this.getFile(e.id).progress;this.setFileState(e.id,{progress:{...i,postprocess:T(this,R)[R].size>0?{mode:"indeterminate"}:null,uploadComplete:!0,percentage:100,bytesUploaded:i.bytesTotal},response:t,uploadURL:t.uploadURL,isPaused:!1}),null==e.size&&this.setFileState(e.id,{size:t.bytesUploaded||i.bytesTotal}),this.calculateTotalProgress()})),this.on("preprocess-progress",((e,t)=>{null!=e&&this.getFile(e.id)?this.setFileState(e.id,{progress:{...this.getFile(e.id).progress,preprocess:t}}):this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`)})),this.on("preprocess-complete",(e=>{if(null==e||!this.getFile(e.id))return void this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`);const t={...this.getState().files};t[e.id]={...t[e.id],progress:{...t[e.id].progress}},delete t[e.id].progress.preprocess,this.setState({files:t})})),this.on("postprocess-progress",((e,t)=>{null!=e&&this.getFile(e.id)?this.setFileState(e.id,{progress:{...this.getState().files[e.id].progress,postprocess:t}}):this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`)})),this.on("postprocess-complete",(e=>{if(null==e||!this.getFile(e.id))return void this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`);const t={...this.getState().files};t[e.id]={...t[e.id],progress:{...t[e.id].progress}},delete t[e.id].progress.postprocess,this.setState({files:t})})),this.on("restored",(()=>{this.calculateTotalProgress()})),this.on("dashboard:file-edit-complete",(e=>{e&&T(this,$)[$](e)})),"undefined"!=typeof window&&window.addEventListener&&(window.addEventListener("online",T(this,G)[G]),window.addEventListener("offline",T(this,G)[G]),setTimeout(T(this,G)[G],3e3))}function ne(e,t){void 0===t&&(t={});const{forceAllowNewUpload:i=!1}=t,{allowNewUpload:s,currentUploads:r}=this.getState();if(!s&&!i)throw new Error("Cannot create a new upload: already uploading.");const o=(0,n.x)();return this.emit("upload",{id:o,fileIDs:e}),this.setState({allowNewUpload:!1!==this.opts.allowMultipleUploadBatches&&!1!==this.opts.allowMultipleUploads,currentUploads:{...r,[o]:{fileIDs:e,step:0,result:{}}}}),o}function oe(e){const{currentUploads:t}=this.getState();return t[e]}function ae(e){const t={...this.getState().currentUploads};delete t[e],this.setState({currentUploads:t})}async function le(e){let{currentUploads:t}=this.getState(),i=t[e];const s=i.step||0,r=[...T(this,L)[L],...T(this,I)[I],...T(this,R)[R]];try{for(let n=s;n<r.length&&i;n++){const s=r[n],o={...i,step:n};this.setState({currentUploads:{...t,[e]:o}}),await s(o.fileIDs,e),t=this.getState().currentUploads,i=t[e]}}catch(t){throw T(this,K)[K](e),t}if(i){i.fileIDs.forEach((e=>{const t=this.getFile(e);t&&t.progress.postprocess&&this.emit("postprocess-complete",t)}));const s=i.fileIDs.map((e=>this.getFile(e))),r=s.filter((e=>!e.error)),n=s.filter((e=>e.error));await this.addResultData(e,{successful:r,failed:n,uploadID:e}),t=this.getState().currentUploads,i=t[e]}let n;return i&&(n=i.result,this.emit("complete",n),T(this,K)[K](e)),null==n&&this.log(`Not setting result for an upload that has been removed: ${e}`),n}Y.VERSION="3.0.0";const ue=Y;var he,de,ce,pe,fe,ge={},me=[],ye=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function ve(e,t){for(var i in t)e[i]=t[i];return e}function we(e){var t=e.parentNode;t&&t.removeChild(e)}function be(e,t,i,s,r){var n={type:e,props:t,key:i,ref:s,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==r?++ce:r};return null==r&&null!=de.vnode&&de.vnode(n),n}function _e(e){return e.children}function Oe(e,t){this.props=e,this.context=t}function Se(e,t){if(null==t)return e.__?Se(e.__,e.__.__k.indexOf(e)+1):null;for(var i;t<e.__k.length;t++)if(null!=(i=e.__k[t])&&null!=i.__e)return i.__e;return"function"==typeof e.type?Se(e):null}function ke(e){var t,i;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(i=e.__k[t])&&null!=i.__e){e.__e=e.__c.base=i.__e;break}return ke(e)}}function Pe(e){(!e.__d&&(e.__d=!0)&&pe.push(e)&&!xe.__r++||fe!==de.debounceRendering)&&((fe=de.debounceRendering)||setTimeout)(xe)}function xe(){for(var e;xe.__r=pe.length;)e=pe.sort((function(e,t){return e.__v.__b-t.__v.__b})),pe=[],e.some((function(e){var t,i,s,r,n,o;e.__d&&(n=(r=(t=e).__v).__e,(o=t.__P)&&(i=[],(s=ve({},r)).__v=r.__v+1,De(o,r,s,t.__n,void 0!==o.ownerSVGElement,null!=r.__h?[n]:null,i,null==n?Se(r):n,r.__h),Ne(i,r),r.__e!=n&&ke(r)))}))}function Ee(e,t,i,s,r,n,o,a,l,u){var h,d,c,p,f,g,m,y=s&&s.__k||me,v=y.length;for(i.__k=[],h=0;h<t.length;h++)if(null!=(p=i.__k[h]=null==(p=t[h])||"boolean"==typeof p?null:"string"==typeof p||"number"==typeof p||"bigint"==typeof p?be(null,p,null,null,p):Array.isArray(p)?be(_e,{children:p},null,null,null):p.__b>0?be(p.type,p.props,p.key,null,p.__v):p)){if(p.__=i,p.__b=i.__b+1,null===(c=y[h])||c&&p.key==c.key&&p.type===c.type)y[h]=void 0;else for(d=0;d<v;d++){if((c=y[d])&&p.key==c.key&&p.type===c.type){y[d]=void 0;break}c=null}De(e,p,c=c||ge,r,n,o,a,l,u),f=p.__e,(d=p.ref)&&c.ref!=d&&(m||(m=[]),c.ref&&m.push(c.ref,null,p),m.push(d,p.__c||f,p)),null!=f?(null==g&&(g=f),"function"==typeof p.type&&p.__k===c.__k?p.__d=l=Fe(p,l,e):l=Te(e,p,c,y,f,l),"function"==typeof i.type&&(i.__d=l)):l&&c.__e==l&&l.parentNode!=e&&(l=Se(c))}for(i.__e=g,h=v;h--;)null!=y[h]&&("function"==typeof i.type&&null!=y[h].__e&&y[h].__e==i.__d&&(i.__d=Se(s,h+1)),Re(y[h],y[h]));if(m)for(h=0;h<m.length;h++)Ie(m[h],m[++h],m[++h])}function Fe(e,t,i){for(var s,r=e.__k,n=0;r&&n<r.length;n++)(s=r[n])&&(s.__=e,t="function"==typeof s.type?Fe(s,t,i):Te(i,s,s,r,s.__e,t));return t}function Te(e,t,i,s,r,n){var o,a,l;if(void 0!==t.__d)o=t.__d,t.__d=void 0;else if(null==i||r!=n||null==r.parentNode)e:if(null==n||n.parentNode!==e)e.appendChild(r),o=null;else{for(a=n,l=0;(a=a.nextSibling)&&l<s.length;l+=2)if(a==r)break e;e.insertBefore(r,n),o=n}return void 0!==o?o:r.nextSibling}function Ue(e,t,i){"-"===t[0]?e.setProperty(t,i):e[t]=null==i?"":"number"!=typeof i||ye.test(t)?i:i+"px"}function Ae(e,t,i,s,r){var n;e:if("style"===t)if("string"==typeof i)e.style.cssText=i;else{if("string"==typeof s&&(e.style.cssText=s=""),s)for(t in s)i&&t in i||Ue(e.style,t,"");if(i)for(t in i)s&&i[t]===s[t]||Ue(e.style,t,i[t])}else if("o"===t[0]&&"n"===t[1])n=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+n]=i,i?s||e.addEventListener(t,n?Ce:je,n):e.removeEventListener(t,n?Ce:je,n);else if("dangerouslySetInnerHTML"!==t){if(r)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=null==i?"":i;break e}catch(e){}"function"==typeof i||(null!=i&&(!1!==i||"a"===t[0]&&"r"===t[1])?e.setAttribute(t,i):e.removeAttribute(t))}}function je(e){this.l[e.type+!1](de.event?de.event(e):e)}function Ce(e){this.l[e.type+!0](de.event?de.event(e):e)}function De(e,t,i,s,r,n,o,a,l){var u,h,d,c,p,f,g,m,y,v,w,b,_,O=t.type;if(void 0!==t.constructor)return null;null!=i.__h&&(l=i.__h,a=t.__e=i.__e,t.__h=null,n=[a]),(u=de.__b)&&u(t);try{e:if("function"==typeof O){if(m=t.props,y=(u=O.contextType)&&s[u.__c],v=u?y?y.props.value:u.__:s,i.__c?g=(h=t.__c=i.__c).__=h.__E:("prototype"in O&&O.prototype.render?t.__c=h=new O(m,v):(t.__c=h=new Oe(m,v),h.constructor=O,h.render=Me),y&&y.sub(h),h.props=m,h.state||(h.state={}),h.context=v,h.__n=s,d=h.__d=!0,h.__h=[]),null==h.__s&&(h.__s=h.state),null!=O.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=ve({},h.__s)),ve(h.__s,O.getDerivedStateFromProps(m,h.__s))),c=h.props,p=h.state,d)null==O.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(null==O.getDerivedStateFromProps&&m!==c&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(m,v),!h.__e&&null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(m,h.__s,v)||t.__v===i.__v){h.props=m,h.state=h.__s,t.__v!==i.__v&&(h.__d=!1),h.__v=t,t.__e=i.__e,t.__k=i.__k,t.__k.forEach((function(e){e&&(e.__=t)})),h.__h.length&&o.push(h);break e}null!=h.componentWillUpdate&&h.componentWillUpdate(m,h.__s,v),null!=h.componentDidUpdate&&h.__h.push((function(){h.componentDidUpdate(c,p,f)}))}if(h.context=v,h.props=m,h.__v=t,h.__P=e,w=de.__r,b=0,"prototype"in O&&O.prototype.render)h.state=h.__s,h.__d=!1,w&&w(t),u=h.render(h.props,h.state,h.context);else do{h.__d=!1,w&&w(t),u=h.render(h.props,h.state,h.context),h.state=h.__s}while(h.__d&&++b<25);h.state=h.__s,null!=h.getChildContext&&(s=ve(ve({},s),h.getChildContext())),d||null==h.getSnapshotBeforeUpdate||(f=h.getSnapshotBeforeUpdate(c,p)),_=null!=u&&u.type===_e&&null==u.key?u.props.children:u,Ee(e,Array.isArray(_)?_:[_],t,i,s,r,n,o,a,l),h.base=t.__e,t.__h=null,h.__h.length&&o.push(h),g&&(h.__E=h.__=null),h.__e=!1}else null==n&&t.__v===i.__v?(t.__k=i.__k,t.__e=i.__e):t.__e=Le(i.__e,t,i,s,r,n,o,l);(u=de.diffed)&&u(t)}catch(e){t.__v=null,(l||null!=n)&&(t.__e=a,t.__h=!!l,n[n.indexOf(a)]=null),de.__e(e,t,i)}}function Ne(e,t){de.__c&&de.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){de.__e(e,t.__v)}}))}function Le(e,t,i,s,r,n,o,a){var l,u,h,d=i.props,c=t.props,p=t.type,f=0;if("svg"===p&&(r=!0),null!=n)for(;f<n.length;f++)if((l=n[f])&&"setAttribute"in l==!!p&&(p?l.localName===p:3===l.nodeType)){e=l,n[f]=null;break}if(null==e){if(null===p)return document.createTextNode(c);e=r?document.createElementNS("http://www.w3.org/2000/svg",p):document.createElement(p,c.is&&c),n=null,a=!1}if(null===p)d===c||a&&e.data===c||(e.data=c);else{if(n=n&&he.call(e.childNodes),u=(d=i.props||ge).dangerouslySetInnerHTML,h=c.dangerouslySetInnerHTML,!a){if(null!=n)for(d={},f=0;f<e.attributes.length;f++)d[e.attributes[f].name]=e.attributes[f].value;(h||u)&&(h&&(u&&h.__html==u.__html||h.__html===e.innerHTML)||(e.innerHTML=h&&h.__html||""))}if(function(e,t,i,s,r){var n;for(n in i)"children"===n||"key"===n||n in t||Ae(e,n,null,i[n],s);for(n in t)r&&"function"!=typeof t[n]||"children"===n||"key"===n||"value"===n||"checked"===n||i[n]===t[n]||Ae(e,n,t[n],i[n],s)}(e,c,d,r,a),h)t.__k=[];else if(f=t.props.children,Ee(e,Array.isArray(f)?f:[f],t,i,s,r&&"foreignObject"!==p,n,o,n?n[0]:i.__k&&Se(i,0),a),null!=n)for(f=n.length;f--;)null!=n[f]&&we(n[f]);a||("value"in c&&void 0!==(f=c.value)&&(f!==e.value||"progress"===p&&!f||"option"===p&&f!==d.value)&&Ae(e,"value",f,d.value,!1),"checked"in c&&void 0!==(f=c.checked)&&f!==e.checked&&Ae(e,"checked",f,d.checked,!1))}return e}function Ie(e,t,i){try{"function"==typeof e?e(t):e.current=t}catch(e){de.__e(e,i)}}function Re(e,t,i){var s,r;if(de.unmount&&de.unmount(e),(s=e.ref)&&(s.current&&s.current!==e.__e||Ie(s,null,t)),null!=(s=e.__c)){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(e){de.__e(e,t)}s.base=s.__P=null}if(s=e.__k)for(r=0;r<s.length;r++)s[r]&&Re(s[r],t,"function"!=typeof e.type);i||null==e.__e||we(e.__e),e.__e=e.__d=void 0}function Me(e,t,i){return this.constructor(e,i)}function $e(e,t,i){var s,r,n;de.__&&de.__(e,t),r=(s="function"==typeof i)?null:i&&i.__k||t.__k,n=[],De(t,e=(!s&&i||t).__k=function(e,t,i){var s,r,n,o={};for(n in t)"key"==n?s=t[n]:"ref"==n?r=t[n]:o[n]=t[n];if(arguments.length>2&&(o.children=arguments.length>3?he.call(arguments,2):i),"function"==typeof e&&null!=e.defaultProps)for(n in e.defaultProps)void 0===o[n]&&(o[n]=e.defaultProps[n]);return be(e,o,s,r,null)}(_e,null,[e]),r||ge,ge,void 0!==t.ownerSVGElement,!s&&i?[i]:r?null:t.firstChild?he.call(t.childNodes):null,n,!s&&i?i:r?r.__e:t.firstChild,s),Ne(n,e)}function ze(e,t){return void 0===t&&(t=document),"string"==typeof e?t.querySelector(e):(null==(i=e)?void 0:i.nodeType)===Node.ELEMENT_NODE?e:null;var i}he=me.slice,de={__e:function(e,t,i,s){for(var r,n,o;t=t.__;)if((r=t.__c)&&!r.__)try{if((n=r.constructor)&&null!=n.getDerivedStateFromError&&(r.setState(n.getDerivedStateFromError(e)),o=r.__d),null!=r.componentDidCatch&&(r.componentDidCatch(e,s||{}),o=r.__d),o)return r.__E=r}catch(t){e=t}throw e}},ce=0,Oe.prototype.setState=function(e,t){var i;i=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=ve({},this.state),"function"==typeof e&&(e=e(ve({},i),this.props)),e&&ve(i,e),null!=e&&this.__v&&(t&&this.__h.push(t),Pe(this))},Oe.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),Pe(this))},Oe.prototype.render=_e,pe=[],xe.__r=0;const Be=function(e){for(var t;e&&!e.dir;)e=e.parentNode;return null==(t=e)?void 0:t.dir};var Ve=i(8596);function qe(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var He=0;function Ge(e){return"__private_"+He+++"_"+e}var We=Ge("updateUI");class Xe extends Ve.Z{constructor(){super(...arguments),Object.defineProperty(this,We,{writable:!0,value:void 0})}mount(e,t){const i=t.id,s=ze(e);if(s){this.isTargetDOMEl=!0;const t=document.createElement("div");return t.classList.add("uppy-Root"),qe(this,We)[We]=function(e){let t=null,i=null;return function(){for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return i=r,t||(t=Promise.resolve().then((()=>(t=null,e(...i))))),t}}((e=>{this.uppy.getPlugin(this.id)&&($e(this.render(e),t),this.afterUpdate())})),this.uppy.log(`Installing ${i} to a DOM element '${e}'`),this.opts.replaceTargetContent&&(s.innerHTML=""),$e(this.render(this.uppy.getState()),t),this.el=t,s.appendChild(t),t.dir=this.opts.direction||Be(t)||"ltr",this.onMount(),this.el}let r;if("object"==typeof e&&e instanceof Xe)r=e;else if("function"==typeof e){const t=e;this.uppy.iteratePlugins((e=>{e instanceof t&&(r=e)}))}if(r)return this.uppy.log(`Installing ${i} to ${r.id}`),this.parent=r,this.el=r.addTarget(t),this.onMount(),this.el;this.uppy.log(`Not installing ${i}`);let n=`Invalid target option given to ${i}.`;throw n+="function"==typeof e?" The given target is not a Plugin class. Please check that you're not specifying a React Component instead of a plugin. If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.":"If you meant to target an HTML element, please make sure that the element exists. Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. (see https://github.com/transloadit/uppy/issues/1042)\n\nIf you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.",new Error(n)}update(e){var t,i;null!=this.el&&(null==(t=(i=qe(this,We))[We])||t.call(i,e))}unmount(){var e;this.isTargetDOMEl&&(null==(e=this.el)||e.remove());this.onUnmount()}onMount(){}onUnmount(){}}const Ke=Xe},4136:(e,t,i)=>{"use strict";function s(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}i.d(t,{Z:()=>u});var r=0;function n(e){return"__private_"+r+++"_"+e}function o(e,t,i){const s=[];return e.forEach((e=>"string"!=typeof e?s.push(e):t[Symbol.split](e).forEach(((e,t,r)=>{""!==e&&s.push(e),t<r.length-1&&s.push(i)})))),s}function a(e,t){const i=/\$/g;let s=[e];if(null==t)return s;for(const e of Object.keys(t))if("_"!==e){let r=t[e];"string"==typeof r&&(r=i[Symbol.replace](r,"$$$$")),s=o(s,new RegExp(`%\\{${e}\\}`,"g"),r)}return s}var l=n("apply");class u{constructor(e){Object.defineProperty(this,l,{value:h}),this.locale={strings:{},pluralize:e=>1===e?0:1},Array.isArray(e)?e.forEach(s(this,l)[l],this):s(this,l)[l](e)}translate(e,t){return this.translateArray(e,t).join("")}translateArray(e,t){if(!function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(this.locale.strings,e))throw new Error(`missing string: ${e}`);const i=this.locale.strings[e];if("object"==typeof i){if(t&&void 0!==t.smart_count){return a(i[this.locale.pluralize(t.smart_count)],t)}throw new Error("Attempted to use a string with plural forms, but no value was given for %{smart_count}")}return a(i,t)}}function h(e){if(null==e||!e.strings)return;const t=this.locale;this.locale={...t,strings:{...t.strings,...e.strings}},this.locale.pluralize=e.pluralize||t.pluralize}},5024:(e,t,i)=>{"use strict";i.d(t,{Z:()=>h});var s=i(9063);const r=/^data:([^/]+\/[^,;]+(?:[^,]*?))(;base64)?,([\s\S]*)$/;function n(e){return e.startsWith("blob:")}function o(e){return!!e&&/^[^/]+\/(jpe?g|gif|png|svg|svg\+xml|bmp|webp|avif)$/.test(e)}var a=i(1443);const l={strings:{generatingThumbnails:"Generating thumbnails..."}};function u(e,t,i){try{e.getContext("2d").getImageData(0,0,1,1)}catch(e){if(18===e.code)return Promise.reject(new Error("cannot read image, probably an svg with external resources"))}return e.toBlob?new Promise((s=>{e.toBlob(s,t,i)})).then((e=>{if(null===e)throw new Error("cannot read image, probably an svg with external resources");return e})):Promise.resolve().then((()=>function(e,t,i){var s,n;const o=r.exec(e),a=null!=(s=null!=(n=t.mimeType)?n:null==o?void 0:o[1])?s:"plain/text";let l;if(null!=o[2]){const e=atob(decodeURIComponent(o[3])),t=new Uint8Array(e.length);for(let i=0;i<e.length;i++)t[i]=e.charCodeAt(i);l=[t]}else l=[decodeURIComponent(o[3])];return i?new File(l,t.name||"",{type:a}):new Blob(l,{type:a})}(e.toDataURL(t,i),{}))).then((e=>{if(null===e)throw new Error("could not extract blob, probably an old browser");return e}))}class h extends s.di{constructor(e,t){super(e,t),this.onFileAdded=e=>{!e.preview&&e.data&&o(e.type)&&!e.isRemote&&this.addToQueue(e.id)},this.onCancelRequest=e=>{const t=this.queue.indexOf(e.id);-1!==t&&this.queue.splice(t,1)},this.onFileRemoved=e=>{const t=this.queue.indexOf(e.id);-1!==t&&this.queue.splice(t,1),e.preview&&n(e.preview)&&URL.revokeObjectURL(e.preview)},this.onRestored=()=>{this.uppy.getFiles().filter((e=>e.isRestored)).forEach((e=>{e.preview&&!n(e.preview)||this.addToQueue(e.id)}))},this.onAllFilesRemoved=()=>{this.queue=[]},this.waitUntilAllProcessed=e=>{e.forEach((e=>{const t=this.uppy.getFile(e);this.uppy.emit("preprocess-progress",t,{mode:"indeterminate",message:this.i18n("generatingThumbnails")})}));const t=()=>{e.forEach((e=>{const t=this.uppy.getFile(e);this.uppy.emit("preprocess-complete",t)}))};return new Promise((e=>{this.queueProcessing?this.uppy.once("thumbnail:all-generated",(()=>{t(),e()})):(t(),e())}))},this.type="modifier",this.id=this.opts.id||"ThumbnailGenerator",this.title="Thumbnail Generator",this.queue=[],this.queueProcessing=!1,this.defaultThumbnailDimension=200,this.thumbnailType=this.opts.thumbnailType||"image/jpeg",this.defaultLocale=l;if(this.opts={thumbnailWidth:null,thumbnailHeight:null,waitForThumbnailsBeforeUpload:!1,lazy:!1,...t},this.i18nInit(),this.opts.lazy&&this.opts.waitForThumbnailsBeforeUpload)throw new Error("ThumbnailGenerator: The `lazy` and `waitForThumbnailsBeforeUpload` options are mutually exclusive. Please ensure at most one of them is set to `true`.")}createThumbnail(e,t,i){const s=URL.createObjectURL(e.data),r=new Promise(((e,t)=>{const i=new Image;i.src=s,i.addEventListener("load",(()=>{URL.revokeObjectURL(s),e(i)})),i.addEventListener("error",(e=>{URL.revokeObjectURL(s),t(e.error||new Error("Could not create thumbnail"))}))})),n=(0,a.rotation)(e.data).catch((()=>1));return Promise.all([r,n]).then((e=>{let[s,r]=e;const n=this.getProportionalDimensions(s,t,i,r.deg),o=function(e,t){let i=e.width,s=e.height;90!==t.deg&&270!==t.deg||(i=e.height,s=e.width);const r=document.createElement("canvas");r.width=i,r.height=s;const n=r.getContext("2d");return n.translate(i/2,s/2),t.canvas&&(n.rotate(t.rad),n.scale(t.scaleX,t.scaleY)),n.drawImage(e,-e.width/2,-e.height/2,e.width,e.height),r}(s,r);return u(this.resizeImage(o,n.width,n.height),this.thumbnailType,80)})).then((e=>URL.createObjectURL(e)))}getProportionalDimensions(e,t,i,s){let r=e.width/e.height;return 90!==s&&270!==s||(r=e.height/e.width),null!=t?{width:t,height:Math.round(t/r)}:null!=i?{width:Math.round(i*r),height:i}:{width:this.defaultThumbnailDimension,height:Math.round(this.defaultThumbnailDimension/r)}}resizeImage(e,t,i){let s=function(e){const t=e.width/e.height,i=5e6,s=4096;let r=Math.floor(Math.sqrt(i*t)),n=Math.floor(i/Math.sqrt(i*t));if(r>s&&(r=s,n=Math.round(r/t)),n>s&&(n=s,r=Math.round(t*n)),e.width>r){const t=document.createElement("canvas");return t.width=r,t.height=n,t.getContext("2d").drawImage(e,0,0,r,n),t}return e}(e),r=Math.ceil(Math.log2(s.width/t));r<1&&(r=1);let n=t*2**(r-1),o=i*2**(r-1);for(;r--;){const e=document.createElement("canvas");e.width=n,e.height=o,e.getContext("2d").drawImage(s,0,0,n,o),s=e,n=Math.round(n/2),o=Math.round(o/2)}return s}setPreviewURL(e,t){this.uppy.setFileState(e,{preview:t})}addToQueue(e){this.queue.push(e),!1===this.queueProcessing&&this.processQueue()}processQueue(){if(this.queueProcessing=!0,this.queue.length>0){const e=this.uppy.getFile(this.queue.shift());return e?this.requestThumbnail(e).catch((()=>{})).then((()=>this.processQueue())):(this.uppy.log("[ThumbnailGenerator] file was removed before a thumbnail could be generated, but not removed from the queue. This is probably a bug","error"),Promise.resolve())}return this.queueProcessing=!1,this.uppy.log("[ThumbnailGenerator] Emptied thumbnail queue"),this.uppy.emit("thumbnail:all-generated"),Promise.resolve()}requestThumbnail(e){return o(e.type)&&!e.isRemote?this.createThumbnail(e,this.opts.thumbnailWidth,this.opts.thumbnailHeight).then((t=>{this.setPreviewURL(e.id,t),this.uppy.log(`[ThumbnailGenerator] Generated thumbnail for ${e.id}`),this.uppy.emit("thumbnail:generated",this.uppy.getFile(e.id),t)})).catch((t=>{this.uppy.log(`[ThumbnailGenerator] Failed thumbnail for ${e.id}:`,"warning"),this.uppy.log(t,"warning"),this.uppy.emit("thumbnail:error",this.uppy.getFile(e.id),t)})):Promise.resolve()}install(){this.uppy.on("file-removed",this.onFileRemoved),this.uppy.on("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("thumbnail:cancel",this.onCancelRequest)):(this.uppy.on("file-added",this.onFileAdded),this.uppy.on("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.addPreProcessor(this.waitUntilAllProcessed)}uninstall(){this.uppy.off("file-removed",this.onFileRemoved),this.uppy.off("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("thumbnail:cancel",this.onCancelRequest)):(this.uppy.off("file-added",this.onFileAdded),this.uppy.off("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.removePreProcessor(this.waitUntilAllProcessed)}}h.VERSION="3.0.0"},6594:(e,t,i)=>{"use strict";function s(e,t,i,r){let{onSuccess:n}=r;e.readEntries((r=>{const o=[...t,...r];r.length?queueMicrotask((()=>{s(e,o,i,{onSuccess:n})})):n(o)}),(e=>{i(e),n(t)}))}function r(e,t){return null==e?e:{kind:e.isFile?"file":e.isDirectory?"directory":void 0,name:e.name,getFile:()=>new Promise(((t,i)=>e.file(t,i))),async*values(){const i=e.createReader(),n=await new Promise((e=>{s(i,[],t,{onSuccess:i=>e(i.map((e=>r(e,t))))})}));yield*n}}}async function*n(e,t){if("file"===e.kind){const i=await e.getFile();null!==i&&(i.relativePath=t?`${t}/${e.name}`:null,yield i)}else if("directory"===e.kind)for await(const i of e.values())yield*n(i,`${t}/${e.name}`)}i.d(t,{Z:()=>a});var o=i(7581);async function a(e,t){let{logDropError:i=(()=>{})}=void 0===t?{}:t;try{const t=[];for await(const s of async function*(e,t){const i=await Promise.all(Array.from(e.items,(async e=>{var i;return{lastResortFile:e.getAsFile(),entry:null!=(i=await(null==e.getAsFileSystemHandle?void 0:e.getAsFileSystemHandle()))?i:r(e.webkitGetAsEntry(),t)}})));for(const{lastResortFile:e,entry:s}of i)if(null!=s)try{yield*n(s,"")}catch(i){e?yield e:t(i)}}(e,i))t.push(s);return t}catch{return function(e){const t=(0,o.Z)(e.files);return Promise.resolve(t)}(e)}}},8215:(e,t,i)=>{"use strict";function s(){const e=document.body;return"draggable"in e&&"ondragstart"in e&&"ondrop"in e&&("FormData"in window&&"FileReader"in window)}i.d(t,{Z:()=>s})},7581:(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});const s=Array.from},1144:(e,t,i)=>{"use strict";i.d(t,{Z:()=>Ce});var s={};i.r(s),i.d(s,{getItem:()=>x,removeItem:()=>E,setItem:()=>P});var r=i(8596),n=i(9022);class o extends Error{constructor(e,t){void 0===t&&(t=null),super("This looks like a network error, the endpoint might be blocked by an internet provider or a firewall."),this.cause=e,this.isNetworkError=!0,this.request=t}}const a=o;function l(){return fetch(...arguments).catch((e=>{throw"AbortError"===e.name?e:new a(e)}))}class u extends Error{constructor(e,t){var i,s;void 0===t&&(t={}),super(e),this.cause=t.cause,this.cause&&(i=this.cause,s="isNetworkError",Object.prototype.hasOwnProperty.call(i,s))&&(this.isNetworkError=this.cause.isNetworkError)}}const h=u;class d extends Error{constructor(){super("Authorization required"),this.name="AuthError",this.isAuthError=!0}}const c=d;let p;function f(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var g=0;function m(e){return"__private_"+g+++"_"+e}async function y(e){if(401===e.status)throw new c;const t=e.json();if(e.status<200||e.status>300){let i=`Failed request with status: ${e.status}. ${e.statusText}`;try{const e=await t;i=e.message?`${i} message: ${e.message}`:i,i=e.requestId?`${i} request-Id: ${e.requestId}`:i}finally{throw new Error(i)}}return t}var v=m("companionHeaders"),w=m("getPostResponseFunc"),b=m("getUrl"),_=m("errorHandler");p=Symbol.for("uppy test: getCompanionHeaders");class O{constructor(e,t){Object.defineProperty(this,_,{value:k}),Object.defineProperty(this,b,{value:S}),Object.defineProperty(this,v,{writable:!0,value:void 0}),Object.defineProperty(this,w,{writable:!0,value:e=>t=>e?t:this.onReceiveResponse(t)}),this.uppy=e,this.opts=t,this.onReceiveResponse=this.onReceiveResponse.bind(this),this.allowedHeaders=["accept","content-type","uppy-auth-token"],this.preflightDone=!1,f(this,v)[v]=null==t?void 0:t.companionHeaders}setCompanionHeaders(e){f(this,v)[v]=e}[p](){return f(this,v)[v]}get hostname(){const{companion:e}=this.uppy.getState(),t=this.opts.companionUrl;return(e&&e[t]?e[t]:t).replace(/\/$/,"")}headers(){return Promise.resolve({...O.defaultHeaders,...f(this,v)[v]})}onReceiveResponse(e){const t=this.uppy.getState().companion||{},i=this.opts.companionUrl,{headers:s}=e;return s.has("i-am")&&s.get("i-am")!==t[i]&&this.uppy.setState({companion:{...t,[i]:s.get("i-am")}}),e}preflight(e){return this.preflightDone?Promise.resolve(this.allowedHeaders.slice()):fetch(f(this,b)[b](e),{method:"OPTIONS"}).then((e=>(e.headers.has("access-control-allow-headers")&&(this.allowedHeaders=e.headers.get("access-control-allow-headers").split(",").map((e=>e.trim().toLowerCase()))),this.preflightDone=!0,this.allowedHeaders.slice()))).catch((e=>(this.uppy.log(`[CompanionClient] unable to make preflight request ${e}`,"warning"),this.preflightDone=!0,this.allowedHeaders.slice())))}preflightAndHeaders(e){return Promise.all([this.preflight(e),this.headers()]).then((e=>{let[t,i]=e;return Object.keys(i).forEach((e=>{t.includes(e.toLowerCase())||(this.uppy.log(`[CompanionClient] excluding disallowed header ${e}`),delete i[e])})),i}))}get(e,t){return this.preflightAndHeaders(e).then((t=>l(f(this,b)[b](e),{method:"get",headers:t,credentials:this.opts.companionCookiesRule||"same-origin"}))).then(f(this,w)[w](t)).then(y).catch(f(this,_)[_]("get",e))}post(e,t,i){const s="post";return this.preflightAndHeaders(e).then((i=>l(f(this,b)[b](e),{method:s,headers:i,credentials:this.opts.companionCookiesRule||"same-origin",body:JSON.stringify(t)}))).then(f(this,w)[w](i)).then(y).catch(f(this,_)[_](s,e))}delete(e,t,i){const s="delete";return this.preflightAndHeaders(e).then((i=>l(`${this.hostname}/${e}`,{method:s,headers:i,credentials:this.opts.companionCookiesRule||"same-origin",body:t?JSON.stringify(t):null}))).then(f(this,w)[w](i)).then(y).catch(f(this,_)[_](s,e))}}function S(e){return/^(https?:|)\/\//.test(e)?e:`${this.hostname}/${e}`}function k(e,t){return i=>{var s;return null!=(s=i)&&s.isAuthError||(i=new h(`Could not ${e} ${f(this,b)[b](t)}`,{cause:i})),Promise.reject(i)}}function P(e,t){return new Promise((i=>{localStorage.setItem(e,t),i()}))}function x(e){return Promise.resolve(localStorage.getItem(e))}function E(e){return new Promise((t=>{localStorage.removeItem(e),t()}))}O.VERSION="3.0.0",O.defaultHeaders={Accept:"application/json","Content-Type":"application/json","Uppy-Versions":`@uppy/companion-client=${O.VERSION}`};class F extends O{constructor(e,t){super(e,t),this.provider=t.provider,this.id=this.provider,this.name=this.opts.name||(e=>e.split("-").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "))(this.id),this.pluginId=this.opts.pluginId,this.tokenKey=`companion-${this.pluginId}-auth-token`,this.companionKeysParams=this.opts.companionKeysParams,this.preAuthToken=null}headers(){return Promise.all([super.headers(),this.getAuthToken()]).then((e=>{let[t,i]=e;const s={};return i&&(s["uppy-auth-token"]=i),this.companionKeysParams&&(s["uppy-credentials-params"]=btoa(JSON.stringify({params:this.companionKeysParams}))),{...t,...s}}))}onReceiveResponse(e){e=super.onReceiveResponse(e);const t=this.uppy.getPlugin(this.pluginId),i=t.getPluginState().authenticated?401!==e.status:e.status<400;return t.setPluginState({authenticated:i}),e}setAuthToken(e){return this.uppy.getPlugin(this.pluginId).storage.setItem(this.tokenKey,e)}getAuthToken(){return this.uppy.getPlugin(this.pluginId).storage.getItem(this.tokenKey)}async ensurePreAuth(){if(this.companionKeysParams&&!this.preAuthToken&&(await this.fetchPreAuthToken(),!this.preAuthToken))throw new Error("Could not load authentication data required for third-party login. Please try again later.")}authUrl(e){void 0===e&&(e={});const t=new URLSearchParams(e);return this.preAuthToken&&t.set("uppyPreAuthToken",this.preAuthToken),`${this.hostname}/${this.id}/connect?${t}`}fileUrl(e){return`${this.hostname}/${this.id}/get/${e}`}async fetchPreAuthToken(){if(this.companionKeysParams)try{const e=await this.post(`${this.id}/preauth/`,{params:this.companionKeysParams});this.preAuthToken=e.token}catch(e){this.uppy.log(`[CompanionClient] unable to fetch preAuthToken ${e}`,"warning")}}list(e){return this.get(`${this.id}/list/${e||""}`)}logout(){return this.get(`${this.id}/logout`).then((e=>Promise.all([e,this.uppy.getPlugin(this.pluginId).storage.removeItem(this.tokenKey)]))).then((e=>{let[t]=e;return t}))}static initPlugin(e,t,i){if(e.type="acquirer",e.files=[],i&&(e.opts={...i,...t}),t.serverUrl||t.serverPattern)throw new Error("`serverUrl` and `serverPattern` have been renamed to `companionUrl` and `companionAllowedHosts` respectively in the 0.30.5 release. Please consult the docs (for example, https://uppy.io/docs/instagram/ for the Instagram plugin) and use the updated options.`");if(t.companionAllowedHosts){const i=t.companionAllowedHosts;if(!("string"==typeof i||Array.isArray(i)||i instanceof RegExp))throw new TypeError(`${e.id}: the option "companionAllowedHosts" must be one of string, Array, RegExp`);e.opts.companionAllowedHosts=i}else/^(?!https?:\/\/).*$/i.test(t.companionUrl)?e.opts.companionAllowedHosts=`https://${t.companionUrl.replace(/^\/\//,"")}`:e.opts.companionAllowedHosts=new URL(t.companionUrl).origin;e.storage=e.opts.storage||s}}var T=i(4800);let U,A;function j(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var C=0;function D(e){return"__private_"+C+++"_"+e}var N=D("queued"),L=D("emitter"),I=D("isOpen"),R=D("socket"),M=D("handleMessage");U=Symbol.for("uppy test: getSocket"),A=Symbol.for("uppy test: getQueued");class ${constructor(e){Object.defineProperty(this,N,{writable:!0,value:[]}),Object.defineProperty(this,L,{writable:!0,value:T()}),Object.defineProperty(this,I,{writable:!0,value:!1}),Object.defineProperty(this,R,{writable:!0,value:void 0}),Object.defineProperty(this,M,{writable:!0,value:e=>{try{const t=JSON.parse(e.data);this.emit(t.action,t.payload)}catch(e){}}}),this.opts=e,e&&!1===e.autoOpen||this.open()}get isOpen(){return j(this,I)[I]}[U](){return j(this,R)[R]}[A](){return j(this,N)[N]}open(){j(this,R)[R]=new WebSocket(this.opts.target),j(this,R)[R].onopen=()=>{for(j(this,I)[I]=!0;j(this,N)[N].length>0&&j(this,I)[I];){const e=j(this,N)[N].shift();this.send(e.action,e.payload)}},j(this,R)[R].onclose=()=>{j(this,I)[I]=!1},j(this,R)[R].onmessage=j(this,M)[M]}close(){var e;null==(e=j(this,R)[R])||e.close()}send(e,t){j(this,I)[I]?j(this,R)[R].send(JSON.stringify({action:e,payload:t})):j(this,N)[N].push({action:e,payload:t})}on(e,t){j(this,L)[L].on(e,t)}emit(e,t){j(this,L)[L].emit(e,t)}once(e,t){j(this,L)[L].once(e,t)}}const z=i(3096)((function(e,t,i){const{progress:s,bytesUploaded:r,bytesTotal:n}=t;s&&(e.uppy.log(`Upload progress: ${s}`),e.uppy.emit("upload-progress",i,{uploader:e,bytesUploaded:r,bytesTotal:n}))}),300,{leading:!0,trailing:!0});function B(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var V=0;function q(e){return"__private_"+V+++"_"+e}var H=q("emitter"),G=q("events");class W{constructor(e){Object.defineProperty(this,H,{writable:!0,value:void 0}),Object.defineProperty(this,G,{writable:!0,value:[]}),B(this,H)[H]=e}on(e,t){return B(this,G)[G].push([e,t]),B(this,H)[H].on(e,t)}remove(){for(const[e,t]of B(this,G)[G].splice(0))B(this,H)[H].off(e,t)}}function X(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var K=0;function Z(e){return"__private_"+K+++"_"+e}var Y=Z("aliveTimer"),J=Z("isDone"),Q=Z("onTimedOut"),ee=Z("timeout");const te=class{constructor(e,t){Object.defineProperty(this,Y,{writable:!0,value:void 0}),Object.defineProperty(this,J,{writable:!0,value:!1}),Object.defineProperty(this,Q,{writable:!0,value:void 0}),Object.defineProperty(this,ee,{writable:!0,value:void 0}),X(this,ee)[ee]=e,X(this,Q)[Q]=t}progress(){X(this,J)[J]||X(this,ee)[ee]>0&&(clearTimeout(X(this,Y)[Y]),X(this,Y)[Y]=setTimeout(X(this,Q)[Q],X(this,ee)[ee]))}done(){X(this,J)[J]||(clearTimeout(X(this,Y)[Y]),X(this,Y)[Y]=null,X(this,J)[J]=!0)}};function ie(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var se=0;function re(e){return"__private_"+se+++"_"+e}function ne(){return new Error("Cancelled")}var oe=re("activeRequests"),ae=re("queuedHandlers"),le=re("paused"),ue=re("pauseTimer"),he=re("downLimit"),de=re("upperLimit"),ce=re("rateLimitingTimer"),pe=re("call"),fe=re("queueNext"),ge=re("next"),me=re("queue"),ye=re("dequeue"),ve=re("resume"),we=re("increaseLimit");class be{constructor(e){Object.defineProperty(this,ye,{value:Pe}),Object.defineProperty(this,me,{value:ke}),Object.defineProperty(this,ge,{value:Se}),Object.defineProperty(this,fe,{value:Oe}),Object.defineProperty(this,pe,{value:_e}),Object.defineProperty(this,oe,{writable:!0,value:0}),Object.defineProperty(this,ae,{writable:!0,value:[]}),Object.defineProperty(this,le,{writable:!0,value:!1}),Object.defineProperty(this,ue,{writable:!0,value:void 0}),Object.defineProperty(this,he,{writable:!0,value:1}),Object.defineProperty(this,de,{writable:!0,value:void 0}),Object.defineProperty(this,ce,{writable:!0,value:void 0}),Object.defineProperty(this,ve,{writable:!0,value:()=>this.resume()}),Object.defineProperty(this,we,{writable:!0,value:()=>{if(ie(this,le)[le])ie(this,ce)[ce]=setTimeout(ie(this,we)[we],0);else{ie(this,he)[he]=this.limit,this.limit=Math.ceil((ie(this,de)[de]+ie(this,he)[he])/2);for(let e=ie(this,he)[he];e<=this.limit;e++)ie(this,fe)[fe]();ie(this,de)[de]-ie(this,he)[he]>3?ie(this,ce)[ce]=setTimeout(ie(this,we)[we],2e3):ie(this,he)[he]=Math.floor(ie(this,he)[he]/2)}}}),this.limit="number"!=typeof e||0===e?1/0:e}run(e,t){return!ie(this,le)[le]&&ie(this,oe)[oe]<this.limit?ie(this,pe)[pe](e):ie(this,me)[me](e,t)}wrapPromiseFunction(e,t){var i=this;return function(){for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];let o;const a=new Promise(((s,n)=>{o=i.run((()=>{let t,i;try{i=Promise.resolve(e(...r))}catch(e){i=Promise.reject(e)}return i.then((e=>{t?n(t):(o.done(),s(e))}),(e=>{t?n(t):(o.done(),n(e))})),()=>{t=ne()}}),t)}));return a.abort=()=>{o.abort()},a}}resume(){ie(this,le)[le]=!1,clearTimeout(ie(this,ue)[ue]);for(let e=0;e<this.limit;e++)ie(this,fe)[fe]()}pause(e){void 0===e&&(e=null),ie(this,le)[le]=!0,clearTimeout(ie(this,ue)[ue]),null!=e&&(ie(this,ue)[ue]=setTimeout(ie(this,ve)[ve],e))}rateLimit(e){clearTimeout(ie(this,ce)[ce]),this.pause(e),this.limit>1&&Number.isFinite(this.limit)&&(ie(this,de)[de]=this.limit-1,this.limit=ie(this,he)[he],ie(this,ce)[ce]=setTimeout(ie(this,we)[we],e))}get isPaused(){return ie(this,le)[le]}}function _e(e){ie(this,oe)[oe]+=1;let t,i=!1;try{t=e()}catch(e){throw ie(this,oe)[oe]-=1,e}return{abort:()=>{i||(i=!0,ie(this,oe)[oe]-=1,t(),ie(this,fe)[fe]())},done:()=>{i||(i=!0,ie(this,oe)[oe]-=1,ie(this,fe)[fe]())}}}function Oe(){queueMicrotask((()=>ie(this,ge)[ge]()))}function Se(){if(ie(this,le)[le]||ie(this,oe)[oe]>=this.limit)return;if(0===ie(this,ae)[ae].length)return;const e=ie(this,ae)[ae].shift(),t=ie(this,pe)[pe](e.fn);e.abort=t.abort,e.done=t.done}function ke(e,t){void 0===t&&(t={});const i={fn:e,priority:t.priority||0,abort:()=>{ie(this,ye)[ye](i)},done:()=>{throw new Error("Cannot mark a queued request as done: this indicates a bug")}},s=ie(this,ae)[ae].findIndex((e=>i.priority>e.priority));return-1===s?ie(this,ae)[ae].push(i):ie(this,ae)[ae].splice(s,0,i),i}function Pe(e){const t=ie(this,ae)[ae].indexOf(e);-1!==t&&ie(this,ae)[ae].splice(t,1)}const xe=Symbol("__queue");class Ee extends Error{constructor(e,t){void 0===t&&(t=null),super("This looks like a network error, the endpoint might be blocked by an internet provider or a firewall."),this.cause=e,this.isNetworkError=!0,this.request=t}}const Fe=Ee;const Te=function(e){return!!e&&(0!==e.readyState&&4!==e.readyState||0===e.status)},Ue={strings:{timedOut:"Upload stalled for %{seconds} seconds, aborting."}};function Ae(e,t){let i=t;return i||(i=new Error("Upload error")),"string"==typeof i&&(i=new Error(i)),i instanceof Error||(i=Object.assign(new Error("Upload error"),{data:i})),Te(e)?(i=new Fe(i,e),i):(i.request=e,i)}function je(e){return e.data.slice(0,e.data.size,e.meta.type)}class Ce extends r.Z{constructor(e,t){super(e,t),this.type="uploader",this.id=this.opts.id||"XHRUpload",this.title="XHRUpload",this.defaultLocale=Ue;const i={formData:!0,fieldName:t.bundle?"files[]":"file",method:"post",allowedMetaFields:null,responseUrlFieldName:"url",bundle:!1,headers:{},timeout:3e4,limit:5,withCredentials:!1,responseType:"",getResponseData(t){let i={};try{i=JSON.parse(t)}catch(t){e.log(t)}return i},getResponseError(e,t){let i=new Error("Upload error");return Te(t)&&(i=new Fe(i,t)),i},validateStatus:e=>e>=200&&e<300};if(this.opts={...i,...t},this.i18nInit(),this.handleUpload=this.handleUpload.bind(this),xe in this.opts?this.requests=this.opts[xe]:this.requests=new be(this.opts.limit),this.opts.bundle&&!this.opts.formData)throw new Error("`opts.formData` must be true when `opts.bundle` is enabled.");if(void 0===(null==t?void 0:t.allowedMetaFields)&&"metaFields"in this.opts)throw new Error("The `metaFields` option has been renamed to `allowedMetaFields`.");this.uploaderEvents=Object.create(null)}getOptions(e){const t=this.uppy.getState().xhrUpload,{headers:i}=this.opts,s={...this.opts,...t||{},...e.xhrUpload||{},headers:{}};return"function"==typeof i?s.headers=i(e):Object.assign(s.headers,this.opts.headers),t&&Object.assign(s.headers,t.headers),e.xhrUpload&&Object.assign(s.headers,e.xhrUpload.headers),s}addMetadata(e,t,i){(Array.isArray(i.allowedMetaFields)?i.allowedMetaFields:Object.keys(t)).forEach((i=>{e.append(i,t[i])}))}createFormDataUpload(e,t){const i=new FormData;this.addMetadata(i,e.meta,t);const s=je(e);return e.name?i.append(t.fieldName,s,e.meta.name):i.append(t.fieldName,s),i}createBundledUpload(e,t){const i=new FormData,{meta:s}=this.uppy.getState();return this.addMetadata(i,s,t),e.forEach((e=>{const t=this.getOptions(e),s=je(e);e.name?i.append(t.fieldName,s,e.name):i.append(t.fieldName,s)})),i}upload(e,t,i){const s=this.getOptions(e);return this.uppy.log(`uploading ${t} of ${i}`),new Promise(((t,i)=>{this.uppy.emit("upload-started",e);const r=s.formData?this.createFormDataUpload(e,s):e.data,o=new XMLHttpRequest;let a;this.uploaderEvents[e.id]=new W(this.uppy);const l=new te(s.timeout,(()=>{o.abort(),a.done();const t=new Error(this.i18n("timedOut",{seconds:Math.ceil(s.timeout/1e3)}));this.uppy.emit("upload-error",e,t),i(t)})),u=(0,n.x)();o.upload.addEventListener("loadstart",(()=>{this.uppy.log(`[XHRUpload] ${u} started`)})),o.upload.addEventListener("progress",(t=>{this.uppy.log(`[XHRUpload] ${u} progress: ${t.loaded} / ${t.total}`),l.progress(),t.lengthComputable&&this.uppy.emit("upload-progress",e,{uploader:this,bytesUploaded:t.loaded,bytesTotal:t.total})})),o.addEventListener("load",(()=>{if(this.uppy.log(`[XHRUpload] ${u} finished`),l.done(),a.done(),this.uploaderEvents[e.id]&&(this.uploaderEvents[e.id].remove(),this.uploaderEvents[e.id]=null),s.validateStatus(o.status,o.responseText,o)){const i=s.getResponseData(o.responseText,o),r=i[s.responseUrlFieldName],n={status:o.status,body:i,uploadURL:r};return this.uppy.emit("upload-success",e,n),r&&this.uppy.log(`Download ${e.name} from ${r}`),t(e)}const r=s.getResponseData(o.responseText,o),n=Ae(o,s.getResponseError(o.responseText,o)),h={status:o.status,body:r};return this.uppy.emit("upload-error",e,n,h),i(n)})),o.addEventListener("error",(()=>{this.uppy.log(`[XHRUpload] ${u} errored`),l.done(),a.done(),this.uploaderEvents[e.id]&&(this.uploaderEvents[e.id].remove(),this.uploaderEvents[e.id]=null);const t=Ae(o,s.getResponseError(o.responseText,o));return this.uppy.emit("upload-error",e,t),i(t)})),o.open(s.method.toUpperCase(),s.endpoint,!0),o.withCredentials=s.withCredentials,""!==s.responseType&&(o.responseType=s.responseType),a=this.requests.run((()=>{this.uppy.emit("upload-started",e);const t=this.getOptions(e);return Object.keys(t.headers).forEach((e=>{o.setRequestHeader(e,t.headers[e])})),o.send(r),()=>{l.done(),o.abort()}})),this.onFileRemove(e.id,(()=>{a.abort(),i(new Error("File removed"))})),this.onCancelAll(e.id,(e=>{let{reason:t}=e;"user"===t&&a.abort(),i(new Error("Upload cancelled"))}))}))}uploadRemote(e){const t=this.getOptions(e);return new Promise(((i,s)=>{this.uppy.emit("upload-started",e);const r={};(Array.isArray(t.allowedMetaFields)?t.allowedMetaFields:Object.keys(e.meta)).forEach((t=>{r[t]=e.meta[t]}));new(e.remote.providerOptions.provider?F:O)(this.uppy,e.remote.providerOptions).post(e.remote.url,{...e.remote.body,protocol:"multipart",endpoint:t.endpoint,size:e.data.size,fieldname:t.fieldName,metadata:r,httpMethod:t.method,useFormData:t.formData,headers:t.headers}).then((r=>{const{token:n}=r,o=function(e){const t=/^(?:https?:\/\/|\/\/)?(?:[^@\n]+@)?(?:www\.)?([^\n]+)/i.exec(e)[1];return`${/^http:\/\//i.test(e)?"ws":"wss"}://${t}`}(e.remote.companionUrl),a=new $({target:`${o}/api/${n}`,autoOpen:!1});let l;this.uploaderEvents[e.id]=new W(this.uppy),this.onFileRemove(e.id,(()=>{a.send("cancel",{}),l.abort(),i(`upload ${e.id} was removed`)})),this.onCancelAll(e.id,(function(t){let{reason:s}=void 0===t?{}:t;"user"===s&&(a.send("cancel",{}),l.abort()),i(`upload ${e.id} was canceled`)})),this.onRetry(e.id,(()=>{a.send("pause",{}),a.send("resume",{})})),this.onRetryAll(e.id,(()=>{a.send("pause",{}),a.send("resume",{})})),a.on("progress",(t=>z(this,t,e))),a.on("success",(s=>{const r=t.getResponseData(s.response.responseText,s.response),n=r[t.responseUrlFieldName],o={status:s.response.status,body:r,uploadURL:n};return this.uppy.emit("upload-success",e,o),l.done(),this.uploaderEvents[e.id]&&(this.uploaderEvents[e.id].remove(),this.uploaderEvents[e.id]=null),i()})),a.on("error",(i=>{const r=i.response,n=r?t.getResponseError(r.responseText,r):Object.assign(new Error(i.error.message),{cause:i.error});this.uppy.emit("upload-error",e,n),l.done(),this.uploaderEvents[e.id]&&(this.uploaderEvents[e.id].remove(),this.uploaderEvents[e.id]=null),s(n)})),l=this.requests.run((()=>(a.open(),e.isPaused&&a.send("pause",{}),()=>a.close())))})).catch((t=>{this.uppy.emit("upload-error",e,t),s(t)}))}))}uploadBundle(e){return new Promise(((t,i)=>{const{endpoint:s}=this.opts,{method:r}=this.opts,n=this.uppy.getState().xhrUpload,o=this.createBundledUpload(e,{...this.opts,...n||{}}),a=new XMLHttpRequest,l=t=>{e.forEach((e=>{this.uppy.emit("upload-error",e,t)}))},u=new te(this.opts.timeout,(()=>{a.abort();const e=new Error(this.i18n("timedOut",{seconds:Math.ceil(this.opts.timeout/1e3)}));l(e),i(e)}));a.upload.addEventListener("loadstart",(()=>{this.uppy.log("[XHRUpload] started uploading bundle"),u.progress()})),a.upload.addEventListener("progress",(t=>{u.progress(),t.lengthComputable&&e.forEach((e=>{this.uppy.emit("upload-progress",e,{uploader:this,bytesUploaded:t.loaded/t.total*e.size,bytesTotal:e.size})}))})),a.addEventListener("load",(s=>{if(u.done(),this.opts.validateStatus(s.target.status,a.responseText,a)){const i=this.opts.getResponseData(a.responseText,a),r={status:s.target.status,body:i};return e.forEach((e=>{this.uppy.emit("upload-success",e,r)})),t()}const r=this.opts.getResponseError(a.responseText,a)||new Error("Upload error");return r.request=a,l(r),i(r)})),a.addEventListener("error",(()=>{u.done();const e=this.opts.getResponseError(a.responseText,a)||new Error("Upload error");return l(e),i(e)})),this.uppy.on("cancel-all",(function(e){let{reason:t}=void 0===e?{}:e;"user"===t&&(u.done(),a.abort())})),a.open(r.toUpperCase(),s,!0),a.withCredentials=this.opts.withCredentials,""!==this.opts.responseType&&(a.responseType=this.opts.responseType),Object.keys(this.opts.headers).forEach((e=>{a.setRequestHeader(e,this.opts.headers[e])})),a.send(o),e.forEach((e=>{this.uppy.emit("upload-started",e)}))}))}uploadFiles(e){return function(e){const t=[],i=[];function s(e){t.push(e)}function r(e){i.push(e)}return Promise.all(e.map((e=>e.then(s,r)))).then((()=>({successful:t,failed:i})))}(e.map(((t,i)=>{const s=parseInt(i,10)+1,r=e.length;return t.error?Promise.reject(new Error(t.error)):t.isRemote?this.uploadRemote(t,s,r):this.upload(t,s,r)})))}onFileRemove(e,t){this.uploaderEvents[e].on("file-removed",(i=>{e===i.id&&t(i.id)}))}onRetry(e,t){this.uploaderEvents[e].on("upload-retry",(i=>{e===i&&t()}))}onRetryAll(e,t){this.uploaderEvents[e].on("retry-all",(()=>{this.uppy.getFile(e)&&t()}))}onCancelAll(e,t){var i=this;this.uploaderEvents[e].on("cancel-all",(function(){i.uppy.getFile(e)&&t(...arguments)}))}handleUpload(e){if(0===e.length)return this.uppy.log("[XHRUpload] No files to upload!"),Promise.resolve();0!==this.opts.limit||this.opts[xe]||this.uppy.log("[XHRUpload] When uploading multiple files at once, consider setting the `limit` option (to `10` for example), to limit the number of concurrent uploads, which helps prevent memory and network issues: https://uppy.io/docs/xhr-upload/#limit-0","warning"),this.uppy.log("[XHRUpload] Uploading...");const t=e.map((e=>this.uppy.getFile(e)));if(this.opts.bundle){if(t.some((e=>e.isRemote)))throw new Error("Cant upload remote files when the `bundle: true` option is set");if("function"==typeof this.opts.headers)throw new TypeError("`headers` may not be a function when the `bundle: true` option is set");return this.uploadBundle(t)}return this.uploadFiles(t).then((()=>null))}install(){if(this.opts.bundle){const{capabilities:e}=this.uppy.getState();this.uppy.setState({capabilities:{...e,individualCancellation:!1}})}this.uppy.addUploader(this.handleUpload)}uninstall(){if(this.opts.bundle){const{capabilities:e}=this.uppy.getState();this.uppy.setState({capabilities:{...e,individualCancellation:!0}})}this.uppy.removeUploader(this.handleUpload)}}Ce.VERSION="3.0.0"},9022:(e,t,i)=>{"use strict";i.d(t,{x:()=>s});let s=(e=21)=>{let t="",i=e;for(;i--;)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return t}}},e=>{var t;t=7763,e(e.s=t)}]);