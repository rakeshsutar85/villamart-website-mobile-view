/*! For license information please see 8539.js.LICENSE.txt */
(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8539],{5158:e=>{e.exports=function(e){if("number"!=typeof e||isNaN(e))throw new TypeError("Expected a number, got "+typeof e);const t=e<0,s=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];if(t&&(e=-e),e<1)return(t?"-":"")+e+" B";const i=Math.min(Math.floor(Math.log(e)/Math.log(1024)),s.length-1);e=Number(e/Math.pow(1024,i));const r=s[i];return e>=10||e%1==0?`${(t?"-":"")+e.toFixed(0)} ${r}`:`${(t?"-":"")+e.toFixed(1)} ${r}`}},1443:function(e,t,s){!function(e){"use strict";function t(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var i="undefined"!=typeof self?self:s.g;const r="undefined"!=typeof navigator,n=r&&"undefined"==typeof HTMLImageElement,o=!(void 0===s.g||"undefined"==typeof process||!process.versions||!process.versions.node),a=i.Buffer,l=!!a,h=e=>void 0!==e;function u(e){return void 0===e||(e instanceof Map?0===e.size:0===Object.values(e).filter(h).length)}function d(e){let t=new Error(e);throw delete t.stack,t}function p(e){let t=function(e){let t=0;return e.ifd0.enabled&&(t+=1024),e.exif.enabled&&(t+=2048),e.makerNote&&(t+=2048),e.userComment&&(t+=1024),e.gps.enabled&&(t+=512),e.interop.enabled&&(t+=100),e.ifd1.enabled&&(t+=1024),t+2048}(e);return e.jfif.enabled&&(t+=50),e.xmp.enabled&&(t+=2e4),e.iptc.enabled&&(t+=14e3),e.icc.enabled&&(t+=6e3),t}const c=e=>String.fromCharCode.apply(null,e),f="undefined"!=typeof TextDecoder?new TextDecoder("utf-8"):void 0;class g{static from(e,t){return e instanceof this&&e.le===t?e:new g(e,void 0,void 0,t)}constructor(e,t=0,s,i){if("boolean"==typeof i&&(this.le=i),Array.isArray(e)&&(e=new Uint8Array(e)),0===e)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){void 0===s&&(s=e.byteLength-t);let i=new DataView(e,t,s);this._swapDataView(i)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof g){void 0===s&&(s=e.byteLength-t),(t+=e.byteOffset)+s>e.byteOffset+e.byteLength&&d("Creating view outside of available memory in ArrayBuffer");let i=new DataView(e.buffer,t,s);this._swapDataView(i)}else if("number"==typeof e){let t=new DataView(new ArrayBuffer(e));this._swapDataView(t)}else d("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,s=g){return e instanceof DataView||e instanceof g?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||d("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new s(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new g(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return s=this.getUint8Array(e,t),f?f.decode(s):l?Buffer.from(s).toString("utf8"):decodeURIComponent(escape(c(s)));var s}getLatin1String(e=0,t=this.byteLength){let s=this.getUint8Array(e,t);return c(s)}getUnicodeString(e=0,t=this.byteLength){const s=[];for(let i=0;i<t&&e+i<this.byteLength;i+=2)s.push(this.getUint16(e+i));return c(s)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,s){switch(t){case 1:return this.getUint8(e,s);case 2:return this.getUint16(e,s);case 4:return this.getUint32(e,s);case 8:return this.getUint64&&this.getUint64(e,s)}}getUint(e,t,s){switch(t){case 8:return this.getUint8(e,s);case 16:return this.getUint16(e,s);case 32:return this.getUint32(e,s);case 64:return this.getUint64&&this.getUint64(e,s)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}}function m(e,t){d(`${e} '${t}' was not loaded, try using full build of exifr.`)}class y extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||m(this.kind,e),t&&(e in t||function(e,t){d(`Unknown ${e} '${t}'.`)}(this.kind,e),t[e].enabled||m(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}}var v=new y("file parser"),b=new y("segment parser"),w=new y("file reader");let _=i.fetch;const k="Invalid input argument";function S(e,t){return(s=e).startsWith("data:")||s.length>1e4?P(e,t,"base64"):o&&e.includes("://")?O(e,t,"url",x):o?P(e,t,"fs"):r?O(e,t,"url",x):void d(k);var s}async function O(e,t,s,i){return w.has(s)?P(e,t,s):i?async function(e,t){let s=await t(e);return new g(s)}(e,i):void d(`Parser ${s} is not loaded`)}async function P(e,t,s){let i=new(w.get(s))(e,t);return await i.read(),i}const x=e=>_(e).then((e=>e.arrayBuffer())),U=e=>new Promise(((t,s)=>{let i=new FileReader;i.onloadend=()=>t(i.result||new ArrayBuffer),i.onerror=s,i.readAsArrayBuffer(e)}));class E extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}}function F(e,t,s){let i=new E;for(let[e,t]of s)i.set(e,t);if(Array.isArray(t))for(let s of t)e.set(s,i);else e.set(t,i);return i}function A(e,t,s){let i,r=e.get(t);for(i of s)r.set(i[0],i[1])}const T=new Map,C=new Map,j=new Map,R=37500,$=37510,I=33723,L=34675,M=34665,N=34853,z=40965,B=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],D=["jfif","xmp","icc","iptc","ihdr"],V=["tiff",...D],q=["ifd0","ifd1","exif","gps","interop"],H=[...V,...q],W=["makerNote","userComment"],G=["translateKeys","translateValues","reviveValues","multiSegment"],X=[...G,"sanitize","mergeOutput","silentErrors"];class K{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class Y extends K{get needed(){return this.enabled||this.deps.size>0}constructor(e,s,i,r){if(super(),t(this,"enabled",!1),t(this,"skip",new Set),t(this,"pick",new Set),t(this,"deps",new Set),t(this,"translateKeys",!1),t(this,"translateValues",!1),t(this,"reviveValues",!1),this.key=e,this.enabled=s,this.parse=this.enabled,this.applyInheritables(r),this.canBeFiltered=q.includes(e),this.canBeFiltered&&(this.dict=T.get(e)),void 0!==i)if(Array.isArray(i))this.parse=this.enabled=!0,this.canBeFiltered&&i.length>0&&this.translateTagSet(i,this.pick);else if("object"==typeof i){if(this.enabled=!0,this.parse=!1!==i.parse,this.canBeFiltered){let{pick:e,skip:t}=i;e&&e.length>0&&this.translateTagSet(e,this.pick),t&&t.length>0&&this.translateTagSet(t,this.skip)}this.applyInheritables(i)}else!0===i||!1===i?this.parse=this.enabled=i:d(`Invalid options argument: ${i}`)}applyInheritables(e){let t,s;for(t of G)s=e[t],void 0!==s&&(this[t]=s)}translateTagSet(e,t){if(this.dict){let s,i,{tagKeys:r,tagValues:n}=this.dict;for(s of e)"string"==typeof s?(i=n.indexOf(s),-1===i&&(i=r.indexOf(Number(s))),-1!==i&&t.add(Number(r[i]))):t.add(s)}else for(let s of e)t.add(s)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,se(this.pick,this.deps)):this.enabled&&this.pick.size>0&&se(this.pick,this.deps)}}var Z={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},J=new Map;class Q extends K{static useCached(e){let t=J.get(e);return void 0!==t||(t=new this(e),J.set(e,t)),t}constructor(e){super(),!0===e?this.setupFromTrue():void 0===e?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):"object"==typeof e?this.setupFromObject(e):d(`Invalid options argument ${e}`),void 0===this.firstChunkSize&&(this.firstChunkSize=r?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of B)this[e]=Z[e];for(e of X)this[e]=Z[e];for(e of W)this[e]=Z[e];for(e of H)this[e]=new Y(e,Z[e],void 0,this)}setupFromTrue(){let e;for(e of B)this[e]=Z[e];for(e of X)this[e]=Z[e];for(e of W)this[e]=!0;for(e of H)this[e]=new Y(e,!0,void 0,this)}setupFromArray(e){let t;for(t of B)this[t]=Z[t];for(t of X)this[t]=Z[t];for(t of W)this[t]=Z[t];for(t of H)this[t]=new Y(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,q)}setupFromObject(e){let t;for(t of(q.ifd0=q.ifd0||q.image,q.ifd1=q.ifd1||q.thumbnail,Object.assign(this,e),B))this[t]=te(e[t],Z[t]);for(t of X)this[t]=te(e[t],Z[t]);for(t of W)this[t]=te(e[t],Z[t]);for(t of V)this[t]=new Y(t,Z[t],e[t],this);for(t of q)this[t]=new Y(t,Z[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,q,H),!0===e.tiff?this.batchEnableWithBool(q,!0):!1===e.tiff?this.batchEnableWithUserValue(q,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,q):"object"==typeof e.tiff&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,q)}batchEnableWithBool(e,t){for(let s of e)this[s].enabled=t}batchEnableWithUserValue(e,t){for(let s of e){let e=t[s];this[s].enabled=!1!==e&&void 0!==e}}setupGlobalFilters(e,t,s,i=s){if(e&&e.length){for(let e of i)this[e].enabled=!1;let t=ee(e,s);for(let[e,s]of t)se(this[e].pick,s),this[e].enabled=!0}else if(t&&t.length){let e=ee(t,s);for(let[t,s]of e)se(this[t].skip,s)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:s,iptc:i,icc:r}=this;this.makerNote?t.deps.add(R):t.skip.add(R),this.userComment?t.deps.add($):t.skip.add($),s.enabled||e.skip.add(700),i.enabled||e.skip.add(I),r.enabled||e.skip.add(L)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:s,interop:i}=this;i.needed&&(t.deps.add(z),e.deps.add(z)),t.needed&&e.deps.add(M),s.needed&&e.deps.add(N),this.tiff.enabled=q.some((e=>!0===this[e].enabled))||this.makerNote||this.userComment;for(let e of q)this[e].finalizeFilters()}get onlyTiff(){return!D.map((e=>this[e].enabled)).some((e=>!0===e))&&this.tiff.enabled}checkLoadedPlugins(){for(let e of V)this[e].enabled&&!b.has(e)&&m("segment parser",e)}}function ee(e,t){let s,i,r,n,o=[];for(r of t){for(n of(s=T.get(r),i=[],s))(e.includes(n[0])||e.includes(n[1]))&&i.push(n[0]);i.length&&o.push([r,i])}return o}function te(e,t){return void 0!==e?e:void 0!==t?t:void 0}function se(e,t){for(let s of t)e.add(s)}t(Q,"default",Z);class ie{constructor(e){t(this,"parsers",{}),t(this,"output",{}),t(this,"errors",[]),t(this,"pushToErrors",(e=>this.errors.push(e))),this.options=Q.useCached(e)}async read(e){this.file=await function(e,t){return"string"==typeof e?S(e,t):r&&!n&&e instanceof HTMLImageElement?S(e.src,t):e instanceof Uint8Array||e instanceof ArrayBuffer||e instanceof DataView?new g(e):r&&e instanceof Blob?O(e,t,"blob",U):void d(k)}(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[s,i]of v)if(i.canHandle(e,t))return this.fileParser=new i(this.options,this.file,this.parsers),e[s]=!0;this.file.close&&this.file.close(),d("Unknown file format")}async parse(){let{output:e,errors:t}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),t.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&t.length>0&&(e.errors=t),u(s=e)?void 0:s;var s}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let t=Object.values(this.parsers).map((async t=>{let s=await t.parse();t.assignToOutput(e,s)}));this.options.silentErrors&&(t=t.map((e=>e.catch(this.pushToErrors)))),await Promise.all(t)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,s=b.get("tiff",e);var i;if(t.tiff?i={start:0,type:"tiff"}:t.jpeg&&(i=await this.fileParser.getOrFindSegment("tiff")),void 0===i)return;let r=await this.fileParser.ensureSegmentChunk(i),n=this.parsers.tiff=new s(r,e,t),o=await n.extractThumbnail();return t.close&&t.close(),o}}async function re(e,t){let s=new ie(t);return await s.read(e),s.parse()}var ne=Object.freeze({__proto__:null,parse:re,Exifr:ie,fileParsers:v,segmentParsers:b,fileReaders:w,tagKeys:T,tagValues:C,tagRevivers:j,createDictionary:F,extendDictionary:A,fetchUrlAsArrayBuffer:x,readBlobAsArrayBuffer:U,chunkedProps:B,otherSegments:D,segments:V,tiffBlocks:q,segmentsAndBlocks:H,tiffExtractables:W,inheritables:G,allFormatters:X,Options:Q});class oe{static findPosition(e,t){let s=e.getUint16(t+2)+2,i="function"==typeof this.headerLength?this.headerLength(e,t,s):this.headerLength,r=t+i,n=s-i;return{offset:t,length:s,headerLength:i,start:r,size:n,end:r+n}}static parse(e,t={}){return new this(e,new Q({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof g?e:new g(e)}constructor(e,s={},i){t(this,"errors",[]),t(this,"raw",new Map),t(this,"handleError",(e=>{if(!this.options.silentErrors)throw e;this.errors.push(e.message)})),this.chunk=this.normalizeInput(e),this.file=i,this.type=this.constructor.type,this.globalOptions=this.options=s,this.localOptions=s[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let s=j.get(t),i=C.get(t),r=T.get(t),n=this.options[t],o=n.reviveValues&&!!s,a=n.translateValues&&!!i,l=n.translateKeys&&!!r,h={};for(let[t,n]of e)o&&s.has(t)?n=s.get(t)(n):a&&i.has(t)&&(n=this.translateValue(n,i.get(t))),l&&r.has(t)&&(t=r.get(t)||t),h[t]=n;return h}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,s){if(this.globalOptions.mergeOutput)return Object.assign(e,s);e[t]?Object.assign(e[t],s):e[t]=s}}function ae(e){return 192===e||194===e||196===e||219===e||221===e||218===e||254===e}function le(e){return e>=224&&e<=239}function he(e,t,s){for(let[i,r]of b)if(r.canHandle(e,t,s))return i}t(oe,"headerLength",4),t(oe,"type",void 0),t(oe,"multiSegment",!1),t(oe,"canHandle",(()=>!1));class ue extends class{constructor(e,s,i){t(this,"errors",[]),t(this,"ensureSegmentChunk",(async e=>{let t=e.start,s=e.size||65536;if(this.file.chunked)if(this.file.available(t,s))e.chunk=this.file.subarray(t,s);else try{e.chunk=await this.file.readChunk(t,s)}catch(t){d(`Couldn't read segment: ${JSON.stringify(e)}. ${t.message}`)}else this.file.byteLength>t+s?e.chunk=this.file.subarray(t,s):void 0===e.size?e.chunk=this.file.subarray(t):d("Segment unreachable: "+JSON.stringify(e));return e.chunk})),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=s,this.parsers=i}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let s=new(b.get(e))(t,this.options,this.file);return this.parsers[e]=s}createParsers(e){for(let t of e){let{type:e,chunk:s}=t,i=this.options[e];if(i&&i.enabled){let t=this.parsers[e];t&&t.append||t||this.createParser(e,s)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}}{constructor(...e){super(...e),t(this,"appSegments",[]),t(this,"jpegSegments",[]),t(this,"unknownSegments",[])}static canHandle(e,t){return 65496===t}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){!0===e?(this.findAll=!0,this.wanted=new Set(b.keyList())):(e=void 0===e?b.keyList().filter((e=>this.options[e].enabled)):e.filter((e=>this.options[e].enabled&&b.has(e))),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:s,findAll:i,wanted:r,remaining:n}=this;if(!i&&this.file.chunked&&(i=Array.from(r).some((e=>{let t=b.get(e),s=this.options[e];return t.multiSegment&&s.multiSegment})),i&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,s.byteLength),!this.options.onlyTiff&&s.chunked){let t=!1;for(;n.size>0&&!t&&(s.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:i}=s,r=this.appSegments.some((e=>!this.file.available(e.offset||e.start,e.length||e.size)));if(t=e>i&&!r?!await s.readNextChunk(e):!await s.readNextChunk(i),void 0===(e=this.findAppSegmentsInRange(e,s.byteLength)))return}}}findAppSegmentsInRange(e,t){t-=2;let s,i,r,n,o,a,{file:l,findAll:h,wanted:u,remaining:d,options:p}=this;for(;e<t;e++)if(255===l.getUint8(e))if(s=l.getUint8(e+1),le(s)){if(i=l.getUint16(e+2),r=he(l,e,i),r&&u.has(r)&&(n=b.get(r),o=n.findPosition(l,e),a=p[r],o.type=r,this.appSegments.push(o),!h&&(n.multiSegment&&a.multiSegment?(this.unfinishedMultiSegment=o.chunkNumber<o.chunkCount,this.unfinishedMultiSegment||d.delete(r)):d.delete(r),0===d.size)))break;p.recordUnknownSegments&&(o=oe.findPosition(l,e),o.marker=s,this.unknownSegments.push(o)),e+=i+1}else if(ae(s)){if(i=l.getUint16(e+2),218===s&&!1!==p.stopAfterSos)return;p.recordJpegSegments&&this.jpegSegments.push({offset:e,length:i,marker:s}),e+=i+1}return e}mergeMultiSegments(){if(!this.appSegments.some((e=>e.multiSegment)))return;let e=function(e,t){let s,i,r,n=new Map;for(let o=0;o<e.length;o++)s=e[o],i=s[t],n.has(i)?r=n.get(i):n.set(i,r=[]),r.push(s);return Array.from(n)}(this.appSegments,"type");this.mergedAppSegments=e.map((([e,t])=>{let s=b.get(e,this.options);return s.handleMultiSegments?{type:e,chunk:s.handleMultiSegments(t)}:t[0]}))}getSegment(e){return this.appSegments.find((t=>t.type===e))}async getOrFindSegment(e){let t=this.getSegment(e);return void 0===t&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}}t(ue,"type","jpeg"),v.set("jpeg",ue);const de=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class pe extends oe{parseHeader(){var e=this.chunk.getUint16();18761===e?this.le=!0:19789===e&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,s=new Map){let{pick:i,skip:r}=this.options[t];i=new Set(i);let n=i.size>0,o=0===r.size,a=this.chunk.getUint16(e);e+=2;for(let l=0;l<a;l++){let a=this.chunk.getUint16(e);if(n){if(i.has(a)&&(s.set(a,this.parseTag(e,a,t)),i.delete(a),0===i.size))break}else!o&&r.has(a)||s.set(a,this.parseTag(e,a,t));e+=12}return s}parseTag(e,t,s){let{chunk:i}=this,r=i.getUint16(e+2),n=i.getUint32(e+4),o=de[r];if(o*n<=4?e+=8:e=i.getUint32(e+8),(r<1||r>13)&&d(`Invalid TIFF value type. block: ${s.toUpperCase()}, tag: ${t.toString(16)}, type: ${r}, offset ${e}`),e>i.byteLength&&d(`Invalid TIFF value offset. block: ${s.toUpperCase()}, tag: ${t.toString(16)}, type: ${r}, offset ${e} is outside of chunk size ${i.byteLength}`),1===r)return i.getUint8Array(e,n);if(2===r)return""===(a=function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e}(a=i.getString(e,n)).trim())?void 0:a;var a;if(7===r)return i.getUint8Array(e,n);if(1===n)return this.parseTagValue(r,e);{let t=new(function(e){switch(e){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:case 10:default:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 11:return Float32Array;case 12:return Float64Array}}(r))(n),s=o;for(let i=0;i<n;i++)t[i]=this.parseTagValue(r,e),e+=s;return t}}parseTagValue(e,t){let{chunk:s}=this;switch(e){case 1:return s.getUint8(t);case 3:return s.getUint16(t);case 4:case 13:return s.getUint32(t);case 5:return s.getUint32(t)/s.getUint32(t+4);case 6:return s.getInt8(t);case 8:return s.getInt16(t);case 9:return s.getInt32(t);case 10:return s.getInt32(t)/s.getInt32(t+4);case 11:return s.getFloat(t);case 12:return s.getDouble(t);default:d(`Invalid tiff type ${e}`)}}}class ce extends pe{static canHandle(e,t){return 225===e.getUint8(t+1)&&1165519206===e.getUint32(t+4)&&0===e.getUint16(t+8)}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let t=this[e]();return void 0!==t.catch&&(t=t.catch(this.handleError)),t}findIfd0Offset(){void 0===this.ifd0Offset&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(void 0===this.ifd1Offset){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let s=new Map;return this[t]=s,this.parseTags(e,t,s),s}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&d("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&d(`IFD0 offset points to outside of file.\nthis.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,p(this.options));let t=this.parseBlock(this.ifd0Offset,"ifd0");return 0!==t.size?(this.exifOffset=t.get(M),this.interopOffset=t.get(z),this.gpsOffset=t.get(N),this.xmp=t.get(700),this.iptc=t.get(I),this.icc=t.get(L),this.options.sanitize&&(t.delete(M),t.delete(z),t.delete(N),t.delete(700),t.delete(I),t.delete(L)),t):void 0}async parseExifBlock(){if(this.exif)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.exifOffset)return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,p(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(z)),this.makerNote=e.get(R),this.userComment=e.get($),this.options.sanitize&&(e.delete(z),e.delete(R),e.delete($)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let s=e.get(t);s&&1===s.length&&e.set(t,s[0])}async parseGpsBlock(){if(this.gps)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.gpsOffset)return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",fe(...e.get(2),e.get(1))),e.set("longitude",fe(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),void 0!==this.interopOffset||this.exif||await this.parseExifBlock(),void 0!==this.interopOffset))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),void 0===this.ifd1)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,s,i={};for(t of q)if(e=this[t],!u(e))if(s=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if("ifd1"===t)continue;Object.assign(i,s)}else i[t]=s;return this.makerNote&&(i.makerNote=this.makerNote),this.userComment&&(i.userComment=this.userComment),i}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[s,i]of Object.entries(t))this.assignObjectToOutput(e,s,i)}}function fe(e,t,s,i){var r=e+t/60+s/3600;return"S"!==i&&"W"!==i||(r*=-1),r}t(ce,"type","tiff"),t(ce,"headerLength",10),b.set("tiff",ce);var ge=Object.freeze({__proto__:null,default:ne,Exifr:ie,fileParsers:v,segmentParsers:b,fileReaders:w,tagKeys:T,tagValues:C,tagRevivers:j,createDictionary:F,extendDictionary:A,fetchUrlAsArrayBuffer:x,readBlobAsArrayBuffer:U,chunkedProps:B,otherSegments:D,segments:V,tiffBlocks:q,segmentsAndBlocks:H,tiffExtractables:W,inheritables:G,allFormatters:X,Options:Q,parse:re});const me={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},ye=Object.assign({},me,{firstChunkSize:4e4,gps:[1,2,3,4]}),ve=Object.assign({},me,{tiff:!1,ifd1:!0,mergeOutput:!1}),be=Object.assign({},me,{firstChunkSize:4e4,ifd0:[274]});async function we(e){let t=new ie(be);await t.read(e);let s=await t.parse();if(s&&s.ifd0)return s.ifd0[274]}const _e=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});if(e.rotateCanvas=!0,e.rotateCss=!0,"object"==typeof navigator){let t=navigator.userAgent;if(t.includes("iPad")||t.includes("iPhone")){let s=t.match(/OS (\d+)_(\d+)/);if(s){let[,t,i]=s,r=Number(t)+.1*Number(i);e.rotateCanvas=r<13.4,e.rotateCss=!1}}else if(t.includes("OS X 10")){let[,s]=t.match(/OS X 10[_.](\d+)/);e.rotateCanvas=e.rotateCss=Number(s)<15}if(t.includes("Chrome/")){let[,s]=t.match(/Chrome\/(\d+)/);e.rotateCanvas=e.rotateCss=Number(s)<81}else if(t.includes("Firefox/")){let[,s]=t.match(/Firefox\/(\d+)/);e.rotateCanvas=e.rotateCss=Number(s)<77}}class ke extends g{constructor(...e){super(...e),t(this,"ranges",new Se),0!==this.byteLength&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,s){if(0===e&&0===this.byteLength&&s){let e=new DataView(s.buffer||s,s.byteOffset,s.byteLength);this._swapDataView(e)}else{let s=e+t;if(s>this.byteLength){let{dataView:e}=this._extend(s);this._swapDataView(e)}}}_extend(e){let t;t=l?a.allocUnsafe(e):new Uint8Array(e);let s=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:s}}subarray(e,t,s=!1){return t=t||this._lengthToEnd(e),s&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,s=!1){s&&this._tryExtend(t,e.byteLength,e);let i=super.set(e,t);return this.ranges.add(t,i.byteLength),i}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}}class Se{constructor(){t(this,"list",[])}get length(){return this.list.length}add(e,t,s=0){let i=e+t,r=this.list.filter((t=>Oe(e,t.offset,i)||Oe(e,t.end,i)));if(r.length>0){e=Math.min(e,...r.map((e=>e.offset))),i=Math.max(i,...r.map((e=>e.end))),t=i-e;let s=r.shift();s.offset=e,s.length=t,s.end=i,this.list=this.list.filter((e=>!r.includes(e)))}else this.list.push({offset:e,length:t,end:i})}available(e,t){let s=e+t;return this.list.some((t=>t.offset<=e&&s<=t.end))}}function Oe(e,t,s){return e<=t&&t<=s}class Pe extends ke{constructor(e,s){super(0),t(this,"chunksRead",0),this.input=e,this.options=s}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,s=await this.readChunk(e,t);return!!s&&s.byteLength===t}async readChunk(e,t){if(this.chunksRead++,0!==(t=this.safeWrapAddress(e,t)))return this._readChunk(e,t)}safeWrapAddress(e,t){return void 0!==this.size&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(0!==this.ranges.list.length)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return void 0!==this.size&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}w.set("blob",class extends Pe{async readWhole(){this.chunked=!1;let e=await U(this.input);this._swapArrayBuffer(e)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(e,t){let s=t?e+t:void 0,i=this.input.slice(e,s),r=await U(i);return this.set(r,e,!0)}}),e.Exifr=ie,e.Options=Q,e.allFormatters=X,e.chunkedProps=B,e.createDictionary=F,e.default=ge,e.extendDictionary=A,e.fetchUrlAsArrayBuffer=x,e.fileParsers=v,e.fileReaders=w,e.gps=async function(e){let t=new ie(ye);await t.read(e);let s=await t.parse();if(s&&s.gps){let{latitude:e,longitude:t}=s.gps;return{latitude:e,longitude:t}}},e.gpsOnlyOptions=ye,e.inheritables=G,e.orientation=we,e.orientationOnlyOptions=be,e.otherSegments=D,e.parse=re,e.readBlobAsArrayBuffer=U,e.rotation=async function(t){let s=await we(t);return Object.assign({canvas:e.rotateCanvas,css:e.rotateCss},_e[s])},e.rotations=_e,e.segmentParsers=b,e.segments=V,e.segmentsAndBlocks=H,e.tagKeys=T,e.tagRevivers=j,e.tagValues=C,e.thumbnail=async function(e){let t=new ie(ve);await t.read(e);let s=await t.extractThumbnail();return s&&l?a.from(s):s},e.thumbnailOnlyOptions=ve,e.thumbnailUrl=async function(e){let t=await this.thumbnail(e);if(void 0!==t){let e=new Blob([t]);return URL.createObjectURL(e)}},e.tiffBlocks=q,e.tiffExtractables=W,Object.defineProperty(e,"__esModule",{value:!0})}(t)},3096:(e,t,s)=>{var i="Expected a function",r=/^\s+|\s+$/g,n=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,a=/^0o[0-7]+$/i,l=parseInt,h="object"==typeof s.g&&s.g&&s.g.Object===Object&&s.g,u="object"==typeof self&&self&&self.Object===Object&&self,d=h||u||Function("return this")(),p=Object.prototype.toString,c=Math.max,f=Math.min,g=function(){return d.Date.now()};function m(e,t,s){var r,n,o,a,l,h,u=0,d=!1,p=!1,m=!0;if("function"!=typeof e)throw new TypeError(i);function b(t){var s=r,i=n;return r=n=void 0,u=t,a=e.apply(i,s)}function w(e){return u=e,l=setTimeout(k,t),d?b(e):a}function _(e){var s=e-h;return void 0===h||s>=t||s<0||p&&e-u>=o}function k(){var e=g();if(_(e))return S(e);l=setTimeout(k,function(e){var s=t-(e-h);return p?f(s,o-(e-u)):s}(e))}function S(e){return l=void 0,m&&r?b(e):(r=n=void 0,a)}function O(){var e=g(),s=_(e);if(r=arguments,n=this,h=e,s){if(void 0===l)return w(h);if(p)return l=setTimeout(k,t),b(h)}return void 0===l&&(l=setTimeout(k,t)),a}return t=v(t)||0,y(s)&&(d=!!s.leading,o=(p="maxWait"in s)?c(v(s.maxWait)||0,t):o,m="trailing"in s?!!s.trailing:m),O.cancel=function(){void 0!==l&&clearTimeout(l),u=0,r=h=n=l=void 0},O.flush=function(){return void 0===l?a:S(g())},O}function y(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function v(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==p.call(e)}(e))return NaN;if(y(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=y(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(r,"");var s=o.test(e);return s||a.test(e)?l(e.slice(2),s?2:8):n.test(e)?NaN:+e}e.exports=function(e,t,s){var r=!0,n=!0;if("function"!=typeof e)throw new TypeError(i);return y(s)&&(r="leading"in s?!!s.leading:r,n="trailing"in s?!!s.trailing:n),m(e,t,{leading:r,maxWait:t,trailing:n})}},4193:(e,t,s)=>{var i=s(1196),r=/[\/\+\.]/;e.exports=function(e,t){function s(t){var s=i(t,e,r);return s&&s.length>=2}return t?s(t.split(";")[0]):s}},4800:e=>{e.exports=function(){var e={},t=e._fns={};return e.emit=function(e,s,i,r,n,o,a){var l=function(e){var s=t[e]?t[e]:[],i=e.indexOf(":"),r=-1===i?[e]:[e.substring(0,i),e.substring(i+1)],n=Object.keys(t),o=0,a=n.length;for(;o<a;o++){var l=n[o];if("*"===l&&(s=s.concat(t[l])),2===r.length&&r[0]===l){s=s.concat(t[l]);break}}return s}(e);l.length&&function(e,t,s){var i=0,r=t.length;for(;i<r&&t[i];i++)t[i].event=e,t[i].apply(t[i],s)}(e,l,[s,i,r,n,o,a])},e.on=function(e,s){t[e]||(t[e]=[]),t[e].push(s)},e.once=function(t,s){this.on(t,(function i(){s.apply(this,arguments),e.off(t,i)}))},e.off=function(e,t){var s=[];if(e&&t)for(var i=this._fns[e],r=0,n=i?i.length:0;r<n;r++)i[r]!==t&&s.push(i[r]);s.length?this._fns[e]=s:delete this._fns[e]},e}},1196:e=>{"use strict";function t(e,t){this.text=e=e||"",this.hasWild=~e.indexOf("*"),this.separator=t,this.parts=e.split(t)}t.prototype.match=function(e){var t,s,i=!0,r=this.parts,n=r.length;if("string"==typeof e||e instanceof String)if(this.hasWild||this.text==e){for(s=(e||"").split(this.separator),t=0;i&&t<n;t++)"*"!==r[t]&&(i=t<s.length&&r[t]===s[t]);i=i&&s}else i=!1;else if("function"==typeof e.splice)for(i=[],t=e.length;t--;)this.match(e[t])&&(i[i.length]=e[t]);else if("object"==typeof e)for(var o in i={},e)this.match(o)&&(i[o]=e[o]);return i},e.exports=function(e,s,i){var r=new t(e,i||/[\/\.]/);return void 0!==s?r.match(s):r}},8596:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});var i=s(4136);class r{constructor(e,t){void 0===t&&(t={}),this.uppy=e,this.opts=t}getPluginState(){const{plugins:e}=this.uppy.getState();return e[this.id]||{}}setPluginState(e){const{plugins:t}=this.uppy.getState();this.uppy.setState({plugins:{...t,[this.id]:{...t[this.id],...e}}})}setOptions(e){this.opts={...this.opts,...e},this.setPluginState(),this.i18nInit()}i18nInit(){const e=new i.Z([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.setPluginState()}addTarget(){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")}install(){}uninstall(){}render(){throw new Error("Extend the render method to add your plugin to a DOM element")}update(){}afterUpdate(){}}},9063:(e,t,s)=>{"use strict";s.d(t,{di:()=>Ke,ZP:()=>he});var i=s(4136),r=s(4800),n=s(9022),o=s(3096);function a(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var l=0;function h(e){return"__private_"+l+++"_"+e}var u=h("callbacks"),d=h("publish");class p{constructor(){Object.defineProperty(this,d,{value:c}),Object.defineProperty(this,u,{writable:!0,value:new Set}),this.state={}}getState(){return this.state}setState(e){const t={...this.state},s={...this.state,...e};this.state=s,a(this,d)[d](t,s,e)}subscribe(e){return a(this,u)[u].add(e),()=>{a(this,u)[u].delete(e)}}}function c(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];a(this,u)[u].forEach((e=>{e(...t)}))}p.VERSION="3.0.0";const f=p;function g(e){const t=e.lastIndexOf(".");return-1===t||t===e.length-1?{name:e,extension:void 0}:{name:e.slice(0,t),extension:e.slice(t+1)}}const m={md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",webp:"image/webp",gif:"image/gif",heic:"image/heic",heif:"image/heif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",dicom:"application/dicom",doc:"application/msword",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel",txt:"text/plain",text:"text/plain",conf:"text/plain",log:"text/plain",pdf:"application/pdf",zip:"application/zip","7z":"application/x-7z-compressed",rar:"application/x-rar-compressed",tar:"application/x-tar",gz:"application/gzip",dmg:"application/x-apple-diskimage"};function y(e){let t="";return e.replace(/[^A-Z0-9]/gi,(e=>(t+=`-${function(e){return e.charCodeAt(0).toString(32)}(e)}`,"/")))+t}function v(e){if(null==e&&"undefined"!=typeof navigator&&(e=navigator.userAgent),!e)return!0;const t=/Edge\/(\d+\.\d+)/.exec(e);if(!t)return!0;const s=t[1];let[i,r]=s.split(".");return i=parseInt(i,10),r=parseInt(r,10),i<15||15===i&&r<15063||(i>18||18===i&&r>=18218)}const b={debug:()=>{},warn:()=>{},error:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s]}},w={debug:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s]},warn:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s]},error:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s]}};var _=s(5158),k=s(4193);const S={maxFileSize:null,minFileSize:null,maxTotalFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null,requiredMetaFields:[]};class O extends Error{constructor(){super(...arguments),this.isRestriction=!0}}class P{constructor(e,t){this.i18n=t,this.getOpts=()=>{const t=e();if(null!=t.restrictions.allowedFileTypes&&!Array.isArray(t.restrictions.allowedFileTypes))throw new TypeError("`restrictions.allowedFileTypes` must be an array");return t}}validate(e,t){const{maxFileSize:s,minFileSize:i,maxTotalFileSize:r,maxNumberOfFiles:n,allowedFileTypes:o}=this.getOpts().restrictions;if(n&&t.length+1>n)throw new O(`${this.i18n("youCanOnlyUploadX",{smart_count:n})}`);if(o){if(!o.some((t=>t.includes("/")?!!e.type&&k(e.type.replace(/;.*?$/,""),t):!("."!==t[0]||!e.extension)&&e.extension.toLowerCase()===t.slice(1).toLowerCase()))){const e=o.join(", ");throw new O(this.i18n("youCanOnlyUploadFileTypes",{types:e}))}}if(r&&null!=e.size){const s=t.reduce(((e,t)=>e+t.size),e.size);if(s>r)throw new O(this.i18n("exceedsSize",{size:_(r),file:e.name}))}if(s&&null!=e.size&&e.size>s)throw new O(this.i18n("exceedsSize",{size:_(s),file:e.name}));if(i&&null!=e.size&&e.size<i)throw new O(this.i18n("inferiorSize",{size:_(i)}))}validateMinNumberOfFiles(e){const{minNumberOfFiles:t}=this.getOpts().restrictions;if(Object.keys(e).length<t)throw new O(this.i18n("youHaveToAtLeastSelectX",{smart_count:t}))}getMissingRequiredMetaFields(e){const t=new O(this.i18n("missingRequiredMetaFieldOnFile",{fileName:e.name})),{requiredMetaFields:s}=this.getOpts().restrictions,i=[];for(const t of s)Object.hasOwn(e.meta,t)&&""!==e.meta[t]||i.push(t);return{missingFields:i,error:t}}}const x={strings:{addBulkFilesFailed:{0:"Failed to add %{smart_count} file due to an internal error",1:"Failed to add %{smart_count} files due to internal errors"},youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},exceedsSize:"%{file} exceeds maximum allowed size of %{size}",missingRequiredMetaField:"Missing required meta fields",missingRequiredMetaFieldOnFile:"Missing required meta fields in %{fileName}",inferiorSize:"This file is smaller than the allowed size of %{size}",youCanOnlyUploadFileTypes:"You can only upload: %{types}",noMoreFilesAllowed:"Cannot add more files",noDuplicates:"Cannot add the duplicate file '%{fileName}', it already exists",companionError:"Connection with Companion failed",authAborted:"Authentication aborted",companionUnauthorizeHint:"To unauthorize to your %{provider} account, please go to %{url}",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",selectX:{0:"Select %{smart_count}",1:"Select %{smart_count}"},allFilesFromFolderNamed:"All files from folder %{name}",openFolderNamed:"Open folder %{name}",cancel:"Cancel",logOut:"Log out",filter:"Filter",resetFilter:"Reset filter",loading:"Loading...",authenticateWithTitle:"Please authenticate with %{pluginName} to select files",authenticateWith:"Connect to %{pluginName}",signInWithGoogle:"Sign in with Google",searchImages:"Search for images",enterTextToSearch:"Enter text to search for images",search:"Search",emptyFolderAdded:"No files were added from empty folder",folderAlreadyAdded:'The folder "%{folder}" was already added',folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"}}};let U,E;function F(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var A=0;function T(e){return"__private_"+A+++"_"+e}var C=T("plugins"),j=T("restricter"),R=T("storeUnsubscribe"),$=T("emitter"),I=T("preProcessors"),L=T("uploaders"),M=T("postProcessors"),N=T("informAndEmit"),z=T("checkRequiredMetaFieldsOnFile"),B=T("checkRequiredMetaFields"),D=T("assertNewUploadAllowed"),V=T("checkAndCreateFileStateObject"),q=T("startIfAutoProceed"),H=T("addListeners"),W=T("updateOnlineStatus"),G=T("createUpload"),X=T("getUpload"),K=T("removeUpload"),Y=T("runUpload");U=Symbol.for("uppy test: getPlugins"),E=Symbol.for("uppy test: createUpload");class Z{constructor(e){Object.defineProperty(this,Y,{value:le}),Object.defineProperty(this,K,{value:ae}),Object.defineProperty(this,X,{value:oe}),Object.defineProperty(this,G,{value:ne}),Object.defineProperty(this,H,{value:re}),Object.defineProperty(this,q,{value:ie}),Object.defineProperty(this,V,{value:se}),Object.defineProperty(this,D,{value:te}),Object.defineProperty(this,B,{value:ee}),Object.defineProperty(this,z,{value:Q}),Object.defineProperty(this,N,{value:J}),Object.defineProperty(this,C,{writable:!0,value:Object.create(null)}),Object.defineProperty(this,j,{writable:!0,value:void 0}),Object.defineProperty(this,R,{writable:!0,value:void 0}),Object.defineProperty(this,$,{writable:!0,value:r()}),Object.defineProperty(this,I,{writable:!0,value:new Set}),Object.defineProperty(this,L,{writable:!0,value:new Set}),Object.defineProperty(this,M,{writable:!0,value:new Set}),Object.defineProperty(this,W,{writable:!0,value:this.updateOnlineStatus.bind(this)}),this.defaultLocale=x;const t={id:"uppy",autoProceed:!1,allowMultipleUploadBatches:!0,debug:!1,restrictions:S,meta:{},onBeforeFileAdded:e=>e,onBeforeUpload:e=>e,store:new f,logger:b,infoTimeout:5e3};this.opts={...t,...e,restrictions:{...t.restrictions,...e&&e.restrictions}},e&&e.logger&&e.debug?this.log("You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.","warning"):e&&e.debug&&(this.opts.logger=w),this.log(`Using Core v${this.constructor.VERSION}`),this.i18nInit(),this.calculateProgress=o(this.calculateProgress.bind(this),500,{leading:!0,trailing:!0}),this.store=this.opts.store,this.setState({plugins:{},files:{},currentUploads:{},allowNewUpload:!0,capabilities:{uploadProgress:v(),individualCancellation:!0,resumableUploads:!1},totalProgress:0,meta:{...this.opts.meta},info:[],recoveredState:null}),F(this,j)[j]=new P((()=>this.opts),this.i18n),F(this,R)[R]=this.store.subscribe(((e,t,s)=>{this.emit("state-update",e,t,s),this.updateAll(t)})),this.opts.debug&&"undefined"!=typeof window&&(window[this.opts.id]=this),F(this,H)[H]()}emit(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];F(this,$)[$].emit(e,...s)}on(e,t){return F(this,$)[$].on(e,t),this}once(e,t){return F(this,$)[$].once(e,t),this}off(e,t){return F(this,$)[$].off(e,t),this}updateAll(e){this.iteratePlugins((t=>{t.update(e)}))}setState(e){this.store.setState(e)}getState(){return this.store.getState()}setFileState(e,t){if(!this.getState().files[e])throw new Error(`Canâ€™t set state for ${e} (the file could have been removed)`);this.setState({files:{...this.getState().files,[e]:{...this.getState().files[e],...t}}})}i18nInit(){const e=new i.Z([this.defaultLocale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.locale=e.locale}setOptions(e){this.opts={...this.opts,...e,restrictions:{...this.opts.restrictions,...e&&e.restrictions}},e.meta&&this.setMeta(e.meta),this.i18nInit(),e.locale&&this.iteratePlugins((e=>{e.setOptions()})),this.setState()}resetProgress(){const e={percentage:0,bytesUploaded:0,uploadComplete:!1,uploadStarted:null},t={...this.getState().files},s={};Object.keys(t).forEach((i=>{const r={...t[i]};r.progress={...r.progress,...e},s[i]=r})),this.setState({files:s,totalProgress:0}),this.emit("reset-progress")}addPreProcessor(e){F(this,I)[I].add(e)}removePreProcessor(e){return F(this,I)[I].delete(e)}addPostProcessor(e){F(this,M)[M].add(e)}removePostProcessor(e){return F(this,M)[M].delete(e)}addUploader(e){F(this,L)[L].add(e)}removeUploader(e){return F(this,L)[L].delete(e)}setMeta(e){const t={...this.getState().meta,...e},s={...this.getState().files};Object.keys(s).forEach((t=>{s[t]={...s[t],meta:{...s[t].meta,...e}}})),this.log("Adding metadata:"),this.log(e),this.setState({meta:t,files:s})}setFileMeta(e,t){const s={...this.getState().files};if(!s[e])return void this.log("Was trying to set metadata for a file that has been removed: ",e);const i={...s[e].meta,...t};s[e]={...s[e],meta:i},this.setState({files:s})}getFile(e){return this.getState().files[e]}getFiles(){const{files:e}=this.getState();return Object.values(e)}getObjectOfFilesPerState(){const{files:e,totalProgress:t,error:s}=this.getState(),i=Object.values(e),r=i.filter((e=>{let{progress:t}=e;return!t.uploadComplete&&t.uploadStarted})),n=i.filter((e=>!e.progress.uploadStarted)),o=i.filter((e=>e.progress.uploadStarted||e.progress.preprocess||e.progress.postprocess)),a=i.filter((e=>e.progress.uploadStarted)),l=i.filter((e=>e.isPaused)),h=i.filter((e=>e.progress.uploadComplete)),u=i.filter((e=>e.error)),d=r.filter((e=>!e.isPaused)),p=i.filter((e=>e.progress.preprocess||e.progress.postprocess));return{newFiles:n,startedFiles:o,uploadStartedFiles:a,pausedFiles:l,completeFiles:h,erroredFiles:u,inProgressFiles:r,inProgressNotPausedFiles:d,processingFiles:p,isUploadStarted:a.length>0,isAllComplete:100===t&&h.length===i.length&&0===p.length,isAllErrored:!!s&&u.length===i.length,isAllPaused:0!==r.length&&l.length===r.length,isUploadInProgress:r.length>0,isSomeGhost:i.some((e=>e.isGhost))}}validateRestrictions(e,t){void 0===t&&(t=this.getFiles());try{F(this,j)[j].validate(e,t)}catch(e){return e}return null}checkIfFileAlreadyExists(e){const{files:t}=this.getState();return!(!t[e]||t[e].isGhost)}addFile(e){F(this,D)[D](e);const{files:t}=this.getState();let s=F(this,V)[V](t,e);return t[s.id]&&t[s.id].isGhost&&(s={...t[s.id],data:e.data,isGhost:!1},this.log(`Replaced the blob in the restored ghost file: ${s.name}, ${s.id}`)),this.setState({files:{...t,[s.id]:s}}),this.emit("file-added",s),this.emit("files-added",[s]),this.log(`Added file: ${s.name}, ${s.id}, mime type: ${s.type}`),F(this,q)[q](),s.id}addFiles(e){F(this,D)[D]();const t={...this.getState().files},s=[],i=[];for(let r=0;r<e.length;r++)try{let i=F(this,V)[V](t,e[r]);t[i.id]&&t[i.id].isGhost&&(i={...t[i.id],data:e[r].data,isGhost:!1},this.log(`Replaced blob in a ghost file: ${i.name}, ${i.id}`)),t[i.id]=i,s.push(i)}catch(e){e.isRestriction||i.push(e)}if(this.setState({files:t}),s.forEach((e=>{this.emit("file-added",e)})),this.emit("files-added",s),s.length>5?this.log(`Added batch of ${s.length} files`):Object.keys(s).forEach((e=>{this.log(`Added file: ${s[e].name}\n id: ${s[e].id}\n type: ${s[e].type}`)})),s.length>0&&F(this,q)[q](),i.length>0){let e="Multiple errors occurred while adding files:\n";if(i.forEach((t=>{e+=`\n * ${t.message}`})),this.info({message:this.i18n("addBulkFilesFailed",{smart_count:i.length}),details:e},"error",this.opts.infoTimeout),"function"==typeof AggregateError)throw new AggregateError(i,e);{const t=new Error(e);throw t.errors=i,t}}}removeFiles(e,t){const{files:s,currentUploads:i}=this.getState(),r={...s},n={...i},o=Object.create(null);function a(e){return void 0===o[e]}e.forEach((e=>{s[e]&&(o[e]=s[e],delete r[e])})),Object.keys(n).forEach((e=>{const t=i[e].fileIDs.filter(a);if(0===t.length)return void delete n[e];const{capabilities:s}=this.getState();if(t.length!==i[e].fileIDs.length&&!s.individualCancellation)throw new Error("individualCancellation is disabled");n[e]={...i[e],fileIDs:t}}));const l={currentUploads:n,files:r};0===Object.keys(r).length&&(l.allowNewUpload=!0,l.error=null,l.recoveredState=null),this.setState(l),this.calculateTotalProgress();const h=Object.keys(o);h.forEach((e=>{this.emit("file-removed",o[e],t)})),h.length>5?this.log(`Removed ${h.length} files`):this.log(`Removed files: ${h.join(", ")}`)}removeFile(e,t){void 0===t&&(t=null),this.removeFiles([e],t)}pauseResume(e){if(!this.getState().capabilities.resumableUploads||this.getFile(e).uploadComplete)return;const t=!(this.getFile(e).isPaused||!1);return this.setFileState(e,{isPaused:t}),this.emit("upload-pause",e,t),t}pauseAll(){const e={...this.getState().files};Object.keys(e).filter((t=>!e[t].progress.uploadComplete&&e[t].progress.uploadStarted)).forEach((t=>{const s={...e[t],isPaused:!0};e[t]=s})),this.setState({files:e}),this.emit("pause-all")}resumeAll(){const e={...this.getState().files};Object.keys(e).filter((t=>!e[t].progress.uploadComplete&&e[t].progress.uploadStarted)).forEach((t=>{const s={...e[t],isPaused:!1,error:null};e[t]=s})),this.setState({files:e}),this.emit("resume-all")}retryAll(){const e={...this.getState().files},t=Object.keys(e).filter((t=>e[t].error));if(t.forEach((t=>{const s={...e[t],isPaused:!1,error:null};e[t]=s})),this.setState({files:e,error:null}),this.emit("retry-all",t),0===t.length)return Promise.resolve({successful:[],failed:[]});const s=F(this,G)[G](t,{forceAllowNewUpload:!0});return F(this,Y)[Y](s)}cancelAll(e){let{reason:t="user"}=void 0===e?{}:e;if(this.emit("cancel-all",{reason:t}),"user"===t){const{files:e}=this.getState(),t=Object.keys(e);t.length&&this.removeFiles(t,"cancel-all"),this.setState({totalProgress:0,error:null,recoveredState:null})}}retryUpload(e){this.setFileState(e,{error:null,isPaused:!1}),this.emit("upload-retry",e);const t=F(this,G)[G]([e],{forceAllowNewUpload:!0});return F(this,Y)[Y](t)}logout(){this.iteratePlugins((e=>{e.provider&&e.provider.logout&&e.provider.logout()}))}calculateProgress(e,t){if(null==e||!this.getFile(e.id))return void this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`);const s=Number.isFinite(t.bytesTotal)&&t.bytesTotal>0;this.setFileState(e.id,{progress:{...this.getFile(e.id).progress,bytesUploaded:t.bytesUploaded,bytesTotal:t.bytesTotal,percentage:s?Math.round(t.bytesUploaded/t.bytesTotal*100):0}}),this.calculateTotalProgress()}calculateTotalProgress(){const e=this.getFiles().filter((e=>e.progress.uploadStarted||e.progress.preprocess||e.progress.postprocess));if(0===e.length)return this.emit("progress",0),void this.setState({totalProgress:0});const t=e.filter((e=>null!=e.progress.bytesTotal)),s=e.filter((e=>null==e.progress.bytesTotal));if(0===t.length){const t=100*e.length,i=s.reduce(((e,t)=>e+t.progress.percentage),0),r=Math.round(i/t*100);return void this.setState({totalProgress:r})}let i=t.reduce(((e,t)=>e+t.progress.bytesTotal),0);const r=i/t.length;i+=r*s.length;let n=0;t.forEach((e=>{n+=e.progress.bytesUploaded})),s.forEach((e=>{n+=r*(e.progress.percentage||0)/100}));let o=0===i?0:Math.round(n/i*100);o>100&&(o=100),this.setState({totalProgress:o}),this.emit("progress",o)}updateOnlineStatus(){void 0===window.navigator.onLine||window.navigator.onLine?(this.emit("is-online"),this.wasOffline&&(this.emit("back-online"),this.info(this.i18n("connectedToInternet"),"success",3e3),this.wasOffline=!1)):(this.emit("is-offline"),this.info(this.i18n("noInternetConnection"),"error",0),this.wasOffline=!0)}getID(){return this.opts.id}use(e,t){if("function"!=typeof e){throw new TypeError(`Expected a plugin class, but got ${null===e?"null":typeof e}. Please verify that the plugin was imported and spelled correctly.`)}const s=new e(this,t),i=s.id;if(!i)throw new Error("Your plugin must have an id");if(!s.type)throw new Error("Your plugin must have a type");const r=this.getPlugin(i);if(r){const e=`Already found a plugin named '${r.id}'. Tried to use: '${i}'.\nUppy plugins must have unique \`id\` options. See https://uppy.io/docs/plugins/#id.`;throw new Error(e)}return e.VERSION&&this.log(`Using ${i} v${e.VERSION}`),s.type in F(this,C)[C]?F(this,C)[C][s.type].push(s):F(this,C)[C][s.type]=[s],s.install(),this}getPlugin(e){for(const t of Object.values(F(this,C)[C])){const s=t.find((t=>t.id===e));if(null!=s)return s}}[U](e){return F(this,C)[C][e]}iteratePlugins(e){Object.values(F(this,C)[C]).flat(1).forEach(e)}removePlugin(e){this.log(`Removing plugin ${e.id}`),this.emit("plugin-remove",e),e.uninstall&&e.uninstall();const t=F(this,C)[C][e.type],s=t.findIndex((t=>t.id===e.id));-1!==s&&t.splice(s,1);const i={plugins:{...this.getState().plugins,[e.id]:void 0}};this.setState(i)}close(e){let{reason:t}=void 0===e?{}:e;this.log(`Closing Uppy instance ${this.opts.id}: removing all files and uninstalling plugins`),this.cancelAll({reason:t}),F(this,R)[R](),this.iteratePlugins((e=>{this.removePlugin(e)})),"undefined"!=typeof window&&window.removeEventListener&&(window.removeEventListener("online",F(this,W)[W]),window.removeEventListener("offline",F(this,W)[W]))}hideInfo(){const{info:e}=this.getState();this.setState({info:e.slice(1)}),this.emit("info-hidden")}info(e,t,s){void 0===t&&(t="info"),void 0===s&&(s=3e3);const i="object"==typeof e;this.setState({info:[...this.getState().info,{type:t,message:i?e.message:e,details:i?e.details:null}]}),setTimeout((()=>this.hideInfo()),s),this.emit("info-visible")}log(e,t){const{logger:s}=this.opts;switch(t){case"error":s.error(e);break;case"warning":s.warn(e);break;default:s.debug(e)}}restore(e){return this.log(`Core: attempting to restore upload "${e}"`),this.getState().currentUploads[e]?F(this,Y)[Y](e):(F(this,K)[K](e),Promise.reject(new Error("Nonexistent upload")))}[E](){return F(this,G)[G](...arguments)}addResultData(e,t){if(!F(this,X)[X](e))return void this.log(`Not setting result for an upload that has been removed: ${e}`);const{currentUploads:s}=this.getState(),i={...s[e],result:{...s[e].result,...t}};this.setState({currentUploads:{...s,[e]:i}})}upload(){var e;null!=(e=F(this,C)[C].uploader)&&e.length||this.log("No uploader type plugins are used","warning");let{files:t}=this.getState();const s=this.opts.onBeforeUpload(t);return!1===s?Promise.reject(new Error("Not starting the upload because onBeforeUpload returned false")):(s&&"object"==typeof s&&(t=s,this.setState({files:t})),Promise.resolve().then((()=>F(this,j)[j].validateMinNumberOfFiles(t))).catch((e=>{throw F(this,N)[N](e),e})).then((()=>{if(!F(this,B)[B](t))throw new O(this.i18n("missingRequiredMetaField"))})).catch((e=>{throw e})).then((()=>{const{currentUploads:e}=this.getState(),s=Object.values(e).flatMap((e=>e.fileIDs)),i=[];Object.keys(t).forEach((e=>{const t=this.getFile(e);t.progress.uploadStarted||-1!==s.indexOf(e)||i.push(t.id)}));const r=F(this,G)[G](i);return F(this,Y)[Y](r)})).catch((e=>{throw this.emit("error",e),this.log(e,"error"),e})))}}function J(e,t){const{message:s,details:i=""}=e;e.isRestriction?this.emit("restriction-failed",t,e):this.emit("error",e),this.info({message:s,details:i},"error",this.opts.infoTimeout),this.log(`${s} ${i}`.trim(),"error")}function Q(e){const{missingFields:t,error:s}=F(this,j)[j].getMissingRequiredMetaFields(e);return!(t.length>0)||(this.setFileState(e.id,{missingRequiredMetaFields:t}),this.log(s.message),this.emit("restriction-failed",e,s),!1)}function ee(e){let t=!0;for(const s of Object.values(e))F(this,z)[z](s)||(t=!1);return t}function te(e){const{allowNewUpload:t}=this.getState();if(!1===t){const t=new O(this.i18n("noMoreFilesAllowed"));throw F(this,N)[N](t,e),t}}function se(e,t){t instanceof File&&(t={name:t.name,type:t.type,size:t.size,data:t});const s=function(e){var t;if(e.type)return e.type;const s=e.name?null==(t=g(e.name).extension)?void 0:t.toLowerCase():null;return s&&s in m?m[s]:"application/octet-stream"}(t),i=function(e,t){return t.name?t.name:"image"===e.split("/")[0]?`${e.split("/")[0]}.${e.split("/")[1]}`:"noname"}(s,t),r=g(i).extension,n=Boolean(t.isRemote),o=function(e){let t="uppy";return"string"==typeof e.name&&(t+=`-${y(e.name.toLowerCase())}`),void 0!==e.type&&(t+=`-${e.type}`),e.meta&&"string"==typeof e.meta.relativePath&&(t+=`-${y(e.meta.relativePath.toLowerCase())}`),void 0!==e.data.size&&(t+=`-${e.data.size}`),void 0!==e.data.lastModified&&(t+=`-${e.data.lastModified}`),t}({...t,type:s});if(this.checkIfFileAlreadyExists(o)){const e=new O(this.i18n("noDuplicates",{fileName:i}));throw F(this,N)[N](e,t),e}const a=t.meta||{};a.name=i,a.type=s;const l=Number.isFinite(t.data.size)?t.data.size:null;let h={source:t.source||"",id:o,name:i,extension:r||"",meta:{...this.getState().meta,...a},type:s,data:t.data,progress:{percentage:0,bytesUploaded:0,bytesTotal:l,uploadComplete:!1,uploadStarted:null},size:l,isRemote:n,remote:t.remote||"",preview:t.preview};const u=this.opts.onBeforeFileAdded(h,e);if(!1===u){const e=new O("Cannot add the file because onBeforeFileAdded returned false.");throw this.emit("restriction-failed",t,e),e}"object"==typeof u&&null!==u&&(h=u);try{const t=Object.keys(e).map((t=>e[t]));F(this,j)[j].validate(h,t)}catch(e){throw F(this,N)[N](e,h),e}return h}function ie(){this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout((()=>{this.scheduledAutoProceed=null,this.upload().catch((e=>{e.isRestriction||this.log(e.stack||e.message||e)}))}),4))}function re(){const e=(e,t,s)=>{let i=e.message||"Unknown error";e.details&&(i+=` ${e.details}`),this.setState({error:i}),null!=t&&t.id in this.getState().files&&this.setFileState(t.id,{error:i,response:s})};this.on("error",e),this.on("upload-error",((t,s,i)=>{if(e(s,t,i),"object"==typeof s&&s.message){const e=new Error(s.message);e.details=s.message,s.details&&(e.details+=` ${s.details}`),e.message=this.i18n("failedToUpload",{file:null==t?void 0:t.name}),F(this,N)[N](e)}else F(this,N)[N](s)})),this.on("upload",(()=>{this.setState({error:null})})),this.on("upload-started",(e=>{null!=e&&this.getFile(e.id)?this.setFileState(e.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,percentage:0,bytesUploaded:0,bytesTotal:e.size}}):this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`)})),this.on("upload-progress",this.calculateProgress),this.on("upload-success",((e,t)=>{if(null==e||!this.getFile(e.id))return void this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`);const s=this.getFile(e.id).progress;this.setFileState(e.id,{progress:{...s,postprocess:F(this,M)[M].size>0?{mode:"indeterminate"}:null,uploadComplete:!0,percentage:100,bytesUploaded:s.bytesTotal},response:t,uploadURL:t.uploadURL,isPaused:!1}),null==e.size&&this.setFileState(e.id,{size:t.bytesUploaded||s.bytesTotal}),this.calculateTotalProgress()})),this.on("preprocess-progress",((e,t)=>{null!=e&&this.getFile(e.id)?this.setFileState(e.id,{progress:{...this.getFile(e.id).progress,preprocess:t}}):this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`)})),this.on("preprocess-complete",(e=>{if(null==e||!this.getFile(e.id))return void this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`);const t={...this.getState().files};t[e.id]={...t[e.id],progress:{...t[e.id].progress}},delete t[e.id].progress.preprocess,this.setState({files:t})})),this.on("postprocess-progress",((e,t)=>{null!=e&&this.getFile(e.id)?this.setFileState(e.id,{progress:{...this.getState().files[e.id].progress,postprocess:t}}):this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`)})),this.on("postprocess-complete",(e=>{if(null==e||!this.getFile(e.id))return void this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`);const t={...this.getState().files};t[e.id]={...t[e.id],progress:{...t[e.id].progress}},delete t[e.id].progress.postprocess,this.setState({files:t})})),this.on("restored",(()=>{this.calculateTotalProgress()})),this.on("dashboard:file-edit-complete",(e=>{e&&F(this,z)[z](e)})),"undefined"!=typeof window&&window.addEventListener&&(window.addEventListener("online",F(this,W)[W]),window.addEventListener("offline",F(this,W)[W]),setTimeout(F(this,W)[W],3e3))}function ne(e,t){void 0===t&&(t={});const{forceAllowNewUpload:s=!1}=t,{allowNewUpload:i,currentUploads:r}=this.getState();if(!i&&!s)throw new Error("Cannot create a new upload: already uploading.");const o=(0,n.x)();return this.emit("upload",{id:o,fileIDs:e}),this.setState({allowNewUpload:!1!==this.opts.allowMultipleUploadBatches&&!1!==this.opts.allowMultipleUploads,currentUploads:{...r,[o]:{fileIDs:e,step:0,result:{}}}}),o}function oe(e){const{currentUploads:t}=this.getState();return t[e]}function ae(e){const t={...this.getState().currentUploads};delete t[e],this.setState({currentUploads:t})}async function le(e){let{currentUploads:t}=this.getState(),s=t[e];const i=s.step||0,r=[...F(this,I)[I],...F(this,L)[L],...F(this,M)[M]];try{for(let n=i;n<r.length&&s;n++){const i=r[n],o={...s,step:n};this.setState({currentUploads:{...t,[e]:o}}),await i(o.fileIDs,e),t=this.getState().currentUploads,s=t[e]}}catch(t){throw F(this,K)[K](e),t}if(s){s.fileIDs.forEach((e=>{const t=this.getFile(e);t&&t.progress.postprocess&&this.emit("postprocess-complete",t)}));const i=s.fileIDs.map((e=>this.getFile(e))),r=i.filter((e=>!e.error)),n=i.filter((e=>e.error));await this.addResultData(e,{successful:r,failed:n,uploadID:e}),t=this.getState().currentUploads,s=t[e]}let n;return s&&(n=s.result,this.emit("complete",n),F(this,K)[K](e)),null==n&&this.log(`Not setting result for an upload that has been removed: ${e}`),n}Z.VERSION="3.0.0";const he=Z;var ue,de,pe,ce,fe,ge={},me=[],ye=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function ve(e,t){for(var s in t)e[s]=t[s];return e}function be(e){var t=e.parentNode;t&&t.removeChild(e)}function we(e,t,s,i,r){var n={type:e,props:t,key:s,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==r?++pe:r};return null==r&&null!=de.vnode&&de.vnode(n),n}function _e(e){return e.children}function ke(e,t){this.props=e,this.context=t}function Se(e,t){if(null==t)return e.__?Se(e.__,e.__.__k.indexOf(e)+1):null;for(var s;t<e.__k.length;t++)if(null!=(s=e.__k[t])&&null!=s.__e)return s.__e;return"function"==typeof e.type?Se(e):null}function Oe(e){var t,s;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(s=e.__k[t])&&null!=s.__e){e.__e=e.__c.base=s.__e;break}return Oe(e)}}function Pe(e){(!e.__d&&(e.__d=!0)&&ce.push(e)&&!xe.__r++||fe!==de.debounceRendering)&&((fe=de.debounceRendering)||setTimeout)(xe)}function xe(){for(var e;xe.__r=ce.length;)e=ce.sort((function(e,t){return e.__v.__b-t.__v.__b})),ce=[],e.some((function(e){var t,s,i,r,n,o;e.__d&&(n=(r=(t=e).__v).__e,(o=t.__P)&&(s=[],(i=ve({},r)).__v=r.__v+1,Re(o,r,i,t.__n,void 0!==o.ownerSVGElement,null!=r.__h?[n]:null,s,null==n?Se(r):n,r.__h),$e(s,r),r.__e!=n&&Oe(r)))}))}function Ue(e,t,s,i,r,n,o,a,l,h){var u,d,p,c,f,g,m,y=i&&i.__k||me,v=y.length;for(s.__k=[],u=0;u<t.length;u++)if(null!=(c=s.__k[u]=null==(c=t[u])||"boolean"==typeof c?null:"string"==typeof c||"number"==typeof c||"bigint"==typeof c?we(null,c,null,null,c):Array.isArray(c)?we(_e,{children:c},null,null,null):c.__b>0?we(c.type,c.props,c.key,null,c.__v):c)){if(c.__=s,c.__b=s.__b+1,null===(p=y[u])||p&&c.key==p.key&&c.type===p.type)y[u]=void 0;else for(d=0;d<v;d++){if((p=y[d])&&c.key==p.key&&c.type===p.type){y[d]=void 0;break}p=null}Re(e,c,p=p||ge,r,n,o,a,l,h),f=c.__e,(d=c.ref)&&p.ref!=d&&(m||(m=[]),p.ref&&m.push(p.ref,null,c),m.push(d,c.__c||f,c)),null!=f?(null==g&&(g=f),"function"==typeof c.type&&c.__k===p.__k?c.__d=l=Ee(c,l,e):l=Fe(e,c,p,y,f,l),"function"==typeof s.type&&(s.__d=l)):l&&p.__e==l&&l.parentNode!=e&&(l=Se(p))}for(s.__e=g,u=v;u--;)null!=y[u]&&("function"==typeof s.type&&null!=y[u].__e&&y[u].__e==s.__d&&(s.__d=Se(i,u+1)),Me(y[u],y[u]));if(m)for(u=0;u<m.length;u++)Le(m[u],m[++u],m[++u])}function Ee(e,t,s){for(var i,r=e.__k,n=0;r&&n<r.length;n++)(i=r[n])&&(i.__=e,t="function"==typeof i.type?Ee(i,t,s):Fe(s,i,i,r,i.__e,t));return t}function Fe(e,t,s,i,r,n){var o,a,l;if(void 0!==t.__d)o=t.__d,t.__d=void 0;else if(null==s||r!=n||null==r.parentNode)e:if(null==n||n.parentNode!==e)e.appendChild(r),o=null;else{for(a=n,l=0;(a=a.nextSibling)&&l<i.length;l+=2)if(a==r)break e;e.insertBefore(r,n),o=n}return void 0!==o?o:r.nextSibling}function Ae(e,t,s){"-"===t[0]?e.setProperty(t,s):e[t]=null==s?"":"number"!=typeof s||ye.test(t)?s:s+"px"}function Te(e,t,s,i,r){var n;e:if("style"===t)if("string"==typeof s)e.style.cssText=s;else{if("string"==typeof i&&(e.style.cssText=i=""),i)for(t in i)s&&t in s||Ae(e.style,t,"");if(s)for(t in s)i&&s[t]===i[t]||Ae(e.style,t,s[t])}else if("o"===t[0]&&"n"===t[1])n=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+n]=s,s?i||e.addEventListener(t,n?je:Ce,n):e.removeEventListener(t,n?je:Ce,n);else if("dangerouslySetInnerHTML"!==t){if(r)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=null==s?"":s;break e}catch(e){}"function"==typeof s||(null!=s&&(!1!==s||"a"===t[0]&&"r"===t[1])?e.setAttribute(t,s):e.removeAttribute(t))}}function Ce(e){this.l[e.type+!1](de.event?de.event(e):e)}function je(e){this.l[e.type+!0](de.event?de.event(e):e)}function Re(e,t,s,i,r,n,o,a,l){var h,u,d,p,c,f,g,m,y,v,b,w,_,k=t.type;if(void 0!==t.constructor)return null;null!=s.__h&&(l=s.__h,a=t.__e=s.__e,t.__h=null,n=[a]),(h=de.__b)&&h(t);try{e:if("function"==typeof k){if(m=t.props,y=(h=k.contextType)&&i[h.__c],v=h?y?y.props.value:h.__:i,s.__c?g=(u=t.__c=s.__c).__=u.__E:("prototype"in k&&k.prototype.render?t.__c=u=new k(m,v):(t.__c=u=new ke(m,v),u.constructor=k,u.render=Ne),y&&y.sub(u),u.props=m,u.state||(u.state={}),u.context=v,u.__n=i,d=u.__d=!0,u.__h=[]),null==u.__s&&(u.__s=u.state),null!=k.getDerivedStateFromProps&&(u.__s==u.state&&(u.__s=ve({},u.__s)),ve(u.__s,k.getDerivedStateFromProps(m,u.__s))),p=u.props,c=u.state,d)null==k.getDerivedStateFromProps&&null!=u.componentWillMount&&u.componentWillMount(),null!=u.componentDidMount&&u.__h.push(u.componentDidMount);else{if(null==k.getDerivedStateFromProps&&m!==p&&null!=u.componentWillReceiveProps&&u.componentWillReceiveProps(m,v),!u.__e&&null!=u.shouldComponentUpdate&&!1===u.shouldComponentUpdate(m,u.__s,v)||t.__v===s.__v){u.props=m,u.state=u.__s,t.__v!==s.__v&&(u.__d=!1),u.__v=t,t.__e=s.__e,t.__k=s.__k,t.__k.forEach((function(e){e&&(e.__=t)})),u.__h.length&&o.push(u);break e}null!=u.componentWillUpdate&&u.componentWillUpdate(m,u.__s,v),null!=u.componentDidUpdate&&u.__h.push((function(){u.componentDidUpdate(p,c,f)}))}if(u.context=v,u.props=m,u.__v=t,u.__P=e,b=de.__r,w=0,"prototype"in k&&k.prototype.render)u.state=u.__s,u.__d=!1,b&&b(t),h=u.render(u.props,u.state,u.context);else do{u.__d=!1,b&&b(t),h=u.render(u.props,u.state,u.context),u.state=u.__s}while(u.__d&&++w<25);u.state=u.__s,null!=u.getChildContext&&(i=ve(ve({},i),u.getChildContext())),d||null==u.getSnapshotBeforeUpdate||(f=u.getSnapshotBeforeUpdate(p,c)),_=null!=h&&h.type===_e&&null==h.key?h.props.children:h,Ue(e,Array.isArray(_)?_:[_],t,s,i,r,n,o,a,l),u.base=t.__e,t.__h=null,u.__h.length&&o.push(u),g&&(u.__E=u.__=null),u.__e=!1}else null==n&&t.__v===s.__v?(t.__k=s.__k,t.__e=s.__e):t.__e=Ie(s.__e,t,s,i,r,n,o,l);(h=de.diffed)&&h(t)}catch(e){t.__v=null,(l||null!=n)&&(t.__e=a,t.__h=!!l,n[n.indexOf(a)]=null),de.__e(e,t,s)}}function $e(e,t){de.__c&&de.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){de.__e(e,t.__v)}}))}function Ie(e,t,s,i,r,n,o,a){var l,h,u,d=s.props,p=t.props,c=t.type,f=0;if("svg"===c&&(r=!0),null!=n)for(;f<n.length;f++)if((l=n[f])&&"setAttribute"in l==!!c&&(c?l.localName===c:3===l.nodeType)){e=l,n[f]=null;break}if(null==e){if(null===c)return document.createTextNode(p);e=r?document.createElementNS("http://www.w3.org/2000/svg",c):document.createElement(c,p.is&&p),n=null,a=!1}if(null===c)d===p||a&&e.data===p||(e.data=p);else{if(n=n&&ue.call(e.childNodes),h=(d=s.props||ge).dangerouslySetInnerHTML,u=p.dangerouslySetInnerHTML,!a){if(null!=n)for(d={},f=0;f<e.attributes.length;f++)d[e.attributes[f].name]=e.attributes[f].value;(u||h)&&(u&&(h&&u.__html==h.__html||u.__html===e.innerHTML)||(e.innerHTML=u&&u.__html||""))}if(function(e,t,s,i,r){var n;for(n in s)"children"===n||"key"===n||n in t||Te(e,n,null,s[n],i);for(n in t)r&&"function"!=typeof t[n]||"children"===n||"key"===n||"value"===n||"checked"===n||s[n]===t[n]||Te(e,n,t[n],s[n],i)}(e,p,d,r,a),u)t.__k=[];else if(f=t.props.children,Ue(e,Array.isArray(f)?f:[f],t,s,i,r&&"foreignObject"!==c,n,o,n?n[0]:s.__k&&Se(s,0),a),null!=n)for(f=n.length;f--;)null!=n[f]&&be(n[f]);a||("value"in p&&void 0!==(f=p.value)&&(f!==e.value||"progress"===c&&!f||"option"===c&&f!==d.value)&&Te(e,"value",f,d.value,!1),"checked"in p&&void 0!==(f=p.checked)&&f!==e.checked&&Te(e,"checked",f,d.checked,!1))}return e}function Le(e,t,s){try{"function"==typeof e?e(t):e.current=t}catch(e){de.__e(e,s)}}function Me(e,t,s){var i,r;if(de.unmount&&de.unmount(e),(i=e.ref)&&(i.current&&i.current!==e.__e||Le(i,null,t)),null!=(i=e.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(e){de.__e(e,t)}i.base=i.__P=null}if(i=e.__k)for(r=0;r<i.length;r++)i[r]&&Me(i[r],t,"function"!=typeof e.type);s||null==e.__e||be(e.__e),e.__e=e.__d=void 0}function Ne(e,t,s){return this.constructor(e,s)}function ze(e,t,s){var i,r,n;de.__&&de.__(e,t),r=(i="function"==typeof s)?null:s&&s.__k||t.__k,n=[],Re(t,e=(!i&&s||t).__k=function(e,t,s){var i,r,n,o={};for(n in t)"key"==n?i=t[n]:"ref"==n?r=t[n]:o[n]=t[n];if(arguments.length>2&&(o.children=arguments.length>3?ue.call(arguments,2):s),"function"==typeof e&&null!=e.defaultProps)for(n in e.defaultProps)void 0===o[n]&&(o[n]=e.defaultProps[n]);return we(e,o,i,r,null)}(_e,null,[e]),r||ge,ge,void 0!==t.ownerSVGElement,!i&&s?[s]:r?null:t.firstChild?ue.call(t.childNodes):null,n,!i&&s?s:r?r.__e:t.firstChild,i),$e(n,e)}function Be(e,t){return void 0===t&&(t=document),"string"==typeof e?t.querySelector(e):(null==(s=e)?void 0:s.nodeType)===Node.ELEMENT_NODE?e:null;var s}ue=me.slice,de={__e:function(e,t,s,i){for(var r,n,o;t=t.__;)if((r=t.__c)&&!r.__)try{if((n=r.constructor)&&null!=n.getDerivedStateFromError&&(r.setState(n.getDerivedStateFromError(e)),o=r.__d),null!=r.componentDidCatch&&(r.componentDidCatch(e,i||{}),o=r.__d),o)return r.__E=r}catch(t){e=t}throw e}},pe=0,ke.prototype.setState=function(e,t){var s;s=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=ve({},this.state),"function"==typeof e&&(e=e(ve({},s),this.props)),e&&ve(s,e),null!=e&&this.__v&&(t&&this.__h.push(t),Pe(this))},ke.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),Pe(this))},ke.prototype.render=_e,ce=[],xe.__r=0;const De=function(e){for(var t;e&&!e.dir;)e=e.parentNode;return null==(t=e)?void 0:t.dir};var Ve=s(8596);function qe(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var He=0;function We(e){return"__private_"+He+++"_"+e}var Ge=We("updateUI");class Xe extends Ve.Z{constructor(){super(...arguments),Object.defineProperty(this,Ge,{writable:!0,value:void 0})}mount(e,t){const s=t.id,i=Be(e);if(i){this.isTargetDOMEl=!0;const t=document.createElement("div");return t.classList.add("uppy-Root"),qe(this,Ge)[Ge]=function(e){let t=null,s=null;return function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return s=r,t||(t=Promise.resolve().then((()=>(t=null,e(...s))))),t}}((e=>{this.uppy.getPlugin(this.id)&&(ze(this.render(e),t),this.afterUpdate())})),this.uppy.log(`Installing ${s} to a DOM element '${e}'`),this.opts.replaceTargetContent&&(i.innerHTML=""),ze(this.render(this.uppy.getState()),t),this.el=t,i.appendChild(t),t.dir=this.opts.direction||De(t)||"ltr",this.onMount(),this.el}let r;if("object"==typeof e&&e instanceof Xe)r=e;else if("function"==typeof e){const t=e;this.uppy.iteratePlugins((e=>{e instanceof t&&(r=e)}))}if(r)return this.uppy.log(`Installing ${s} to ${r.id}`),this.parent=r,this.el=r.addTarget(t),this.onMount(),this.el;this.uppy.log(`Not installing ${s}`);let n=`Invalid target option given to ${s}.`;throw n+="function"==typeof e?" The given target is not a Plugin class. Please check that you're not specifying a React Component instead of a plugin. If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.":"If you meant to target an HTML element, please make sure that the element exists. Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. (see https://github.com/transloadit/uppy/issues/1042)\n\nIf you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.",new Error(n)}update(e){var t,s;null!=this.el&&(null==(t=(s=qe(this,Ge))[Ge])||t.call(s,e))}unmount(){var e;this.isTargetDOMEl&&(null==(e=this.el)||e.remove());this.onUnmount()}onMount(){}onUnmount(){}}const Ke=Xe},4136:(e,t,s)=>{"use strict";function i(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}s.d(t,{Z:()=>h});var r=0;function n(e){return"__private_"+r+++"_"+e}function o(e,t,s){const i=[];return e.forEach((e=>"string"!=typeof e?i.push(e):t[Symbol.split](e).forEach(((e,t,r)=>{""!==e&&i.push(e),t<r.length-1&&i.push(s)})))),i}function a(e,t){const s=/\$/g;let i=[e];if(null==t)return i;for(const e of Object.keys(t))if("_"!==e){let r=t[e];"string"==typeof r&&(r=s[Symbol.replace](r,"$$$$")),i=o(i,new RegExp(`%\\{${e}\\}`,"g"),r)}return i}var l=n("apply");class h{constructor(e){Object.defineProperty(this,l,{value:u}),this.locale={strings:{},pluralize:e=>1===e?0:1},Array.isArray(e)?e.forEach(i(this,l)[l],this):i(this,l)[l](e)}translate(e,t){return this.translateArray(e,t).join("")}translateArray(e,t){if(!function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(this.locale.strings,e))throw new Error(`missing string: ${e}`);const s=this.locale.strings[e];if("object"==typeof s){if(t&&void 0!==t.smart_count){return a(s[this.locale.pluralize(t.smart_count)],t)}throw new Error("Attempted to use a string with plural forms, but no value was given for %{smart_count}")}return a(s,t)}}function u(e){if(null==e||!e.strings)return;const t=this.locale;this.locale={...t,strings:{...t.strings,...e.strings}},this.locale.pluralize=e.pluralize||t.pluralize}},5024:(e,t,s)=>{"use strict";s.d(t,{Z:()=>u});var i=s(9063);const r=/^data:([^/]+\/[^,;]+(?:[^,]*?))(;base64)?,([\s\S]*)$/;function n(e){return e.startsWith("blob:")}function o(e){return!!e&&/^[^/]+\/(jpe?g|gif|png|svg|svg\+xml|bmp|webp|avif)$/.test(e)}var a=s(1443);const l={strings:{generatingThumbnails:"Generating thumbnails..."}};function h(e,t,s){try{e.getContext("2d").getImageData(0,0,1,1)}catch(e){if(18===e.code)return Promise.reject(new Error("cannot read image, probably an svg with external resources"))}return e.toBlob?new Promise((i=>{e.toBlob(i,t,s)})).then((e=>{if(null===e)throw new Error("cannot read image, probably an svg with external resources");return e})):Promise.resolve().then((()=>function(e,t,s){var i,n;const o=r.exec(e),a=null!=(i=null!=(n=t.mimeType)?n:null==o?void 0:o[1])?i:"plain/text";let l;if(null!=o[2]){const e=atob(decodeURIComponent(o[3])),t=new Uint8Array(e.length);for(let s=0;s<e.length;s++)t[s]=e.charCodeAt(s);l=[t]}else l=[decodeURIComponent(o[3])];return s?new File(l,t.name||"",{type:a}):new Blob(l,{type:a})}(e.toDataURL(t,s),{}))).then((e=>{if(null===e)throw new Error("could not extract blob, probably an old browser");return e}))}class u extends i.di{constructor(e,t){super(e,t),this.onFileAdded=e=>{!e.preview&&e.data&&o(e.type)&&!e.isRemote&&this.addToQueue(e.id)},this.onCancelRequest=e=>{const t=this.queue.indexOf(e.id);-1!==t&&this.queue.splice(t,1)},this.onFileRemoved=e=>{const t=this.queue.indexOf(e.id);-1!==t&&this.queue.splice(t,1),e.preview&&n(e.preview)&&URL.revokeObjectURL(e.preview)},this.onRestored=()=>{this.uppy.getFiles().filter((e=>e.isRestored)).forEach((e=>{e.preview&&!n(e.preview)||this.addToQueue(e.id)}))},this.onAllFilesRemoved=()=>{this.queue=[]},this.waitUntilAllProcessed=e=>{e.forEach((e=>{const t=this.uppy.getFile(e);this.uppy.emit("preprocess-progress",t,{mode:"indeterminate",message:this.i18n("generatingThumbnails")})}));const t=()=>{e.forEach((e=>{const t=this.uppy.getFile(e);this.uppy.emit("preprocess-complete",t)}))};return new Promise((e=>{this.queueProcessing?this.uppy.once("thumbnail:all-generated",(()=>{t(),e()})):(t(),e())}))},this.type="modifier",this.id=this.opts.id||"ThumbnailGenerator",this.title="Thumbnail Generator",this.queue=[],this.queueProcessing=!1,this.defaultThumbnailDimension=200,this.thumbnailType=this.opts.thumbnailType||"image/jpeg",this.defaultLocale=l;if(this.opts={thumbnailWidth:null,thumbnailHeight:null,waitForThumbnailsBeforeUpload:!1,lazy:!1,...t},this.i18nInit(),this.opts.lazy&&this.opts.waitForThumbnailsBeforeUpload)throw new Error("ThumbnailGenerator: The `lazy` and `waitForThumbnailsBeforeUpload` options are mutually exclusive. Please ensure at most one of them is set to `true`.")}createThumbnail(e,t,s){const i=URL.createObjectURL(e.data),r=new Promise(((e,t)=>{const s=new Image;s.src=i,s.addEventListener("load",(()=>{URL.revokeObjectURL(i),e(s)})),s.addEventListener("error",(e=>{URL.revokeObjectURL(i),t(e.error||new Error("Could not create thumbnail"))}))})),n=(0,a.rotation)(e.data).catch((()=>1));return Promise.all([r,n]).then((e=>{let[i,r]=e;const n=this.getProportionalDimensions(i,t,s,r.deg),o=function(e,t){let s=e.width,i=e.height;90!==t.deg&&270!==t.deg||(s=e.height,i=e.width);const r=document.createElement("canvas");r.width=s,r.height=i;const n=r.getContext("2d");return n.translate(s/2,i/2),t.canvas&&(n.rotate(t.rad),n.scale(t.scaleX,t.scaleY)),n.drawImage(e,-e.width/2,-e.height/2,e.width,e.height),r}(i,r);return h(this.resizeImage(o,n.width,n.height),this.thumbnailType,80)})).then((e=>URL.createObjectURL(e)))}getProportionalDimensions(e,t,s,i){let r=e.width/e.height;return 90!==i&&270!==i||(r=e.height/e.width),null!=t?{width:t,height:Math.round(t/r)}:null!=s?{width:Math.round(s*r),height:s}:{width:this.defaultThumbnailDimension,height:Math.round(this.defaultThumbnailDimension/r)}}resizeImage(e,t,s){let i=function(e){const t=e.width/e.height,s=5e6,i=4096;let r=Math.floor(Math.sqrt(s*t)),n=Math.floor(s/Math.sqrt(s*t));if(r>i&&(r=i,n=Math.round(r/t)),n>i&&(n=i,r=Math.round(t*n)),e.width>r){const t=document.createElement("canvas");return t.width=r,t.height=n,t.getContext("2d").drawImage(e,0,0,r,n),t}return e}(e),r=Math.ceil(Math.log2(i.width/t));r<1&&(r=1);let n=t*2**(r-1),o=s*2**(r-1);for(;r--;){const e=document.createElement("canvas");e.width=n,e.height=o,e.getContext("2d").drawImage(i,0,0,n,o),i=e,n=Math.round(n/2),o=Math.round(o/2)}return i}setPreviewURL(e,t){this.uppy.setFileState(e,{preview:t})}addToQueue(e){this.queue.push(e),!1===this.queueProcessing&&this.processQueue()}processQueue(){if(this.queueProcessing=!0,this.queue.length>0){const e=this.uppy.getFile(this.queue.shift());return e?this.requestThumbnail(e).catch((()=>{})).then((()=>this.processQueue())):(this.uppy.log("[ThumbnailGenerator] file was removed before a thumbnail could be generated, but not removed from the queue. This is probably a bug","error"),Promise.resolve())}return this.queueProcessing=!1,this.uppy.log("[ThumbnailGenerator] Emptied thumbnail queue"),this.uppy.emit("thumbnail:all-generated"),Promise.resolve()}requestThumbnail(e){return o(e.type)&&!e.isRemote?this.createThumbnail(e,this.opts.thumbnailWidth,this.opts.thumbnailHeight).then((t=>{this.setPreviewURL(e.id,t),this.uppy.log(`[ThumbnailGenerator] Generated thumbnail for ${e.id}`),this.uppy.emit("thumbnail:generated",this.uppy.getFile(e.id),t)})).catch((t=>{this.uppy.log(`[ThumbnailGenerator] Failed thumbnail for ${e.id}:`,"warning"),this.uppy.log(t,"warning"),this.uppy.emit("thumbnail:error",this.uppy.getFile(e.id),t)})):Promise.resolve()}install(){this.uppy.on("file-removed",this.onFileRemoved),this.uppy.on("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("thumbnail:cancel",this.onCancelRequest)):(this.uppy.on("file-added",this.onFileAdded),this.uppy.on("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.addPreProcessor(this.waitUntilAllProcessed)}uninstall(){this.uppy.off("file-removed",this.onFileRemoved),this.uppy.off("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("thumbnail:cancel",this.onCancelRequest)):(this.uppy.off("file-added",this.onFileAdded),this.uppy.off("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.removePreProcessor(this.waitUntilAllProcessed)}}u.VERSION="3.0.0"},6594:(e,t,s)=>{"use strict";function i(e,t,s,r){let{onSuccess:n}=r;e.readEntries((r=>{const o=[...t,...r];r.length?queueMicrotask((()=>{i(e,o,s,{onSuccess:n})})):n(o)}),(e=>{s(e),n(t)}))}function r(e,t){return null==e?e:{kind:e.isFile?"file":e.isDirectory?"directory":void 0,name:e.name,getFile:()=>new Promise(((t,s)=>e.file(t,s))),async*values(){const s=e.createReader(),n=await new Promise((e=>{i(s,[],t,{onSuccess:s=>e(s.map((e=>r(e,t))))})}));yield*n}}}async function*n(e,t){if("file"===e.kind){const s=await e.getFile();null!==s&&(s.relativePath=t?`${t}/${e.name}`:null,yield s)}else if("directory"===e.kind)for await(const s of e.values())yield*n(s,`${t}/${e.name}`)}s.d(t,{Z:()=>a});var o=s(7581);async function a(e,t){let{logDropError:s=(()=>{})}=void 0===t?{}:t;try{const t=[];for await(const i of async function*(e,t){const s=await Promise.all(Array.from(e.items,(async e=>{var s;return{lastResortFile:e.getAsFile(),entry:null!=(s=await(null==e.getAsFileSystemHandle?void 0:e.getAsFileSystemHandle()))?s:r(e.webkitGetAsEntry(),t)}})));for(const{lastResortFile:e,entry:i}of s)if(null!=i)try{yield*n(i,"")}catch(s){e?yield e:t(s)}}(e,s))t.push(i);return t}catch{return function(e){const t=(0,o.Z)(e.files);return Promise.resolve(t)}(e)}}},8215:(e,t,s)=>{"use strict";function i(){const e=document.body;return"draggable"in e&&"ondragstart"in e&&"ondrop"in e&&("FormData"in window&&"FileReader"in window)}s.d(t,{Z:()=>i})},7581:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});const i=Array.from},1144:(e,t,s)=>{"use strict";s.d(t,{Z:()=>je});var i={};s.r(i),s.d(i,{getItem:()=>x,removeItem:()=>U,setItem:()=>P});var r=s(8596),n=s(9022);class o extends Error{constructor(e,t){void 0===t&&(t=null),super("This looks like a network error, the endpoint might be blocked by an internet provider or a firewall."),this.cause=e,this.isNetworkError=!0,this.request=t}}const a=o;function l(){return fetch(...arguments).catch((e=>{throw"AbortError"===e.name?e:new a(e)}))}class h extends Error{constructor(e,t){var s,i;void 0===t&&(t={}),super(e),this.cause=t.cause,this.cause&&(s=this.cause,i="isNetworkError",Object.prototype.hasOwnProperty.call(s,i))&&(this.isNetworkError=this.cause.isNetworkError)}}const u=h;class d extends Error{constructor(){super("Authorization required"),this.name="AuthError",this.isAuthError=!0}}const p=d;let c;function f(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var g=0;function m(e){return"__private_"+g+++"_"+e}async function y(e){if(401===e.status)throw new p;const t=e.json();if(e.status<200||e.status>300){let s=`Failed request with status: ${e.status}. ${e.statusText}`;try{const e=await t;s=e.message?`${s} message: ${e.message}`:s,s=e.requestId?`${s} request-Id: ${e.requestId}`:s}finally{throw new Error(s)}}return t}var v=m("companionHeaders"),b=m("getPostResponseFunc"),w=m("getUrl"),_=m("errorHandler");c=Symbol.for("uppy test: getCompanionHeaders");class k{constructor(e,t){Object.defineProperty(this,_,{value:O}),Object.defineProperty(this,w,{value:S}),Object.defineProperty(this,v,{writable:!0,value:void 0}),Object.defineProperty(this,b,{writable:!0,value:e=>t=>e?t:this.onReceiveResponse(t)}),this.uppy=e,this.opts=t,this.onReceiveResponse=this.onReceiveResponse.bind(this),this.allowedHeaders=["accept","content-type","uppy-auth-token"],this.preflightDone=!1,f(this,v)[v]=null==t?void 0:t.companionHeaders}setCompanionHeaders(e){f(this,v)[v]=e}[c](){return f(this,v)[v]}get hostname(){const{companion:e}=this.uppy.getState(),t=this.opts.companionUrl;return(e&&e[t]?e[t]:t).replace(/\/$/,"")}headers(){return Promise.resolve({...k.defaultHeaders,...f(this,v)[v]})}onReceiveResponse(e){const t=this.uppy.getState().companion||{},s=this.opts.companionUrl,{headers:i}=e;return i.has("i-am")&&i.get("i-am")!==t[s]&&this.uppy.setState({companion:{...t,[s]:i.get("i-am")}}),e}preflight(e){return this.preflightDone?Promise.resolve(this.allowedHeaders.slice()):fetch(f(this,w)[w](e),{method:"OPTIONS"}).then((e=>(e.headers.has("access-control-allow-headers")&&(this.allowedHeaders=e.headers.get("access-control-allow-headers").split(",").map((e=>e.trim().toLowerCase()))),this.preflightDone=!0,this.allowedHeaders.slice()))).catch((e=>(this.uppy.log(`[CompanionClient] unable to make preflight request ${e}`,"warning"),this.preflightDone=!0,this.allowedHeaders.slice())))}preflightAndHeaders(e){return Promise.all([this.preflight(e),this.headers()]).then((e=>{let[t,s]=e;return Object.keys(s).forEach((e=>{t.includes(e.toLowerCase())||(this.uppy.log(`[CompanionClient] excluding disallowed header ${e}`),delete s[e])})),s}))}get(e,t){return this.preflightAndHeaders(e).then((t=>l(f(this,w)[w](e),{method:"get",headers:t,credentials:this.opts.companionCookiesRule||"same-origin"}))).then(f(this,b)[b](t)).then(y).catch(f(this,_)[_]("get",e))}post(e,t,s){const i="post";return this.preflightAndHeaders(e).then((s=>l(f(this,w)[w](e),{method:i,headers:s,credentials:this.opts.companionCookiesRule||"same-origin",body:JSON.stringify(t)}))).then(f(this,b)[b](s)).then(y).catch(f(this,_)[_](i,e))}delete(e,t,s){const i="delete";return this.preflightAndHeaders(e).then((s=>l(`${this.hostname}/${e}`,{method:i,headers:s,credentials:this.opts.companionCookiesRule||"same-origin",body:t?JSON.stringify(t):null}))).then(f(this,b)[b](s)).then(y).catch(f(this,_)[_](i,e))}}function S(e){return/^(https?:|)\/\//.test(e)?e:`${this.hostname}/${e}`}function O(e,t){return s=>{var i;return null!=(i=s)&&i.isAuthError||(s=new u(`Could not ${e} ${f(this,w)[w](t)}`,{cause:s})),Promise.reject(s)}}function P(e,t){return new Promise((s=>{localStorage.setItem(e,t),s()}))}function x(e){return Promise.resolve(localStorage.getItem(e))}function U(e){return new Promise((t=>{localStorage.removeItem(e),t()}))}k.VERSION="3.0.0",k.defaultHeaders={Accept:"application/json","Content-Type":"application/json","Uppy-Versions":`@uppy/companion-client=${k.VERSION}`};class E extends k{constructor(e,t){super(e,t),this.provider=t.provider,this.id=this.provider,this.name=this.opts.name||(e=>e.split("-").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "))(this.id),this.pluginId=this.opts.pluginId,this.tokenKey=`companion-${this.pluginId}-auth-token`,this.companionKeysParams=this.opts.companionKeysParams,this.preAuthToken=null}headers(){return Promise.all([super.headers(),this.getAuthToken()]).then((e=>{let[t,s]=e;const i={};return s&&(i["uppy-auth-token"]=s),this.companionKeysParams&&(i["uppy-credentials-params"]=btoa(JSON.stringify({params:this.companionKeysParams}))),{...t,...i}}))}onReceiveResponse(e){e=super.onReceiveResponse(e);const t=this.uppy.getPlugin(this.pluginId),s=t.getPluginState().authenticated?401!==e.status:e.status<400;return t.setPluginState({authenticated:s}),e}setAuthToken(e){return this.uppy.getPlugin(this.pluginId).storage.setItem(this.tokenKey,e)}getAuthToken(){return this.uppy.getPlugin(this.pluginId).storage.getItem(this.tokenKey)}async ensurePreAuth(){if(this.companionKeysParams&&!this.preAuthToken&&(await this.fetchPreAuthToken(),!this.preAuthToken))throw new Error("Could not load authentication data required for third-party login. Please try again later.")}authUrl(e){void 0===e&&(e={});const t=new URLSearchParams(e);return this.preAuthToken&&t.set("uppyPreAuthToken",this.preAuthToken),`${this.hostname}/${this.id}/connect?${t}`}fileUrl(e){return`${this.hostname}/${this.id}/get/${e}`}async fetchPreAuthToken(){if(this.companionKeysParams)try{const e=await this.post(`${this.id}/preauth/`,{params:this.companionKeysParams});this.preAuthToken=e.token}catch(e){this.uppy.log(`[CompanionClient] unable to fetch preAuthToken ${e}`,"warning")}}list(e){return this.get(`${this.id}/list/${e||""}`)}logout(){return this.get(`${this.id}/logout`).then((e=>Promise.all([e,this.uppy.getPlugin(this.pluginId).storage.removeItem(this.tokenKey)]))).then((e=>{let[t]=e;return t}))}static initPlugin(e,t,s){if(e.type="acquirer",e.files=[],s&&(e.opts={...s,...t}),t.serverUrl||t.serverPattern)throw new Error("`serverUrl` and `serverPattern` have been renamed to `companionUrl` and `companionAllowedHosts` respectively in the 0.30.5 release. Please consult the docs (for example, https://uppy.io/docs/instagram/ for the Instagram plugin) and use the updated options.`");if(t.companionAllowedHosts){const s=t.companionAllowedHosts;if(!("string"==typeof s||Array.isArray(s)||s instanceof RegExp))throw new TypeError(`${e.id}: the option "companionAllowedHosts" must be one of string, Array, RegExp`);e.opts.companionAllowedHosts=s}else/^(?!https?:\/\/).*$/i.test(t.companionUrl)?e.opts.companionAllowedHosts=`https://${t.companionUrl.replace(/^\/\//,"")}`:e.opts.companionAllowedHosts=new URL(t.companionUrl).origin;e.storage=e.opts.storage||i}}var F=s(4800);let A,T;function C(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var j=0;function R(e){return"__private_"+j+++"_"+e}var $=R("queued"),I=R("emitter"),L=R("isOpen"),M=R("socket"),N=R("handleMessage");A=Symbol.for("uppy test: getSocket"),T=Symbol.for("uppy test: getQueued");class z{constructor(e){Object.defineProperty(this,$,{writable:!0,value:[]}),Object.defineProperty(this,I,{writable:!0,value:F()}),Object.defineProperty(this,L,{writable:!0,value:!1}),Object.defineProperty(this,M,{writable:!0,value:void 0}),Object.defineProperty(this,N,{writable:!0,value:e=>{try{const t=JSON.parse(e.data);this.emit(t.action,t.payload)}catch(e){}}}),this.opts=e,e&&!1===e.autoOpen||this.open()}get isOpen(){return C(this,L)[L]}[A](){return C(this,M)[M]}[T](){return C(this,$)[$]}open(){C(this,M)[M]=new WebSocket(this.opts.target),C(this,M)[M].onopen=()=>{for(C(this,L)[L]=!0;C(this,$)[$].length>0&&C(this,L)[L];){const e=C(this,$)[$].shift();this.send(e.action,e.payload)}},C(this,M)[M].onclose=()=>{C(this,L)[L]=!1},C(this,M)[M].onmessage=C(this,N)[N]}close(){var e;null==(e=C(this,M)[M])||e.close()}send(e,t){C(this,L)[L]?C(this,M)[M].send(JSON.stringify({action:e,payload:t})):C(this,$)[$].push({action:e,payload:t})}on(e,t){C(this,I)[I].on(e,t)}emit(e,t){C(this,I)[I].emit(e,t)}once(e,t){C(this,I)[I].once(e,t)}}const B=s(3096)((function(e,t,s){const{progress:i,bytesUploaded:r,bytesTotal:n}=t;i&&(e.uppy.log(`Upload progress: ${i}`),e.uppy.emit("upload-progress",s,{uploader:e,bytesUploaded:r,bytesTotal:n}))}),300,{leading:!0,trailing:!0});function D(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var V=0;function q(e){return"__private_"+V+++"_"+e}var H=q("emitter"),W=q("events");class G{constructor(e){Object.defineProperty(this,H,{writable:!0,value:void 0}),Object.defineProperty(this,W,{writable:!0,value:[]}),D(this,H)[H]=e}on(e,t){return D(this,W)[W].push([e,t]),D(this,H)[H].on(e,t)}remove(){for(const[e,t]of D(this,W)[W].splice(0))D(this,H)[H].off(e,t)}}function X(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var K=0;function Y(e){return"__private_"+K+++"_"+e}var Z=Y("aliveTimer"),J=Y("isDone"),Q=Y("onTimedOut"),ee=Y("timeout");const te=class{constructor(e,t){Object.defineProperty(this,Z,{writable:!0,value:void 0}),Object.defineProperty(this,J,{writable:!0,value:!1}),Object.defineProperty(this,Q,{writable:!0,value:void 0}),Object.defineProperty(this,ee,{writable:!0,value:void 0}),X(this,ee)[ee]=e,X(this,Q)[Q]=t}progress(){X(this,J)[J]||X(this,ee)[ee]>0&&(clearTimeout(X(this,Z)[Z]),X(this,Z)[Z]=setTimeout(X(this,Q)[Q],X(this,ee)[ee]))}done(){X(this,J)[J]||(clearTimeout(X(this,Z)[Z]),X(this,Z)[Z]=null,X(this,J)[J]=!0)}};function se(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var ie=0;function re(e){return"__private_"+ie+++"_"+e}function ne(){return new Error("Cancelled")}var oe=re("activeRequests"),ae=re("queuedHandlers"),le=re("paused"),he=re("pauseTimer"),ue=re("downLimit"),de=re("upperLimit"),pe=re("rateLimitingTimer"),ce=re("call"),fe=re("queueNext"),ge=re("next"),me=re("queue"),ye=re("dequeue"),ve=re("resume"),be=re("increaseLimit");class we{constructor(e){Object.defineProperty(this,ye,{value:Pe}),Object.defineProperty(this,me,{value:Oe}),Object.defineProperty(this,ge,{value:Se}),Object.defineProperty(this,fe,{value:ke}),Object.defineProperty(this,ce,{value:_e}),Object.defineProperty(this,oe,{writable:!0,value:0}),Object.defineProperty(this,ae,{writable:!0,value:[]}),Object.defineProperty(this,le,{writable:!0,value:!1}),Object.defineProperty(this,he,{writable:!0,value:void 0}),Object.defineProperty(this,ue,{writable:!0,value:1}),Object.defineProperty(this,de,{writable:!0,value:void 0}),Object.defineProperty(this,pe,{writable:!0,value:void 0}),Object.defineProperty(this,ve,{writable:!0,value:()=>this.resume()}),Object.defineProperty(this,be,{writable:!0,value:()=>{if(se(this,le)[le])se(this,pe)[pe]=setTimeout(se(this,be)[be],0);else{se(this,ue)[ue]=this.limit,this.limit=Math.ceil((se(this,de)[de]+se(this,ue)[ue])/2);for(let e=se(this,ue)[ue];e<=this.limit;e++)se(this,fe)[fe]();se(this,de)[de]-se(this,ue)[ue]>3?se(this,pe)[pe]=setTimeout(se(this,be)[be],2e3):se(this,ue)[ue]=Math.floor(se(this,ue)[ue]/2)}}}),this.limit="number"!=typeof e||0===e?1/0:e}run(e,t){return!se(this,le)[le]&&se(this,oe)[oe]<this.limit?se(this,ce)[ce](e):se(this,me)[me](e,t)}wrapPromiseFunction(e,t){var s=this;return function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];let o;const a=new Promise(((i,n)=>{o=s.run((()=>{let t,s;try{s=Promise.resolve(e(...r))}catch(e){s=Promise.reject(e)}return s.then((e=>{t?n(t):(o.done(),i(e))}),(e=>{t?n(t):(o.done(),n(e))})),()=>{t=ne()}}),t)}));return a.abort=()=>{o.abort()},a}}resume(){se(this,le)[le]=!1,clearTimeout(se(this,he)[he]);for(let e=0;e<this.limit;e++)se(this,fe)[fe]()}pause(e){void 0===e&&(e=null),se(this,le)[le]=!0,clearTimeout(se(this,he)[he]),null!=e&&(se(this,he)[he]=setTimeout(se(this,ve)[ve],e))}rateLimit(e){clearTimeout(se(this,pe)[pe]),this.pause(e),this.limit>1&&Number.isFinite(this.limit)&&(se(this,de)[de]=this.limit-1,this.limit=se(this,ue)[ue],se(this,pe)[pe]=setTimeout(se(this,be)[be],e))}get isPaused(){return se(this,le)[le]}}function _e(e){se(this,oe)[oe]+=1;let t,s=!1;try{t=e()}catch(e){throw se(this,oe)[oe]-=1,e}return{abort:()=>{s||(s=!0,se(this,oe)[oe]-=1,t(),se(this,fe)[fe]())},done:()=>{s||(s=!0,se(this,oe)[oe]-=1,se(this,fe)[fe]())}}}function ke(){queueMicrotask((()=>se(this,ge)[ge]()))}function Se(){if(se(this,le)[le]||se(this,oe)[oe]>=this.limit)return;if(0===se(this,ae)[ae].length)return;const e=se(this,ae)[ae].shift(),t=se(this,ce)[ce](e.fn);e.abort=t.abort,e.done=t.done}function Oe(e,t){void 0===t&&(t={});const s={fn:e,priority:t.priority||0,abort:()=>{se(this,ye)[ye](s)},done:()=>{throw new Error("Cannot mark a queued request as done: this indicates a bug")}},i=se(this,ae)[ae].findIndex((e=>s.priority>e.priority));return-1===i?se(this,ae)[ae].push(s):se(this,ae)[ae].splice(i,0,s),s}function Pe(e){const t=se(this,ae)[ae].indexOf(e);-1!==t&&se(this,ae)[ae].splice(t,1)}const xe=Symbol("__queue");class Ue extends Error{constructor(e,t){void 0===t&&(t=null),super("This looks like a network error, the endpoint might be blocked by an internet provider or a firewall."),this.cause=e,this.isNetworkError=!0,this.request=t}}const Ee=Ue;const Fe=function(e){return!!e&&(0!==e.readyState&&4!==e.readyState||0===e.status)},Ae={strings:{timedOut:"Upload stalled for %{seconds} seconds, aborting."}};function Te(e,t){let s=t;return s||(s=new Error("Upload error")),"string"==typeof s&&(s=new Error(s)),s instanceof Error||(s=Object.assign(new Error("Upload error"),{data:s})),Fe(e)?(s=new Ee(s,e),s):(s.request=e,s)}function Ce(e){return e.data.slice(0,e.data.size,e.meta.type)}class je extends r.Z{constructor(e,t){super(e,t),this.type="uploader",this.id=this.opts.id||"XHRUpload",this.title="XHRUpload",this.defaultLocale=Ae;const s={formData:!0,fieldName:t.bundle?"files[]":"file",method:"post",allowedMetaFields:null,responseUrlFieldName:"url",bundle:!1,headers:{},timeout:3e4,limit:5,withCredentials:!1,responseType:"",getResponseData(t){let s={};try{s=JSON.parse(t)}catch(t){e.log(t)}return s},getResponseError(e,t){let s=new Error("Upload error");return Fe(t)&&(s=new Ee(s,t)),s},validateStatus:e=>e>=200&&e<300};if(this.opts={...s,...t},this.i18nInit(),this.handleUpload=this.handleUpload.bind(this),xe in this.opts?this.requests=this.opts[xe]:this.requests=new we(this.opts.limit),this.opts.bundle&&!this.opts.formData)throw new Error("`opts.formData` must be true when `opts.bundle` is enabled.");if(void 0===(null==t?void 0:t.allowedMetaFields)&&"metaFields"in this.opts)throw new Error("The `metaFields` option has been renamed to `allowedMetaFields`.");this.uploaderEvents=Object.create(null)}getOptions(e){const t=this.uppy.getState().xhrUpload,{headers:s}=this.opts,i={...this.opts,...t||{},...e.xhrUpload||{},headers:{}};return"function"==typeof s?i.headers=s(e):Object.assign(i.headers,this.opts.headers),t&&Object.assign(i.headers,t.headers),e.xhrUpload&&Object.assign(i.headers,e.xhrUpload.headers),i}addMetadata(e,t,s){(Array.isArray(s.allowedMetaFields)?s.allowedMetaFields:Object.keys(t)).forEach((s=>{e.append(s,t[s])}))}createFormDataUpload(e,t){const s=new FormData;this.addMetadata(s,e.meta,t);const i=Ce(e);return e.name?s.append(t.fieldName,i,e.meta.name):s.append(t.fieldName,i),s}createBundledUpload(e,t){const s=new FormData,{meta:i}=this.uppy.getState();return this.addMetadata(s,i,t),e.forEach((e=>{const t=this.getOptions(e),i=Ce(e);e.name?s.append(t.fieldName,i,e.name):s.append(t.fieldName,i)})),s}upload(e,t,s){const i=this.getOptions(e);return this.uppy.log(`uploading ${t} of ${s}`),new Promise(((t,s)=>{this.uppy.emit("upload-started",e);const r=i.formData?this.createFormDataUpload(e,i):e.data,o=new XMLHttpRequest;let a;this.uploaderEvents[e.id]=new G(this.uppy);const l=new te(i.timeout,(()=>{o.abort(),a.done();const t=new Error(this.i18n("timedOut",{seconds:Math.ceil(i.timeout/1e3)}));this.uppy.emit("upload-error",e,t),s(t)})),h=(0,n.x)();o.upload.addEventListener("loadstart",(()=>{this.uppy.log(`[XHRUpload] ${h} started`)})),o.upload.addEventListener("progress",(t=>{this.uppy.log(`[XHRUpload] ${h} progress: ${t.loaded} / ${t.total}`),l.progress(),t.lengthComputable&&this.uppy.emit("upload-progress",e,{uploader:this,bytesUploaded:t.loaded,bytesTotal:t.total})})),o.addEventListener("load",(()=>{if(this.uppy.log(`[XHRUpload] ${h} finished`),l.done(),a.done(),this.uploaderEvents[e.id]&&(this.uploaderEvents[e.id].remove(),this.uploaderEvents[e.id]=null),i.validateStatus(o.status,o.responseText,o)){const s=i.getResponseData(o.responseText,o),r=s[i.responseUrlFieldName],n={status:o.status,body:s,uploadURL:r};return this.uppy.emit("upload-success",e,n),r&&this.uppy.log(`Download ${e.name} from ${r}`),t(e)}const r=i.getResponseData(o.responseText,o),n=Te(o,i.getResponseError(o.responseText,o)),u={status:o.status,body:r};return this.uppy.emit("upload-error",e,n,u),s(n)})),o.addEventListener("error",(()=>{this.uppy.log(`[XHRUpload] ${h} errored`),l.done(),a.done(),this.uploaderEvents[e.id]&&(this.uploaderEvents[e.id].remove(),this.uploaderEvents[e.id]=null);const t=Te(o,i.getResponseError(o.responseText,o));return this.uppy.emit("upload-error",e,t),s(t)})),o.open(i.method.toUpperCase(),i.endpoint,!0),o.withCredentials=i.withCredentials,""!==i.responseType&&(o.responseType=i.responseType),a=this.requests.run((()=>{this.uppy.emit("upload-started",e);const t=this.getOptions(e);return Object.keys(t.headers).forEach((e=>{o.setRequestHeader(e,t.headers[e])})),o.send(r),()=>{l.done(),o.abort()}})),this.onFileRemove(e.id,(()=>{a.abort(),s(new Error("File removed"))})),this.onCancelAll(e.id,(e=>{let{reason:t}=e;"user"===t&&a.abort(),s(new Error("Upload cancelled"))}))}))}uploadRemote(e){const t=this.getOptions(e);return new Promise(((s,i)=>{this.uppy.emit("upload-started",e);const r={};(Array.isArray(t.allowedMetaFields)?t.allowedMetaFields:Object.keys(e.meta)).forEach((t=>{r[t]=e.meta[t]}));new(e.remote.providerOptions.provider?E:k)(this.uppy,e.remote.providerOptions).post(e.remote.url,{...e.remote.body,protocol:"multipart",endpoint:t.endpoint,size:e.data.size,fieldname:t.fieldName,metadata:r,httpMethod:t.method,useFormData:t.formData,headers:t.headers}).then((r=>{const{token:n}=r,o=function(e){const t=/^(?:https?:\/\/|\/\/)?(?:[^@\n]+@)?(?:www\.)?([^\n]+)/i.exec(e)[1];return`${/^http:\/\//i.test(e)?"ws":"wss"}://${t}`}(e.remote.companionUrl),a=new z({target:`${o}/api/${n}`,autoOpen:!1});let l;this.uploaderEvents[e.id]=new G(this.uppy),this.onFileRemove(e.id,(()=>{a.send("cancel",{}),l.abort(),s(`upload ${e.id} was removed`)})),this.onCancelAll(e.id,(function(t){let{reason:i}=void 0===t?{}:t;"user"===i&&(a.send("cancel",{}),l.abort()),s(`upload ${e.id} was canceled`)})),this.onRetry(e.id,(()=>{a.send("pause",{}),a.send("resume",{})})),this.onRetryAll(e.id,(()=>{a.send("pause",{}),a.send("resume",{})})),a.on("progress",(t=>B(this,t,e))),a.on("success",(i=>{const r=t.getResponseData(i.response.responseText,i.response),n=r[t.responseUrlFieldName],o={status:i.response.status,body:r,uploadURL:n};return this.uppy.emit("upload-success",e,o),l.done(),this.uploaderEvents[e.id]&&(this.uploaderEvents[e.id].remove(),this.uploaderEvents[e.id]=null),s()})),a.on("error",(s=>{const r=s.response,n=r?t.getResponseError(r.responseText,r):Object.assign(new Error(s.error.message),{cause:s.error});this.uppy.emit("upload-error",e,n),l.done(),this.uploaderEvents[e.id]&&(this.uploaderEvents[e.id].remove(),this.uploaderEvents[e.id]=null),i(n)})),l=this.requests.run((()=>(a.open(),e.isPaused&&a.send("pause",{}),()=>a.close())))})).catch((t=>{this.uppy.emit("upload-error",e,t),i(t)}))}))}uploadBundle(e){return new Promise(((t,s)=>{const{endpoint:i}=this.opts,{method:r}=this.opts,n=this.uppy.getState().xhrUpload,o=this.createBundledUpload(e,{...this.opts,...n||{}}),a=new XMLHttpRequest,l=t=>{e.forEach((e=>{this.uppy.emit("upload-error",e,t)}))},h=new te(this.opts.timeout,(()=>{a.abort();const e=new Error(this.i18n("timedOut",{seconds:Math.ceil(this.opts.timeout/1e3)}));l(e),s(e)}));a.upload.addEventListener("loadstart",(()=>{this.uppy.log("[XHRUpload] started uploading bundle"),h.progress()})),a.upload.addEventListener("progress",(t=>{h.progress(),t.lengthComputable&&e.forEach((e=>{this.uppy.emit("upload-progress",e,{uploader:this,bytesUploaded:t.loaded/t.total*e.size,bytesTotal:e.size})}))})),a.addEventListener("load",(i=>{if(h.done(),this.opts.validateStatus(i.target.status,a.responseText,a)){const s=this.opts.getResponseData(a.responseText,a),r={status:i.target.status,body:s};return e.forEach((e=>{this.uppy.emit("upload-success",e,r)})),t()}const r=this.opts.getResponseError(a.responseText,a)||new Error("Upload error");return r.request=a,l(r),s(r)})),a.addEventListener("error",(()=>{h.done();const e=this.opts.getResponseError(a.responseText,a)||new Error("Upload error");return l(e),s(e)})),this.uppy.on("cancel-all",(function(e){let{reason:t}=void 0===e?{}:e;"user"===t&&(h.done(),a.abort())})),a.open(r.toUpperCase(),i,!0),a.withCredentials=this.opts.withCredentials,""!==this.opts.responseType&&(a.responseType=this.opts.responseType),Object.keys(this.opts.headers).forEach((e=>{a.setRequestHeader(e,this.opts.headers[e])})),a.send(o),e.forEach((e=>{this.uppy.emit("upload-started",e)}))}))}uploadFiles(e){return function(e){const t=[],s=[];function i(e){t.push(e)}function r(e){s.push(e)}return Promise.all(e.map((e=>e.then(i,r)))).then((()=>({successful:t,failed:s})))}(e.map(((t,s)=>{const i=parseInt(s,10)+1,r=e.length;return t.error?Promise.reject(new Error(t.error)):t.isRemote?this.uploadRemote(t,i,r):this.upload(t,i,r)})))}onFileRemove(e,t){this.uploaderEvents[e].on("file-removed",(s=>{e===s.id&&t(s.id)}))}onRetry(e,t){this.uploaderEvents[e].on("upload-retry",(s=>{e===s&&t()}))}onRetryAll(e,t){this.uploaderEvents[e].on("retry-all",(()=>{this.uppy.getFile(e)&&t()}))}onCancelAll(e,t){var s=this;this.uploaderEvents[e].on("cancel-all",(function(){s.uppy.getFile(e)&&t(...arguments)}))}handleUpload(e){if(0===e.length)return this.uppy.log("[XHRUpload] No files to upload!"),Promise.resolve();0!==this.opts.limit||this.opts[xe]||this.uppy.log("[XHRUpload] When uploading multiple files at once, consider setting the `limit` option (to `10` for example), to limit the number of concurrent uploads, which helps prevent memory and network issues: https://uppy.io/docs/xhr-upload/#limit-0","warning"),this.uppy.log("[XHRUpload] Uploading...");const t=e.map((e=>this.uppy.getFile(e)));if(this.opts.bundle){if(t.some((e=>e.isRemote)))throw new Error("Canâ€™t upload remote files when the `bundle: true` option is set");if("function"==typeof this.opts.headers)throw new TypeError("`headers` may not be a function when the `bundle: true` option is set");return this.uploadBundle(t)}return this.uploadFiles(t).then((()=>null))}install(){if(this.opts.bundle){const{capabilities:e}=this.uppy.getState();this.uppy.setState({capabilities:{...e,individualCancellation:!1}})}this.uppy.addUploader(this.handleUpload)}uninstall(){if(this.opts.bundle){const{capabilities:e}=this.uppy.getState();this.uppy.setState({capabilities:{...e,individualCancellation:!0}})}this.uppy.removeUploader(this.handleUpload)}}je.VERSION="3.0.0"},9022:(e,t,s)=>{"use strict";s.d(t,{x:()=>i});let i=(e=21)=>{let t="",s=e;for(;s--;)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return t}}}]);